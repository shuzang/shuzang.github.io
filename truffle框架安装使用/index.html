<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Truffle框架安装使用 | Shuzang's Blog</title><meta name=Description content="书藏的个人博客，包括Golang、数据结构、算法的学习记录，各类生活技能的学习，每周五发布一期自己的生活周刊"><meta property="og:title" content="Truffle框架安装使用"><meta property="og:description" content="Truffle和Ganache的安装使用 1. 安装Truffle 在Ubuntu18.04 下安装运行，要求Node.js版本高于v8.9.4 1 2 3"><meta property="og:type" content="article"><meta property="og:url" content="https://shuzang.github.io/truffle%E6%A1%86%E6%9E%B6%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/"><meta property="article:published_time" content="2019-11-06T00:00:00+00:00"><meta property="article:modified_time" content="2019-11-06T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Truffle框架安装使用"><meta name=twitter:description content="Truffle和Ganache的安装使用 1. 安装Truffle 在Ubuntu18.04 下安装运行，要求Node.js版本高于v8.9.4 1 2 3"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=canonical href=https://shuzang.github.io/truffle%E6%A1%86%E6%9E%B6%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=prev href=https://shuzang.github.io/summary-of-problems-and-optimization-considerations-about-prototype-system/><link rel=next href=https://shuzang.github.io/life-skills-4-family-standing-medicines-and-tools/><link rel=stylesheet href=/lib/fontawesome-free/all.min.9a680b90260b5106d79f4075491ab31daafa7429eff686453c40b58357309649.css integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="><link rel=stylesheet href=/css/style.min.9191e7eb818b288ae5b697554903713021436f69fc49aaa1b74808c7191739db.css integrity="sha256-kZHn64GLKIrltpdVSQNxMCFDb2n8Saqht0gIxxkXOds="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Truffle框架安装使用","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/shuzang.github.io\/truffle%E6%A1%86%E6%9E%B6%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8\/"},"image":{"@type":"ImageObject","url":"https:\/\/shuzang.github.io\/cover.png","width":800,"height":600},"genre":"posts","keywords":"区块链","wordcount":2773,"url":"https:\/\/shuzang.github.io\/truffle%E6%A1%86%E6%9E%B6%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8\/","datePublished":"2019-11-06T00:00:00\x2b00:00","dateModified":"2019-11-06T00:00:00\x2b00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"shuzang","logo":{"@type":"ImageObject","url":"https:\/\/shuzang.github.io\/logo.png","width":127,"height":40}},"description":""}</script></head><body><script>if(!window.localStorage||!window.localStorage.getItem('theme')){window.isDark=window.matchMedia('(prefers-color-scheme: dark)').matches;}else{window.isDark=(window.localStorage&&window.localStorage.getItem('theme'))==='dark';}
window.isDark&&document.body.classList.add('dark-theme');</script><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class="header-title animated bounceIn"><a href=/>Shuzang's Blog</a></div><div class=menu><a class=menu-item href=/posts>Posts</a><a class=menu-item href=/tags>Tags</a><a class=menu-item href=/categories>Categories</a><a class=menu-item href=/about>About</a><a href=javascript:void(0); class=theme-switch title="Switch Theme">
<i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a></div></div></header><header class=mobile id=header-mobile><div class=header-wrapper><div class=header-container><div class="header-title animated bounceIn"><a href=/>Shuzang's Blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts>Posts</a><a class=menu-item href=/tags>Tags</a><a class=menu-item href=/categories>Categories</a><a class=menu-item href=/about>About</a><a href=javascript:void(0); class=theme-switch title="Switch Theme">
<i class="fas fa-adjust fa-rotate-180 fa-fw"></i></a></div></div></header><script>window.desktopHeaderMode="fixed";window.mobileHeaderMode="auto";</script><main class=main><div class=container><article class="page single"><h1 class="single-title animated flipInX">Truffle框架安装使用</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a class=author href=https://shuzang.github.io/about/ rel=author target=_blank><i class="fas fa-user-circle fa-fw"></i>shuzang</a>
</span>&nbsp;<span class=post-category>included in&nbsp;
<span><a href=/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E7%9A%84%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF><i class="far fa-folder fa-fw"></i>研究生的区块链学习之路</a></span></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i><time datetime=2019-11-06>2019-11-06</time>&nbsp;
<i class="fas fa-pencil-alt fa-fw"></i>about 2773 words&nbsp;
<i class="far fa-clock fa-fw"></i>6 min&nbsp;</div></div><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><div class=toc id=toc-static><details><summary><div class=toc-title><span>Contents</span>
<span><i class="details icon fas fa-angle-down"></i></span></div></summary><div class=toc-content id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#1-安装truffle>1. 安装Truffle</a></li><li><a href=#2-创建项目>2. 创建项目</a></li><li><a href=#3-编译>3. 编译</a></li><li><a href=#4-测试>4. 测试</a></li><li><a href=#5-与ganache关联使用>5. 与Ganache关联使用</a></li><li><a href=#6-与合约交互>6. 与合约交互</a></li><li><a href=#7-使用truffle-develop>7. 使用truffle develop</a></li><li><a href=#8-truffle-develop和truffle-console>8. Truffle develop和Truffle console</a></li><li><a href=#参考>参考</a></li></ul></li></ul></nav></div></details></div><div class=content id=content><p>Truffle和Ganache的安装使用</p><h3 id=1-安装truffle>1. 安装Truffle</h3><p>在Ubuntu18.04 下安装运行，要求Node.js版本高于v8.9.4</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ sudo apt-get install npm
$ sudo npm install npm@latest -g
$ sudo npm install n -g
$ sudo n lts
</code></pre></td></tr></table></div></div><p>安装Truffle</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ sudo npm install -g truffle
</code></pre></td></tr></table></div></div><h3 id=2-创建项目>2. 创建项目</h3><p>以<a href=https://www.trufflesuite.com/boxes target=_blank rel="noopener noreffer">Truffle Boxes</a>
中的<a href=https://www.trufflesuite.com/boxes/metacoin target=_blank rel="noopener noreffer">MetaCoin</a>
项目为例</p><p>首先为 Truffle 项目创建新目录</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ mkdir MetaCoin <span class=o>&amp;&amp;</span> <span class=nb>cd</span> MetaCoin
</code></pre></td></tr></table></div></div><p>下载MetaCoin box</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ truffle unbox metacoin

✔ Preparing to download
✔ Downloading
✔ Cleaning up temporary files
✔ Setting up box

Unbox successful. Sweet!

Commands:

  Compile contracts: truffle compile
  Migrate contracts: truffle migrate
  Test contracts:    truffle <span class=nb>test</span>
</code></pre></td></tr></table></div></div><p>下载完成后的项目目录如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ tree
.
├── contracts
│   ├── ConvertLib.sol
│   ├── MetaCoin.sol
│   └── Migrations.sol
├── LICENSE
├── migrations
│   ├── 1_initial_migration.js
│   └── 2_deploy_contracts.js
├── <span class=nb>test</span>
│   ├── metacoin.js
│   └── TestMetaCoin.sol
└── truffle-config.js

<span class=m>3</span> directories, <span class=m>9</span> files
</code></pre></td></tr></table></div></div><p><code>contracts</code>是solidity编写的合约存放的文件夹</p><ul><li><code>MetaCoin.sol</code>创建了一种简单的代币，它引用了<code>ConvertLib.sol</code>合约</li><li><code>Migrations.sol</code>是一个单独的合约文件，用来管理所部署合约的状态，每个Truffle项目中都有该文件，而且通常不需要更改</li></ul><p><code>migrations</code>是部署脚本存放的文件夹</p><ul><li><code>1_initial_migration.js</code>是<code>Migrations.sol</code>合约的迁移和部署脚本</li><li><code>2_deploy_contracts.js</code>是<code>MetaCoin.sol</code>合约的迁移和部署脚本</li><li>所有的脚本按文件名开头的序号按顺序执行</li></ul><p><code>test</code>是测试应用和合约的测试文件存放的目录</p><ul><li><code>TestMetaCoin.sol</code>是合约形式的测试文件</li><li><code>metacoin.js</code>是JS脚本形式的测试文件</li><li>两者的功能是一样的，只是使用了不同方式做测试</li></ul><p><code>truffle.js</code>是Truffle的配置文件，用于配置网络信息和其它项目相关的信息</p><h3 id=3-编译>3. 编译</h3><p>编译合约</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ truffle compile

Compiling your contracts...
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>
&gt; Compiling ./contracts/ConvertLib.sol
&gt; Compiling ./contracts/MetaCoin.sol
&gt; Compiling ./contracts/Migrations.sol
&gt; Artifacts written to /home/shuzang/MetaCoin/build/contracts
&gt; Compiled successfully using:
   - solc: 0.5.8+commit.23d335f2.Emscripten.clang
</code></pre></td></tr></table></div></div><h3 id=4-测试>4. 测试</h3><p>在终端中运行合约形式的测试文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ truffle <span class=nb>test</span> ./test/TestMetaCoin.sol

Compiling your contracts...
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>
&gt; Compiling ./contracts/ConvertLib.sol
&gt; Compiling ./contracts/MetaCoin.sol
&gt; Compiling ./contracts/Migrations.sol
&gt; Compiling ./test/TestMetaCoin.sol



  TestMetaCoin
    ✓ testInitialBalanceUsingDeployedContract <span class=o>(</span>83ms<span class=o>)</span>
    ✓ testInitialBalanceWithNewMetaCoin <span class=o>(</span>76ms<span class=o>)</span>


  <span class=m>2</span> passing <span class=o>(</span>6s<span class=o>)</span>
</code></pre></td></tr></table></div></div><p>在终端中运行JS脚本形式的测试文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ truffle <span class=nb>test</span> ./test/metacoin.js

Compiling your contracts...
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>
&gt; Compiling ./contracts/ConvertLib.sol
&gt; Compiling ./contracts/MetaCoin.sol
&gt; Compiling ./contracts/Migrations.sol



  Contract: MetaCoin
    ✓ should put <span class=m>10000</span> MetaCoin in the first account
    ✓ should call a <span class=k>function</span> that depends on a linked library <span class=o>(</span>60ms<span class=o>)</span>
    ✓ should send coin correctly <span class=o>(</span>154ms<span class=o>)</span>


  <span class=m>3</span> passing <span class=o>(</span>271ms<span class=o>)</span>
</code></pre></td></tr></table></div></div><h3 id=5-与ganache关联使用>5. 与Ganache关联使用</h3><p>为了部署合约我们需要连到区块链，Truffle提供这方面的功能，但是目前我们使用Ganache来模拟区块链做部署测试</p><p>首先在<a href=https://github.com/trufflesuite/ganache/releases target=_blank rel="noopener noreffer">Download</a>
页面下载对应操作系统的Ganache软件包，Linux系统下该软件包点击即可启动，无需安装</p><p>然后编辑<code>truffle-config.js</code>文件，替换为如下内容，这些配置参数将允许Ganache以默认参数连接</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
  <span class=nx>networks</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>development</span><span class=o>:</span> <span class=p>{</span>
      <span class=nx>host</span><span class=o>:</span> <span class=s2>&#34;127.0.0.1&#34;</span><span class=p>,</span>
      <span class=nx>port</span><span class=o>:</span> <span class=mi>7545</span><span class=p>,</span>
      <span class=nx>network_id</span><span class=o>:</span> <span class=s2>&#34;*&#34;</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span><span class=p>;</span>
</code></pre></td></tr></table></div></div><p>保存并关闭文件，打开Ganache</p><p><figure><a class=lightgallery href=https://www.trufflesuite.com/img/docs/ganache/quickstart/accounts.png title=Ganache data-thumbnail=https://www.trufflesuite.com/img/docs/ganache/quickstart/accounts.png><img class=lazyload src=/svg/loading.min.svg data-sizes=auto data-srcset="https://www.trufflesuite.com/img/docs/ganache/quickstart/accounts.png, https://www.trufflesuite.com/img/docs/ganache/quickstart/accounts.png 1.5x, https://www.trufflesuite.com/img/docs/ganache/quickstart/accounts.png 2x" data-src=https://www.trufflesuite.com/img/docs/ganache/quickstart/accounts.png alt=Ganache></a><figcaption class=image-caption>Ganache</figcaption></figure></p><p>执行迁移命令，将合约部署到Ganache创建的区块链</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ truffle migrate

Compiling your contracts...
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>
&gt; Everything is up to date, there is nothing to compile.



Starting migrations...
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>
&gt; Network name:    <span class=s1>&#39;development&#39;</span>
&gt; Network id:      <span class=m>5777</span>
&gt; Block gas limit: 0x6691b7


1_initial_migration.js
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>

   Deploying <span class=s1>&#39;Migrations&#39;</span>
   ----------------------
   &gt; transaction hash:    0x58a9f65031802c841183fc99a46d647870a99de5a717e27791f7ea13e9ccd47c
   &gt; Blocks: <span class=m>0</span>            Seconds: <span class=m>0</span>
   &gt; contract address:    0x03A587F157700FBdDff5195F22Eeab32c030424e
   &gt; block number:        <span class=m>1</span>
   &gt; block timestamp:     <span class=m>1573040253</span>
   &gt; account:             0x6c9d11d64bDC226d3d143b228d1019cB187c962d
   &gt; balance:             99.99477214
   &gt; gas used:            <span class=m>261393</span>
   &gt; gas price:           <span class=m>20</span> gwei
   &gt; value sent:          <span class=m>0</span> ETH
   &gt; total cost:          0.00522786 ETH


   &gt; Saving migration to chain.
   &gt; Saving artifacts
   -------------------------------------
   &gt; Total cost:          0.00522786 ETH


2_deploy_contracts.js
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>

   Deploying <span class=s1>&#39;ConvertLib&#39;</span>
   ----------------------
   &gt; transaction hash:    0x1685578d778d127196ce3b7d915b44e6433049f2a250e4384f836161cba8b75c
   &gt; Blocks: <span class=m>0</span>            Seconds: <span class=m>0</span>
   &gt; contract address:    0x741be30b7E4F5160026A0882f15763E623Fbcd66
   &gt; block number:        <span class=m>3</span>
   &gt; block timestamp:     <span class=m>1573040254</span>
   &gt; account:             0x6c9d11d64bDC226d3d143b228d1019cB187c962d
   &gt; balance:             99.99185922
   &gt; gas used:            <span class=m>103623</span>
   &gt; gas price:           <span class=m>20</span> gwei
   &gt; value sent:          <span class=m>0</span> ETH
   &gt; total cost:          0.00207246 ETH


   Linking
   -------
   * Contract: MetaCoin &lt;--&gt; Library: ConvertLib <span class=o>(</span>at address: 0x741be30b7E4F5160026A0882f15763E623Fbcd66<span class=o>)</span>

   Deploying <span class=s1>&#39;MetaCoin&#39;</span>
   --------------------
   &gt; transaction hash:    0x8800cc6fecf73a8d247fad63d5e739cccbd5e9f8dd350bbb709eb258396b96e4
   &gt; Blocks: <span class=m>0</span>            Seconds: <span class=m>0</span>
   &gt; contract address:    0xBfc5d417c17fc15E837aCA46063F6b5403ad469e
   &gt; block number:        <span class=m>4</span>
   &gt; block timestamp:     <span class=m>1573040254</span>
   &gt; account:             0x6c9d11d64bDC226d3d143b228d1019cB187c962d
   &gt; balance:             99.98509224
   &gt; gas used:            <span class=m>338349</span>
   &gt; gas price:           <span class=m>20</span> gwei
   &gt; value sent:          <span class=m>0</span> ETH
   &gt; total cost:          0.00676698 ETH


   &gt; Saving migration to chain.
   &gt; Saving artifacts
   -------------------------------------
   &gt; Total cost:          0.00883944 ETH


<span class=nv>Summary</span>
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>
&gt; Total deployments:   <span class=m>3</span>
&gt; Final cost:          0.0140673 ETH
</code></pre></td></tr></table></div></div><p>输出记录中显示了交易ID，部署的合约地址，总花费，实时状态等诸多信息。</p><p>在Ganache中点击<code>Transactions</code>按钮可以看到执行的交易的详细信息。</p><p>之后，使用Truffle控制台还可以和合约交互</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ truffle console
truffle<span class=o>(</span>development<span class=o>)</span>&gt;
</code></pre></td></tr></table></div></div><h3 id=6-与合约交互>6. 与合约交互</h3><p>truffle v5以后，控制台支持使用<code>async</code>或<code>await</code>函数，以下是一些合约交互的示例</p><p>首先部署合约并获取账户地址</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>instance</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>MetaCoin</span><span class=p>.</span><span class=nx>deployed</span><span class=p>(</span><span class=p>)</span>
<span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>accounts</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>web3</span><span class=p>.</span><span class=nx>eth</span><span class=p>.</span><span class=nx>getAccounts</span><span class=p>(</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>检查部署合约的账户余额</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>balance</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>instance</span><span class=p>.</span><span class=nx>getBalance</span><span class=p>(</span><span class=nx>accounts</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=p>)</span>
<span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=nx>balance</span><span class=p>.</span><span class=nx>toNumber</span><span class=p>(</span><span class=p>)</span>
<span class=mi>10000</span>
</code></pre></td></tr></table></div></div><p>检查余额值多少ether，合约定义1单位余额值2ether</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>ether</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>instance</span><span class=p>.</span><span class=nx>getBalanceInEth</span><span class=p>(</span><span class=nx>accounts</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=p>)</span>
<span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=nx>ether</span><span class=p>.</span><span class=nx>toNumber</span><span class=p>(</span><span class=p>)</span>
<span class=mi>20000</span>
</code></pre></td></tr></table></div></div><p>向另一个账户发送货币</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=nx>instance</span><span class=p>.</span><span class=nx>sendCoin</span><span class=p>(</span><span class=nx>accounts</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=p>,</span> <span class=mi>500</span><span class=p>)</span>
<span class=p>{</span> <span class=nx>tx</span><span class=o>:</span>
   <span class=s1>&#39;0xf392891ee029f6bc6f970b9e5ae91cfd2e92baa4e141f0a94f6c6fbf5942c8a8&#39;</span><span class=p>,</span>
  <span class=nx>receipt</span><span class=o>:</span>
   <span class=p>{</span> <span class=nx>transactionHash</span><span class=o>:</span>
      <span class=s1>&#39;0xf392891ee029f6bc6f970b9e5ae91cfd2e92baa4e141f0a94f6c6fbf5942c8a8&#39;</span><span class=p>,</span>
     <span class=nx>transactionIndex</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
     <span class=nx>blockHash</span><span class=o>:</span>
      <span class=s1>&#39;0x14d49b375d485ae98860383d3483174995f019f349e9fdf5fd1d669be35a4791&#39;</span><span class=p>,</span>
     <span class=nx>blockNumber</span><span class=o>:</span> <span class=mi>6</span><span class=p>,</span>
     <span class=nx>from</span><span class=o>:</span> <span class=s1>&#39;0x6c9d11d64bdc226d3d143b228d1019cb187c962d&#39;</span><span class=p>,</span>
     <span class=nx>to</span><span class=o>:</span> <span class=s1>&#39;0xbfc5d417c17fc15e837aca46063f6b5403ad469e&#39;</span><span class=p>,</span>
     <span class=nx>gasUsed</span><span class=o>:</span> <span class=mi>51072</span><span class=p>,</span>
     <span class=nx>cumulativeGasUsed</span><span class=o>:</span> <span class=mi>51072</span><span class=p>,</span>
     <span class=nx>contractAddress</span><span class=o>:</span> <span class=kc>null</span><span class=p>,</span>
     <span class=nx>logs</span><span class=o>:</span> <span class=p>[</span> <span class=p>[</span><span class=nb>Object</span><span class=p>]</span> <span class=p>]</span><span class=p>,</span>
     <span class=nx>status</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
     <span class=nx>logsBloom</span><span class=o>:</span>
      <span class=s1>&#39;0x00008000000000000000000000000000000000000000000400000000000000000400000010000000000000000000000000000000000002000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000010000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000800000000000&#39;</span><span class=p>,</span>
     <span class=nx>v</span><span class=o>:</span> <span class=s1>&#39;0x1b&#39;</span><span class=p>,</span>
     <span class=nx>r</span><span class=o>:</span>
      <span class=s1>&#39;0x6ad89e5e88194468c9d8f82891c7839b9c4d92ee01bd689ce080e35e99e74d1d&#39;</span><span class=p>,</span>
     <span class=nx>s</span><span class=o>:</span>
      <span class=s1>&#39;0x77f2bc1452799a94cfaec2a9400f85393794ff96b285447a3407371b2d991978&#39;</span><span class=p>,</span>
     <span class=nx>rawLogs</span><span class=o>:</span> <span class=p>[</span> <span class=p>[</span><span class=nb>Object</span><span class=p>]</span> <span class=p>]</span> <span class=p>}</span><span class=p>,</span>
  <span class=nx>logs</span><span class=o>:</span>
   <span class=p>[</span> <span class=p>{</span> <span class=nx>logIndex</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
       <span class=nx>transactionIndex</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
       <span class=nx>transactionHash</span><span class=o>:</span>
        <span class=s1>&#39;0xf392891ee029f6bc6f970b9e5ae91cfd2e92baa4e141f0a94f6c6fbf5942c8a8&#39;</span><span class=p>,</span>
       <span class=nx>blockHash</span><span class=o>:</span>
        <span class=s1>&#39;0x14d49b375d485ae98860383d3483174995f019f349e9fdf5fd1d669be35a4791&#39;</span><span class=p>,</span>
       <span class=nx>blockNumber</span><span class=o>:</span> <span class=mi>6</span><span class=p>,</span>
       <span class=nx>address</span><span class=o>:</span> <span class=s1>&#39;0xBfc5d417c17fc15E837aCA46063F6b5403ad469e&#39;</span><span class=p>,</span>
       <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;mined&#39;</span><span class=p>,</span>
       <span class=nx>id</span><span class=o>:</span> <span class=s1>&#39;log_c14235e4&#39;</span><span class=p>,</span>
       <span class=nx>event</span><span class=o>:</span> <span class=s1>&#39;Transfer&#39;</span><span class=p>,</span>
       <span class=nx>args</span><span class=o>:</span> <span class=p>[</span><span class=nx>Result</span><span class=p>]</span> <span class=p>}</span> <span class=p>]</span> <span class=p>}</span>
</code></pre></td></tr></table></div></div><p>检查接收账户的余额</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>received</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>instance</span><span class=p>.</span><span class=nx>getBalance</span><span class=p>(</span><span class=nx>accounts</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=p>)</span>
<span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=nx>received</span><span class=p>.</span><span class=nx>toNumber</span><span class=p>(</span><span class=p>)</span>
<span class=mi>500</span>
</code></pre></td></tr></table></div></div><p>检查发送账户的余额</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>newBalance</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>instance</span><span class=p>.</span><span class=nx>getBalance</span><span class=p>(</span><span class=nx>accounts</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=p>)</span>
<span class=nx>truffle</span><span class=p>(</span><span class=nx>development</span><span class=p>)</span><span class=o>&gt;</span> <span class=nx>newBalance</span><span class=p>.</span><span class=nx>toNumber</span><span class=p>(</span><span class=p>)</span>
<span class=mi>9500</span>
</code></pre></td></tr></table></div></div><h3 id=7-使用truffle-develop>7. 使用truffle develop</h3><p>之前部署合约使用了Ganache，也可以使用truffle develop。这一工具是Truffle内置的测试用私链，运行在本地。</p><p>运行truffle develop</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ truffle develop
Truffle Develop started at http://127.0.0.1:9545/

Accounts:
<span class=o>(</span>0<span class=o>)</span> 0xfc166345efd307d6c22bde2cc8f4e4e345c49495
<span class=o>(</span>1<span class=o>)</span> 0x7b06844a7accc66d34294557d98224c39c496c81
<span class=o>(</span>2<span class=o>)</span> 0x49bb2bd5e7506708b1c458d0b6331916180c091b
<span class=o>(</span>3<span class=o>)</span> 0x6ee54be55b95845c3c00cf1fb34cff053b619f44
<span class=o>(</span>4<span class=o>)</span> 0xeb259672501d8a16c954d09a8fdf84291d67cad2
<span class=o>(</span>5<span class=o>)</span> 0xb924f911ae293488043f6cc1d534654213db498f
<span class=o>(</span>6<span class=o>)</span> 0x02ce17094c74a5062ac6a2cd432a4948b7adba26
<span class=o>(</span>7<span class=o>)</span> 0x2e8e85efcefb3e96f09f2ca4d3d4342ef88a0b2c
<span class=o>(</span>8<span class=o>)</span> 0xd773abd9401ac8973cfcf5d8957bde6121347a92
<span class=o>(</span>9<span class=o>)</span> 0x0fcbde05930c09ecac70f9eeddb92d8b7ddec845

Private Keys:
<span class=o>(</span>0<span class=o>)</span> 328523fee9c143c97a93d27c2ef67a37e57143591e584bcbbdc6de71a0f92d8e
<span class=o>(</span>1<span class=o>)</span> 640e66ab0c0b9e775b32d5dfc00d71decc6c96006d71d6729abe336f88ef3c57
<span class=o>(</span>2<span class=o>)</span> c819551e120e1de0785f4476f7221d9d656a3b7c0e0fbce1de4eef986b2384bc
<span class=o>(</span>3<span class=o>)</span> 648892c4e7896ab4c1d26242ecda4de7f39a46cd2822451557c2910ce7b4be7f
<span class=o>(</span>4<span class=o>)</span> 8902380d9dd0dd8d6d97e59c694944a95829776db1dcb61406baec815649cb03
<span class=o>(</span>5<span class=o>)</span> f7d2341f7fbcde003d92e1a8ff3d3972fae00aff6a7568595e7bef03490efde9
<span class=o>(</span>6<span class=o>)</span> e4d11c8069bfaa777f666817d2d5f6b30a33dd75fb960b6e95abfd368286ef37
<span class=o>(</span>7<span class=o>)</span> 7af6c87f895b9c2a661748138a3bee82aff36439bcb43346f0285aa9dfb5aa04
<span class=o>(</span>8<span class=o>)</span> c810feb901d3bbeb57c9fadeba4e9da6bb61d61f1512fdabf5b0363264dd6336
<span class=o>(</span>9<span class=o>)</span> eb21927033d555614606e545e176c9584d8d673db404b70cc8fa4124cbee5438

Mnemonic: merry wrong fruit carry rifle phrase catalog describe mail traffic rate act

⚠️  Important ⚠️  : This mnemonic was created <span class=k>for</span> you by Truffle. It is not secure.
Ensure you <span class=k>do</span> not use it on production blockchains, or <span class=k>else</span> you risk losing funds.

truffle<span class=o>(</span>develop<span class=o>)</span>&gt; 
</code></pre></td></tr></table></div></div><p>以上显示了生成的十个账户和它们的私钥，可用于之后与区块链的交互。</p><p>在出现的<code>truffle(develop)></code>提示符下，可以省略<code>truffle</code>前缀而执行truffle的相关命令，依次执行编译和迁移命令</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>truffle<span class=o>(</span>develop<span class=o>)</span>&gt; compile

Compiling your contracts...
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>
&gt; Everything is up to date, there is nothing to compile.

truffle<span class=o>(</span>develop<span class=o>)</span>&gt; migrate

Compiling your contracts...
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>
&gt; Everything is up to date, there is nothing to compile.



Starting migrations...
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>
&gt; Network name:    <span class=s1>&#39;develop&#39;</span>
&gt; Network id:      <span class=m>5777</span>
&gt; Block gas limit: 0x6691b7


1_initial_migration.js
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>

   Replacing <span class=s1>&#39;Migrations&#39;</span>
   ----------------------
   &gt; transaction hash:    0x5cf8f2d9154c8c579535788af12bf153cba4dfe5f2e980b774f7a41cfe795089
   &gt; Blocks: <span class=m>0</span>            Seconds: <span class=m>0</span>
   &gt; contract address:    0x199Fb2370bb84f3eE5CacfF079D8478b67Cfba08
   &gt; block number:        <span class=m>1</span>
   &gt; block timestamp:     <span class=m>1573044347</span>
   &gt; account:             0xFc166345EFd307D6c22bdE2cC8f4e4E345c49495
   &gt; balance:             99.99477214
   &gt; gas used:            <span class=m>261393</span>
   &gt; gas price:           <span class=m>20</span> gwei
   &gt; value sent:          <span class=m>0</span> ETH
   &gt; total cost:          0.00522786 ETH


   &gt; Saving migration to chain.
   &gt; Saving artifacts
   -------------------------------------
   &gt; Total cost:          0.00522786 ETH


2_deploy_contracts.js
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>

   Replacing <span class=s1>&#39;ConvertLib&#39;</span>
   ----------------------
   &gt; transaction hash:    0x8bb95067ae3d85e519a37fa49feb0bca0b39ecd471f6626399b75c66592d5cb7
   &gt; Blocks: <span class=m>0</span>            Seconds: <span class=m>0</span>
   &gt; contract address:    0x3f2dF366aC8C3356516C53B14610DE53309F7CCA
   &gt; block number:        <span class=m>3</span>
   &gt; block timestamp:     <span class=m>1573044347</span>
   &gt; account:             0xFc166345EFd307D6c22bdE2cC8f4e4E345c49495
   &gt; balance:             99.99185922
   &gt; gas used:            <span class=m>103623</span>
   &gt; gas price:           <span class=m>20</span> gwei
   &gt; value sent:          <span class=m>0</span> ETH
   &gt; total cost:          0.00207246 ETH


   Linking
   -------
   * Contract: MetaCoin &lt;--&gt; Library: ConvertLib <span class=o>(</span>at address: 0x3f2dF366aC8C3356516C53B14610DE53309F7CCA<span class=o>)</span>

   Replacing <span class=s1>&#39;MetaCoin&#39;</span>
   --------------------
   &gt; transaction hash:    0x88213b424d793c5e8d04cce4f34789a38b5c318a3782da511eee51c73fc97da6
   &gt; Blocks: <span class=m>0</span>            Seconds: <span class=m>0</span>
   &gt; contract address:    0xBADc6F515922344a53675A348ccBEeec6A96a37a
   &gt; block number:        <span class=m>4</span>
   &gt; block timestamp:     <span class=m>1573044347</span>
   &gt; account:             0xFc166345EFd307D6c22bdE2cC8f4e4E345c49495
   &gt; balance:             99.98509224
   &gt; gas used:            <span class=m>338349</span>
   &gt; gas price:           <span class=m>20</span> gwei
   &gt; value sent:          <span class=m>0</span> ETH
   &gt; total cost:          0.00676698 ETH


   &gt; Saving migration to chain.
   &gt; Saving artifacts
   -------------------------------------
   &gt; Total cost:          0.00883944 ETH


<span class=nv>Summary</span>
<span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span><span class=o>=</span>
&gt; Total deployments:   <span class=m>3</span>
&gt; Final cost:          0.0140673 ETH
</code></pre></td></tr></table></div></div><p>接下来同样可以在提示符下直接进行合约交互，而不必退出使用<code>truffle console</code></p><h3 id=8-truffle-develop和truffle-console>8. Truffle develop和Truffle console</h3><p>两者都可以用于测试合约交互和手动执行交易，但Truffle develop同时还可以用来发起一个区块链</p><p>两者的使用场景为</p><p>Truffle Console</p><ul><li>已经有正在使用的客户端，如Ganache或geth</li><li>想要部署到测试网络或以太坊主网络</li><li>想要使用具体的助记符或账户列表</li></ul><p>Truffle develop</p><ul><li>正在测试项目，该项目不会马上部署</li><li>不需要使用指定的账户，使用默认提供的账户足够</li><li>不想安装或管理额外的区块链客户端</li></ul><h3 id=参考>参考</h3><p>[1] Truffle Quickstart, <a href=https://www.trufflesuite.com/docs/truffle/quickstart>https://www.trufflesuite.com/docs/truffle/quickstart</a></p><p>[2] Using Truffle Develop and The Console, <a href=https://www.trufflesuite.com/docs/truffle/getting-started/using-truffle-develop-and-the-console#truffle-develop>https://www.trufflesuite.com/docs/truffle/getting-started/using-truffle-develop-and-the-console#truffle-develop</a></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>The article was updated on 2019-11-06</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=https://shuzang.github.io/truffle%E6%A1%86%E6%9E%B6%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://shuzang.github.io/truffle%E6%A1%86%E6%9E%B6%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/ data-title=Truffle框架安装使用 data-hashtags=区块链><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://shuzang.github.io/truffle%E6%A1%86%E6%9E%B6%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/ data-hashtag=区块链><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://shuzang.github.io/truffle%E6%A1%86%E6%9E%B6%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/><i class="fab fa-reddit fa-fw"></i></a></span></div></div></div><div class=post-info-more><section><span><a href=/tags/%E5%8C%BA%E5%9D%97%E9%93%BE><i class="fas fa-tag fa-fw"></i>区块链</a>
</span>&nbsp;</section><section><span><a href=javascript:window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=https://shuzang.github.io/summary-of-problems-and-optimization-considerations-about-prototype-system/ class=prev rel=prev title=区块链实验4-原型系统问题总结及优化考虑><i class="fas fa-angle-left fa-fw"></i>区块链实验4-原型系统问题总结及优化考虑</a>
<a href=https://shuzang.github.io/life-skills-4-family-standing-medicines-and-tools/ class=next rel=next title=生活技能4-家庭常备药和工具>生活技能4-家庭常备药和工具<i class="fas fa-angle-right fa-fw"></i></a></div></div><div class=comment><div id=disqus_thread></div><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><div id=valine></div><script>document.addEventListener("DOMContentLoaded",function(event){new Valine({el:'#valine',appId:'GteMvevTjOBmhvFh2QGsopGO-gzGzoHsz',appKey:'fL4SYl06GIe012PswFdY17VC',placeholder:'Your comment ...',verify:true,avatar:'hide',pageSize:10,lang:'en',visitor:true,recordIP:true,});});</script><noscript>Please enable JavaScript to view the <a href=https://valine.js.org/>comments powered by Valine.</a></noscript></div></article></div></main><footer class=footer><div class=copyright><div class=copyright-line>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreffer">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a></div><div class=copyright-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2018 - 2020</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://shuzang.github.io/about/ target=_blank>shuzang</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><a href=# class="dynamic-to-top animated faster" id=dynamic-to-top><span>&nbsp;</span>
</a><script>document.addEventListener('DOMContentLoaded',function(){lightGallery(document.getElementById('content'),{selector:'.lightgallery',speed:400,hideBarsDelay:2000,thumbnail:true,exThumbImage:'data-thumbnail',thumbWidth:80,thumbContHeight:80,});});</script><link rel=stylesheet href=/lib/valine/dark.210f14917270f9f7ab9803acf878a152fb54ecb3003722bbee3adcd1d6e70fc1.css integrity="sha256-IQ8UkXJw+fermAOs+HihUvtU7LMANyK77jrc0dbnD8E="><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.a0f67639490aba5d9a250783c0aa0ed69f83a6f151fb0d7b9fb617c9dbc54565.css integrity="sha256-oPZ2OUkKul2aJQeDwKoO1p+DpvFR+w17n7YXydvFRWU="><script src=https://dillonzq.disqus.com/embed.js></script><script src=https://cdn.bootcss.com/smooth-scroll/16.1.0/smooth-scroll.js></script><script src=/lib/valine/Valine.min.cecee02afc36ef02fd550a02f12abfdd057905e78aa4439749675fce96148861.js integrity="sha256-zs7gKvw27wL9VQoC8Sq/3QV5BeeKpEOXSWdfzpYUiGE="></script><script src=/lib/sharer/sharer.min.9c88f86c7f0820287113f6236200459832693656e80d7556cc80a93dfbd45813.js integrity="sha256-nIj4bH8IIChxE/YjYgBFmDJpNlboDXVWzICpPfvUWBM="></script><script src=/lib/lightgallery/lightgallery.min.7a84c63ab156d68e4a7269487c9c65a4eb34b0c7864f2d3fd2b87f7c664480d3.js integrity="sha256-eoTGOrFW1o5KcmlIfJxlpOs0sMeGTy0/0rh/fGZEgNM="></script><script src=/lib/lightgallery/lg-thumbnail.min.eab31af8f90835b7ab674b2dd2474841039bc01022aa312f80dde6e22fde58d7.js integrity="sha256-6rMa+PkINberZ0st0kdIQQObwBAiqjEvgN3m4i/eWNc="></script><script src=/lib/lightgallery/lg-zoom.min.e3a7e6bb4a69f8627654ba9e0ab1252971bcfb400538dbb0605db9a3342ce5b9.js integrity="sha256-46fmu0pp+GJ2VLqeCrElKXG8+0AFONuwYF25ozQs5bk="></script><script src=/js/theme.min.1482fc67bfa2c3b8cebe476d0037b9321b5b7a8a1525b547b94143948be90e9e.js integrity="sha256-FIL8Z7+iw7jOvkdtADe5MhtbeooVJbVHuUFDlIvpDp4="></script></body></html>