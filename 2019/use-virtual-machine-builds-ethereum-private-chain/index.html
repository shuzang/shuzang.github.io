<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>以太坊开发1-虚拟机搭建以太坊私链 - Shuzang's Blog</title><meta name=author content="Shuzang"><meta name=author-link content><meta name=description content="一、单虚拟机 最简单的方式是使用一个虚拟机，这也是在条件有限的情况下的最好选择。方法是在一台虚拟机上启用多个终端，每个终端使用不同的端口通信。"><meta name=keywords content="区块链"><meta itemprop=name content="以太坊开发1-虚拟机搭建以太坊私链"><meta itemprop=description content="一、单虚拟机 最简单的方式是使用一个虚拟机，这也是在条件有限的情况下的最好选择。方法是在一台虚拟机上启用多个终端，每个终端使用不同的端口通信。"><meta itemprop=datePublished content="2019-03-07T14:53:00+08:00"><meta itemprop=dateModified content="2020-11-11T00:00:00+00:00"><meta itemprop=wordCount content="5950"><meta itemprop=image content="https://shuzang.github.io/logo.png"><meta itemprop=keywords content="区块链,"><meta property="og:title" content="以太坊开发1-虚拟机搭建以太坊私链"><meta property="og:description" content="一、单虚拟机 最简单的方式是使用一个虚拟机，这也是在条件有限的情况下的最好选择。方法是在一台虚拟机上启用多个终端，每个终端使用不同的端口通信。"><meta property="og:type" content="article"><meta property="og:url" content="https://shuzang.github.io/2019/use-virtual-machine-builds-ethereum-private-chain/"><meta property="og:image" content="https://shuzang.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-03-07T14:53:00+08:00"><meta property="article:modified_time" content="2020-11-11T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shuzang.github.io/logo.png"><meta name=twitter:title content="以太坊开发1-虚拟机搭建以太坊私链"><meta name=twitter:description content="一、单虚拟机 最简单的方式是使用一个虚拟机，这也是在条件有限的情况下的最好选择。方法是在一台虚拟机上启用多个终端，每个终端使用不同的端口通信。"><meta name=application-name content="Shuzang's Blog"><meta name=apple-mobile-web-app-title content="Shuzang's Blog"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://shuzang.github.io/2019/use-virtual-machine-builds-ethereum-private-chain/><link rel=prev href=https://shuzang.github.io/2019/blockchain-based-platform-architecture-for-industrial-iot/><link rel=next href=https://shuzang.github.io/2019/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%912-%E5%88%9B%E4%B8%96%E5%8C%BA%E5%9D%97%E6%96%87%E4%BB%B6genesis.json/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://unpkg.com/@fortawesome/fontawesome-free@6.2.0/css/all.min.css><link rel=stylesheet href=https://unpkg.com/animate.css@4.1.1/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"以太坊开发1-虚拟机搭建以太坊私链","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/shuzang.github.io\/2019\/use-virtual-machine-builds-ethereum-private-chain\/"},"genre":"posts","keywords":"区块链","wordcount":5950,"url":"https:\/\/shuzang.github.io\/2019\/use-virtual-machine-builds-ethereum-private-chain\/","datePublished":"2019-03-07T14:53:00+08:00","dateModified":"2020-11-11T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Shuzang"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title="Shuzang's Blog"><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title="Shuzang's Blog" data-alt="Shuzang's Blog" class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Shuzang's Blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/collection/><i class="fa-solid fa-bookmark fa-fw fa-sm" aria-hidden=true></i> 集子</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Shuzang's Blog"><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title=/images/avatar.png data-alt=/images/avatar.png class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Shuzang's Blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/collection/><i class="fa-solid fa-bookmark fa-fw fa-sm" aria-hidden=true></i> 集子</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>以太坊开发1-虚拟机搭建以太坊私链</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
Shuzang</span></span>
<span class=post-category>收录于 <a href=/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E7%9A%84%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 研究生的区块链学习之路</a></span></div><div class=post-meta-line><span title="发布于 2019-03-07 14:53:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2019-03-07>2019-03-07</time></span>&nbsp;<span title="更新于 2020-11-11 00:00:00"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2020-11-11>2020-11-11</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 5950 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 12 分钟</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#一单虚拟机>一、单虚拟机</a><ul><li><a href=#1-创建节点文件>1. 创建节点文件</a></li><li><a href=#2-初始化创世区块>2. 初始化创世区块</a></li><li><a href=#3-分别启动三个节点>3. 分别启动三个节点</a></li><li><a href=#4-连接各节点>4. 连接各节点</a></li></ul></li><li><a href=#二多虚拟机快速搭建>二、多虚拟机快速搭建</a><ul><li><a href=#正式搭建过程>正式搭建过程</a></li><li><a href=#补充说明>补充说明</a></li></ul></li><li><a href=#三多虚拟机详细过程>三、多虚拟机详细过程</a><ul><li><a href=#1-配置操作系统环境>1. 配置操作系统环境</a><ul><li><a href=#11-更新软件源>1.1 更新软件源</a></li><li><a href=#12-安装相关工具>1.2 安装相关工具</a></li><li><a href=#13-配置主机名>1.3 配置主机名</a></li><li><a href=#14-配置地址解析>1.4 配置地址解析</a></li><li><a href=#15-同步时间>1.5 同步时间</a></li></ul></li><li><a href=#2-配置-golang-环境>2. 配置 Golang 环境</a></li><li><a href=#3-安装部署>3. 安装部署</a><ul><li><a href=#31-获取源代码>3.1 获取源代码</a></li><li><a href=#32-创建创世区块>3.2 创建创世区块</a></li><li><a href=#33-启动服务>3.3 启动服务</a></li></ul></li><li><a href=#4-节点通信>4. 节点通信</a><ul><li><a href=#41-查看集群节点>4.1 查看集群节点</a></li><li><a href=#42-获取节点信息>4.2 获取节点信息</a></li><li><a href=#43-将-nodeb-加入-nodea>4.3 将 NodeB 加入 NodeA</a></li><li><a href=#44-查看新加入的节点>4.4 查看新加入的节点</a></li><li><a href=#45-将-nodec-加入-nodea-与-nodeb>4.5 将 NodeC 加入 NodeA 与 NodeB</a></li><li><a href=#46-查看节点加入信息>4.6 查看节点加入信息</a></li></ul></li><li><a href=#5-测试>5. 测试</a><ul><li><a href=#51-转账测试>5.1 转账测试</a></li><li><a href=#52-挖矿测试>5.2 挖矿测试</a></li><li><a href=#53-查询余额>5.3 查询余额</a></li><li><a href=#54-交易转账>5.4 交易转账</a></li></ul></li></ul></li><li><a href=#附录>附录</a><ul><li><a href=#1-创世区块配置文件参数说明>1. 创世区块配置文件参数说明</a></li><li><a href=#2-私链服务启动常见参数说明>2. 私链服务启动常见参数说明</a></li><li><a href=#3-控制台命令说明>3. 控制台命令说明</a></li></ul></li></ul></nav></div></div><div class=content id=content><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-exclamation-triangle fa-fw" aria-hidden=true></i>警告<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>本文最后更新于 2020-11-11，文中内容可能已过时。</div></div></div><h2 id=一单虚拟机>一、单虚拟机</h2><p>最简单的方式是使用一个虚拟机，这也是在条件有限的情况下的最好选择。方法是在一台虚拟机上启用多个终端，每个终端使用不同的端口通信。步骤如下</p><h3 id=1-创建节点文件>1. 创建节点文件</h3><p>在<code>~Desktop</code>路径下创建NodeA、NodeB和NodeC三个文件夹，代表三个节点。在三个文件夹中分别创建<code>genesis.json</code>文件</p><h3 id=2-初始化创世区块>2. 初始化创世区块</h3><p>分别执行<code>geth init</code>命令初始化创世区块</p><div class=highlight id=id-1><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth --datadir ~/Desktop/NodeA/dataA init genesis.json
</span></span><span class=line><span class=cl>$ geth --datadir ~/Desktop/NodeB/dataB init genesis.json
</span></span><span class=line><span class=cl>$ geth --datadir ~/Desktip/NodeC/dataC init genesis.json</span></span></code></pre></td></tr></table></div></div><h3 id=3-分别启动三个节点>3. 分别启动三个节点</h3><p>启动NodeA</p><div class=highlight id=id-2><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth --datadir ~/Desktop/NodeA/dataA --networkid <span class=m>22</span> --nodiscover console</span></span></code></pre></td></tr></table></div></div><p>默认的端口是30303，因为三个节点在同一个操作系统中，所以接下来启动其它两个节点时我们要指定使用其它的接口</p><div class=highlight id=id-3><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth --datadir ~/Desktop/NodeA/dataB --port <span class=m>30304</span> --networkid <span class=m>22</span> --nodiscover console
</span></span><span class=line><span class=cl>$ geth --datadir ~/Desktop/NodeA/dataC --port <span class=m>30305</span> --networkid <span class=m>22</span> --nodiscover console</span></span></code></pre></td></tr></table></div></div><h3 id=4-连接各节点>4. 连接各节点</h3><p>这里就使用<code>admin.addPeers</code>连接各节点就可以了。</p><h2 id=二多虚拟机快速搭建>二、多虚拟机快速搭建</h2><p>最理想的方式是使用多台电脑，但是一般情况下实验条件不足，不过在电脑性能足够的情况下，可以开启多台虚拟机模拟这样的环境，这里的示例使用三台Ubuntu18.04 LTS系统的虚拟机。</p><p>在走了一遍完整搭建流程后，精简不需要的步骤，将快速搭建的过程总结如下，如果想要查看详细的步骤和描述信息，请看第三部分。省略的步骤包括</p><ul><li>更新软件源</li><li>配置主机名</li><li>配置地址解析</li><li>同步时间</li><li>配置Golang环境</li><li>下载编译以太坊源码</li></ul><h3 id=正式搭建过程>正式搭建过程</h3><ol><li><p>安装网络工具</p><div class=highlight id=id-4><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get install -y net-tools</span></span></code></pre></td></tr></table></div></div></li><li><p>安装geth</p><div class=highlight id=id-5><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo add-apt-repository -y ppa:ethereum/ethereum
</span></span><span class=line><span class=cl>$ sudo apt-get update
</span></span><span class=line><span class=cl>$ sudo apt-get install ethereum
</span></span><span class=line><span class=cl>$ geth --help</span></span></code></pre></td></tr></table></div></div><p>详细过程可以查看<a href=https://ethereum.github.io/go-ethereum/install/ target=_blank rel="external nofollow noopener noreferrer">Installing Go Ethereum</a></p></li><li><p>创建创世区块文件</p><div class=highlight id=id-6><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mkdir ~/nodeA
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> ~/nodeA
</span></span><span class=line><span class=cl>$ touch genesis.json</span></span></code></pre></td></tr></table></div></div></li><li><p>编辑<code>genesis.json</code>文件内容如下</p><div class=highlight id=id-7><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;config&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>       <span class=s2>&#34;chainId&#34;</span>: 72,
</span></span><span class=line><span class=cl>       <span class=s2>&#34;homesteadBlock&#34;</span>: 0,
</span></span><span class=line><span class=cl>       <span class=s2>&#34;eip155Block&#34;</span>: 0,
</span></span><span class=line><span class=cl>       <span class=s2>&#34;eip158Block&#34;</span>: <span class=m>0</span>
</span></span><span class=line><span class=cl>   <span class=o>}</span>,
</span></span><span class=line><span class=cl> <span class=s2>&#34;alloc&#34;</span>      : <span class=o>{}</span>,
</span></span><span class=line><span class=cl> <span class=s2>&#34;coinbase&#34;</span>   : <span class=s2>&#34;0x0000000000000000000000000000000000000000&#34;</span>,
</span></span><span class=line><span class=cl> <span class=s2>&#34;difficulty&#34;</span> : <span class=s2>&#34;0x40&#34;</span>,
</span></span><span class=line><span class=cl> <span class=s2>&#34;extraData&#34;</span>  : <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl> <span class=s2>&#34;gasLimit&#34;</span>   : <span class=s2>&#34;0x2fefd8&#34;</span>,
</span></span><span class=line><span class=cl> <span class=s2>&#34;nonce&#34;</span>      : <span class=s2>&#34;0x0000000000000000&#34;</span>,
</span></span><span class=line><span class=cl> <span class=s2>&#34;mixhash&#34;</span>    : <span class=s2>&#34;0x0000000000000000000000000000000000000000000000000000000000000000&#34;</span>,
</span></span><span class=line><span class=cl> <span class=s2>&#34;parentHash&#34;</span> :<span class=s2>&#34;0x0000000000000000000000000000000000000000000000000000000000000000&#34;</span>,
</span></span><span class=line><span class=cl> <span class=s2>&#34;timestamp&#34;</span>  : <span class=s2>&#34;0x00&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div><p>之后克隆得到三个虚拟机，作为区块链的三个节点</p></li><li><p>创建data文件夹供存储区块链数据</p><div class=highlight id=id-8><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mkdir ~/nodeA/data <span class=p>&amp;</span> <span class=nb>cd</span> ~/nodeA</span></span></code></pre></td></tr></table></div></div></li><li><p>初始化创世区块</p><div class=highlight id=id-9><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>geth --datadir data/ init genesis.json</span></span></code></pre></td></tr></table></div></div></li><li><p>启动网络</p><div class=highlight id=id-10><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth --datadir data/ --networkid <span class=m>72</span> --nodiscover console
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Welcome to the Geth JavaScript console!</span></span></code></pre></td></tr></table></div></div></li><li><p>获取节点信息</p><div class=highlight id=id-11><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; admin.nodeInfo.enode</span></span></code></pre></td></tr></table></div></div><p>分别在三个节点执行上述命令，得到的三个节点的信息为：</p><div class=highlight id=id-12><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NodeA: <span class=s2>&#34;enode://d0d6a32cacb349c8f8c92372dc3a1e118384720636519a46c14067a3b62f6cfa8549a8766ade0f91790ebdadfb44341e03c50a171b714070527be96ed037707e@[::]:30303?discport=0&#34;</span>
</span></span><span class=line><span class=cl>NodeB: <span class=s2>&#34;enode://d9fc148c9808fbfee7954bd3324bfdff42777de7d2545ac3c2357f05939dbd8ee153cd32320a05f4dbf18138007f743f3a2097b62e71c3c47bb3cf1559dd1328@[::]:30303?discport=0&#34;</span>
</span></span><span class=line><span class=cl>NodeC: <span class=s2>&#34;enode://246782d2429f4697e18009505989ed82c2c0a664aab96ed80b96e28be42b6d9e2d11b27806ea43e46fddfcb3e9a41e9df4889636f51e3dadc0c937b0735d0bdc@[::]:30303?discport=0&#34;</span></span></span></code></pre></td></tr></table></div></div></li><li><p>在NodeA执行下列命令，将NodeB加入网络，NodeC同理</p><div class=highlight id=id-13><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt;admin.addPeer<span class=o>(</span><span class=s2>&#34;enode://d9fc148c9808fbfee7954bd3324bfdff42777de7d2545ac3c2357f05939dbd8ee153cd32320a05f4dbf18138007f743f3a2097b62e71c3c47bb3cf1559dd1328@[::]:30303&#34;</span><span class=o>)</span></span></span></code></pre></td></tr></table></div></div><p>将 [::] 修改为正确节点的 IP 地址，是之前用ifconfig命令查询并记录的本地地址，不支持DNS解析的域名地址，只支持点分十进制格式的IP地址。删除` ?discport=0</p></li><li><p>查看节点连接信息</p><div class=highlight id=id-14><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; admin.peers</span></span></code></pre></td></tr></table></div></div><p>节点关机后，会自动被删除，节点重新启动后，会自动加入节点集群, 但是如果所有节点全部断掉，则需要重新添加。</p></li><li><p>转账和挖矿测试查看下面的详细搭建过程</p></li></ol><h3 id=补充说明>补充说明</h3><ol><li><p><code>genesis.json</code>文件的相关说明可参见<a href=https://shuzang.github.io/2019/%e4%bb%a5%e5%a4%aa%e5%9d%8a-%e5%88%9b%e4%b8%96%e5%8c%ba%e5%9d%97%e6%96%87%e4%bb%b6genesis.json/ target=_blank rel="external nofollow noopener noreferrer">以太坊-创世区块文件genesis.json</a></p></li><li><p><code>geth</code>命令的参数说明参见<a href=https://shuzang.github.io/2019/%E4%BB%A5%E5%A4%AA%E5%9D%8A-geth%E5%91%BD%E4%BB%A4%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E/ target=_blank rel="external nofollow noopener noreferrer">以太坊-geth命令参数说明</a></p></li><li><p>本文后半部分以<code>></code>开头的命令是控制台命令，这是一个以太坊提供的交互式的JavaScript环境，可以在该环境中进行命令或者代码的执行操作，具体内容参见<a href=https://shuzang.github.io/2019/%E4%BB%A5%E5%A4%AA%E5%9D%8A-geth-console%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/ target=_blank rel="external nofollow noopener noreferrer">以太坊-Geth Console命令详解</a></p></li><li><p>本文使用了<code>admin.addPeer()</code>命令进行节点连接，但实际上还有其它方式，具体每种方式的使用参见<a href=https://shuzang.github.io/2019/%E4%BB%A5%E5%A4%AA%E5%9D%8A-%E8%8A%82%E7%82%B9%E8%BF%9E%E6%8E%A5%E5%88%B0%E7%BD%91%E7%BB%9C%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F/ target=_blank rel="external nofollow noopener noreferrer">以太坊-节点连接到网络的几种方式</a></p></li><li><p>geth命令和控制台命令有时候能实现同样的功能，比如</p><div class=highlight id=id-15><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth --datadir data/ account new</span></span></code></pre></td></tr></table></div></div><div class=highlight id=id-16><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; personal.newAccount<span class=o>()</span></span></span></code></pre></td></tr></table></div></div><p>两条命令均是实现创建新账户的功能</p></li><li><p>第4条所述节点连接方式中有一种是实现创建<code>static-nodes.json</code>文件用于之后的节点识别，但该方式需要账户地址，故只能使用geth命令创建新账户，而本文所述方式可以在节点连接后，再在控制台下创建账户用于转账和挖矿的操作。</p></li></ol><h2 id=三多虚拟机详细过程>三、多虚拟机详细过程</h2><p>主要内容来自 <a href=https://blog.51cto.com/clovemfong/2280872 target=_blank rel="external nofollow noopener noreferrer">https://blog.51cto.com/clovemfong/2280872</a></p><p>使用了多个虚拟机搭建，每个虚拟机代表一个区块链节点。自编译了以太坊源码，并且由于区块链的特性，对Linux的时间做了一定的配置，同时为了多个节点间的连接，对IP地址做了配置处理。以上这些不是必须的，但能让我们思路清晰，明白构建一个区块链应该保证什么条件。</p><h3 id=1-配置操作系统环境>1. 配置操作系统环境</h3><p>本文的操作环境是在虚拟机上完成，共计三台虚拟机 (配置尽量高上去，如下这个配置挖矿太耗时，这里的配置主要指内存和CPU的核，因为以太坊的挖矿算法Ethash主要和内存有关，而CPU的核多一点挖矿时可以多开几个线程)</p><table><thead><tr><th>主机名</th><th>IP 地址</th><th>操作系统</th><th>内存 / GB</th><th>CPU / 核</th></tr></thead><tbody><tr><td>nodeA.shuzang.com</td><td>172.16.222.189</td><td>Ubuntu18.04 LTS</td><td>2</td><td>2</td></tr><tr><td>nodeB.shuzang.com</td><td>172.16.222.190</td><td>Ubuntu18.04 LTS</td><td>2</td><td>2</td></tr><tr><td>nodeC.shuzang.com</td><td>172.16.222.191</td><td>Ubuntu18.04 LTS</td><td>2</td><td>2</td></tr></tbody></table><blockquote><p>Q：linux下设置主机名的时候，为什么都要求设置成：name.domain.com这种域名的样式.</p><p>A：因为linux等类unix系统都是为网络应用而开发的，主机的性能可以不需要很强大，只需要能够登录到服务器（也就是加入某个域），就可以利用服务器的资源，因此安装系统时如果主机是在某个域里，设置域名就表明该主机是这个域里的一员，通过合法的帐号和密码就可以连接登录到域服务器。如果是单机或者个人家庭网络，域名就可以随便设置了</p></blockquote><p>注1：以 nodeA 为例进行相关配置，其他节点配置操作相同</p><p>注2：IP地址一栏应在虚拟机创建好后用ifconfig命令查看并记录</p><h4 id=11-更新软件源>1.1 更新软件源</h4><p>根据自己需要选择是否需要更换软件源，此处用的是原生的即可。</p><div class=highlight id=id-17><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get  update</span></span></code></pre></td></tr></table></div></div><h4 id=12-安装相关工具>1.2 安装相关工具</h4><div class=highlight id=id-18><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get  install vim openssh-server ntp ntpdate make gcc net-tools  -y</span></span></code></pre></td></tr></table></div></div><h4 id=13-配置主机名>1.3 配置主机名</h4><div class=highlight id=id-19><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo hostname nodeA.shuzang.com</span></span></code></pre></td></tr></table></div></div><h4 id=14-配置地址解析>1.4 配置地址解析</h4><div class=highlight id=id-20><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ vim /etc/hosts
</span></span><span class=line><span class=cl>127.0.0.1       localhost
</span></span><span class=line><span class=cl>172.16.222.189  nodeA.shuzang.com
</span></span><span class=line><span class=cl>172.16.222.190  nodeB.shuzang.com
</span></span><span class=line><span class=cl>172.16.222.191  nodeC.shuzang.com</span></span></code></pre></td></tr></table></div></div><p>hostname &ndash;fqdn 验证</p><div class=highlight id=id-21><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ hostname -f        
</span></span><span class=line><span class=cl>nodeA.shuzang.com</span></span></code></pre></td></tr></table></div></div><h4 id=15-同步时间>1.5 同步时间</h4><p>修改时区</p><div class=highlight id=id-22><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo timedatectl set-timezone <span class=s2>&#34;Asia/Shanghai&#34;</span> </span></span></code></pre></td></tr></table></div></div><p>手动同步</p><div class=highlight id=id-23><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo ntpdate time1.aliyun.com    </span></span></code></pre></td></tr></table></div></div><p>同步硬件时间</p><div class=highlight id=id-24><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo hwclock  -w <span class=c1># 系统时间同步至硬件</span></span></span></code></pre></td></tr></table></div></div><p>手动设置完毕后，再通过如下方式进行 ntp 服务的配置，可以选择现有或者自建的时间服务器</p><p>测试连通性</p><div class=highlight id=id-25><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ntpdate -q time1.aliyun.com 
</span></span><span class=line><span class=cl>server 203.107.6.88, stratum 2, offset 0.050751, delay 0.06232
</span></span><span class=line><span class=cl><span class=m>22</span> Sep 21:04:36 ntpdate<span class=o>[</span>8082<span class=o>]</span>: adjust <span class=nb>time</span> server 203.107.6.88 offset 0.050751 sec </span></span></code></pre></td></tr></table></div></div><p>修改配置文件</p><div class=highlight id=id-26><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo cp /etc/ntp.conf  /etc/ntp.conf_shuzang_201809231208 <span class=c1>#备份配置文件</span>
</span></span><span class=line><span class=cl>$ sudo vim /etc/ntp.conf //修改配置文件</span></span></code></pre></td></tr></table></div></div><p>修改信息如下</p><div class=highlight id=id-27><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Use servers from the NTP Pool Project. Approved by Ubuntu Technical Board</span>
</span></span><span class=line><span class=cl><span class=c1># on 2011-02-08 (LP: #104525). See http://www.pool.ntp.org/join.html for</span>
</span></span><span class=line><span class=cl><span class=c1># more information.</span>
</span></span><span class=line><span class=cl><span class=c1>#pool 0.ubuntu.pool.ntp.org iburst</span>
</span></span><span class=line><span class=cl><span class=c1>#pool 1.ubuntu.pool.ntp.org iburst</span>
</span></span><span class=line><span class=cl><span class=c1>#pool 2.ubuntu.pool.ntp.org iburst</span>
</span></span><span class=line><span class=cl><span class=c1>#pool 3.ubuntu.pool.ntp.org iburst</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>server time1.aliyun.com
</span></span><span class=line><span class=cl>server time2.aliyun.com
</span></span><span class=line><span class=cl>server time3.aliyun.com
</span></span><span class=line><span class=cl>server time4.aliyun.com
</span></span><span class=line><span class=cl>server time5.aliyun.com
</span></span><span class=line><span class=cl>server time6.aliyun.com
</span></span><span class=line><span class=cl>server time7.aliyun.com</span></span></code></pre></td></tr></table></div></div><p>启动 ntp 服务</p><div class=highlight id=id-28><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo systemctl  restart ntp  <span class=c1>#启动ntp服务</span></span></span></code></pre></td></tr></table></div></div><h3 id=2-配置-golang-环境>2. 配置 Golang 环境</h3><p>下载 go 安装包</p><div class=highlight id=id-29><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mkdir ethereum <span class=p>;</span><span class=nb>cd</span> ethereum
</span></span><span class=line><span class=cl>$ wget https://dl.google.com/go/go1.11.linux-amd64.tar.gz</span></span></code></pre></td></tr></table></div></div><p>解压安装包</p><div class=highlight id=id-30><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo tar zxvf  go1.11.linux-amd64.tar.gz   -C /usr/local/</span></span></code></pre></td></tr></table></div></div><p>配置环境变量</p><div class=highlight id=id-31><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$  mkdir -p ~/workspace/<span class=o>{</span>src,pkg,bin<span class=o>}</span> 
</span></span><span class=line><span class=cl>$ sudo cp  /etc/profile /etc/profile_shuzang_201809231354
</span></span><span class=line><span class=cl>$ sudo vim /etc/profile 
</span></span><span class=line><span class=cl><span class=c1># 配置文件中添加如下信息</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOROOT</span><span class=o>=</span><span class=s2>&#34;/usr/local/go&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOPATH</span><span class=o>=</span><span class=s2>&#34;/home/ubuntu/workspace&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOBIN</span><span class=o>=</span><span class=nv>$GOPATH</span>/bin
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$PATH</span>:<span class=nv>$GOROOT</span>/bin</span></span></code></pre></td></tr></table></div></div><p>检查配置</p><div class=highlight id=id-32><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>source</span> /etc/profile
</span></span><span class=line><span class=cl>$ go env
</span></span><span class=line><span class=cl><span class=nv>GOARCH</span><span class=o>=</span><span class=s2>&#34;amd64&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GOBIN</span><span class=o>=</span><span class=s2>&#34;/home/ubuntu/workspace/bin&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GOCACHE</span><span class=o>=</span><span class=s2>&#34;/home/ubuntu/.cache/go-build&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GOEXE</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GOFLAGS</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GOHOSTARCH</span><span class=o>=</span><span class=s2>&#34;amd64&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GOHOSTOS</span><span class=o>=</span><span class=s2>&#34;linux&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GOOS</span><span class=o>=</span><span class=s2>&#34;linux&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GOPATH</span><span class=o>=</span><span class=s2>&#34;/home/ubuntu/workspace&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GOPROXY</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>......</span></span></code></pre></td></tr></table></div></div><h3 id=3-安装部署>3. 安装部署</h3><h4 id=31-获取源代码>3.1 获取源代码</h4><p>以太坊的源码文件网址如下</p><div class=highlight id=id-33><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>https://github.com/ethereum/go-ethereum</span></span></code></pre></td></tr></table></div></div><p>可以选择通过<code>git clone</code>或者下载<code>zip</code>包的方式进行源代码的获取, 为了方便起见，本文直接下载 zip 包上传至三台节点进行解压部署。</p><p>下载源码包</p><div class=highlight id=id-34><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>cd</span> /home/ubuntu/ethereum
</span></span><span class=line><span class=cl>$ wget  https://github.com/ethereum/go-ethereum/archive/master.zip</span></span></code></pre></td></tr></table></div></div><p>解压源码包</p><div class=highlight id=id-35><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ unzip master.zip
</span></span><span class=line><span class=cl>$ mkdir ~/workspace/github.com/
</span></span><span class=line><span class=cl>$ mv go-ethereum-master/   ~/workspace/github.com/go-ethereum
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> ~/workspace/github.com/go-ethereum <span class=p>;</span> make geth  <span class=c1>#编译安装</span></span></span></code></pre></td></tr></table></div></div><p>添加环境变量</p><div class=highlight id=id-36><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo vim /etc/profile
</span></span><span class=line><span class=cl><span class=c1># 添加及修改如下信息</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GETH</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$GOPATH</span><span class=s2>/github.com/go-ethereum/build&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$PATH</span>:<span class=nv>$GOROOT</span>/bin:<span class=nv>$GETH</span>/bin</span></span></code></pre></td></tr></table></div></div><p>测试生效</p><div class=highlight id=id-37><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>source</span> /etc/profile
</span></span><span class=line><span class=cl>$ geth --help</span></span></code></pre></td></tr></table></div></div><p>至此环境配置完成，可以完成后进行虚拟机复制，得到三个虚拟机，然后再对主机名等进行修改，也可以等genesis.json文件创建完成后在进行虚拟机复制，然后修改相关名称。这样可以免去重复的环境配置工作，节省大量时间。</p><h4 id=32-创建创世区块>3.2 创建创世区块</h4><p>创建数据存储目录</p><div class=highlight id=id-38><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ mkdir -p /home/ubuntu/nodeA/data0
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> /home/ubuntu/nodeA</span></span></code></pre></td></tr></table></div></div><p>创世区块配置文件<code>genesis.json</code></p><div class=highlight id=id-39><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;config&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;chainId&#34;</span>: 66,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;homesteadBlock&#34;</span>: 0,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;eip155Block&#34;</span>: 0,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;eip158Block&#34;</span>: <span class=m>0</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;alloc&#34;</span>      : <span class=o>{}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;coinbase&#34;</span>   : <span class=s2>&#34;0x0000000000000000000000000000000000000000&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;difficulty&#34;</span> : <span class=s2>&#34;0x20000&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;extraData&#34;</span>  : <span class=s2>&#34;&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;gasLimit&#34;</span>   : <span class=s2>&#34;0x2fefd8&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;nonce&#34;</span>      : <span class=s2>&#34;0x0000000000000042&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;mixhash&#34;</span>    : <span class=s2>&#34;0x0000000000000000000000000000000000000000000000000000000000000000&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;parentHash&#34;</span> :<span class=s2>&#34;0x0000000000000000000000000000000000000000000000000000000000000000&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;timestamp&#34;</span>  : <span class=s2>&#34;0x00&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div><p>难度"difficulty"可以设置小一点，比如"0x40"，这样挖矿会容易一点，不然配置不好就只能死等。</p><p>初始化创世区块</p><div class=highlight id=id-40><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth  --datadir data0/  init genesis.json</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src="https://s1.51cto.com/images/blog/201809/23/3cbb855f451fe1cb71b6b3efa7c598ac.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" srcset="https://s1.51cto.com/images/blog/201809/23/3cbb855f451fe1cb71b6b3efa7c598ac.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk=, https://s1.51cto.com/images/blog/201809/23/3cbb855f451fe1cb71b6b3efa7c598ac.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 1.5x, https://s1.51cto.com/images/blog/201809/23/3cbb855f451fe1cb71b6b3efa7c598ac.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 2x" sizes=auto data-title="https://s1.51cto.com/images/blog/201809/23/3cbb855f451fe1cb71b6b3efa7c598ac.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" data-alt="https://s1.51cto.com/images/blog/201809/23/3cbb855f451fe1cb71b6b3efa7c598ac.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h4 id=33-启动服务>3.3 启动服务</h4><div class=highlight id=id-41><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth --datadir data0/ --networkid <span class=m>66</span> --nodiscover console
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Welcome to the Geth JavaScript console!</span></span></code></pre></td></tr></table></div></div><p>nodiscover : 设置为不自动发现，用于控制联盟链的节点加入
<img loading=lazy src="https://s1.51cto.com/images/blog/201809/23/813b196e06db099346217fd27420ac82.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" srcset="https://s1.51cto.com/images/blog/201809/23/813b196e06db099346217fd27420ac82.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk=, https://s1.51cto.com/images/blog/201809/23/813b196e06db099346217fd27420ac82.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 1.5x, https://s1.51cto.com/images/blog/201809/23/813b196e06db099346217fd27420ac82.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 2x" sizes=auto data-title="https://s1.51cto.com/images/blog/201809/23/813b196e06db099346217fd27420ac82.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" data-alt="https://s1.51cto.com/images/blog/201809/23/813b196e06db099346217fd27420ac82.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h3 id=4-节点通信>4. 节点通信</h3><h4 id=41-查看集群节点>4.1 查看集群节点</h4><div class=highlight id=id-42><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; admin.peers
</span></span><span class=line><span class=cl><span class=o>[]</span></span></span></code></pre></td></tr></table></div></div><p>目前为空状态，表明未于其他节点进行通信。</p><h4 id=42-获取节点信息>4.2 获取节点信息</h4><div class=highlight id=id-43><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; admin.nodeInfo.enode</span></span></code></pre></td></tr></table></div></div><p>分别在三个节点的 console 上执行命令，显示如下:</p><p>NodeA</p><div class=highlight id=id-44><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=s2>&#34;enode://d0d6a32cacb349c8f8c92372dc3a1e118384720636519a46c14067a3b62f6cfa8549a8766ade0f91790ebdadfb44341e03c50a171b714070527be96ed037707e@[::]:30303?discport=0&#34;</span></span></span></code></pre></td></tr></table></div></div><p>NodeB</p><div class=highlight id=id-45><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=s2>&#34;enode://d9fc148c9808fbfee7954bd3324bfdff42777de7d2545ac3c2357f05939dbd8ee153cd32320a05f4dbf18138007f743f3a2097b62e71c3c47bb3cf1559dd1328@[::]:30303?discport=0&#34;</span></span></span></code></pre></td></tr></table></div></div><p>NodeC</p><div class=highlight id=id-46><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=s2>&#34;enode://246782d2429f4697e18009505989ed82c2c0a664aab96ed80b96e28be42b6d9e2d11b27806ea43e46fddfcb3e9a41e9df4889636f51e3dadc0c937b0735d0bdc@[::]:30303?discport=0&#34;</span></span></span></code></pre></td></tr></table></div></div><h4 id=43-将-nodeb-加入-nodea>4.3 将 NodeB 加入 NodeA</h4><p>在 NodeA 节点上执行如下命令</p><div class=highlight id=id-47><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt;admin.addPeer<span class=o>(</span><span class=s2>&#34;enode://d9fc148c9808fbfee7954bd3324bfdff42777de7d2545ac3c2357f05939dbd8ee153cd32320a05f4dbf18138007f743f3a2097b62e71c3c47bb3cf1559dd1328@172.16.222.190:30303&#34;</span><span class=o>)</span></span></span></code></pre></td></tr></table></div></div><p>返回<code>true</code>表示加入成功，注意</p><ul><li>将 [::] 修改为正确节点的 IP 地址，是之前用ifconfig命令查询并记录的本地地址，不支持DNS解析的域名地址，只支持点分十进制格式的IP地址</li><li>删除<code> ?discport=0</code></li></ul><h4 id=44-查看新加入的节点>4.4 查看新加入的节点</h4><div class=highlight id=id-48><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; admin.peers</span></span></code></pre></td></tr></table></div></div><p>在 NodeA 节点上执行如下命令</p><p><img loading=lazy src="https://s1.51cto.com/images/blog/201809/23/c6d667762a931a233142b2cd992c8432.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" srcset="https://s1.51cto.com/images/blog/201809/23/c6d667762a931a233142b2cd992c8432.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk=, https://s1.51cto.com/images/blog/201809/23/c6d667762a931a233142b2cd992c8432.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 1.5x, https://s1.51cto.com/images/blog/201809/23/c6d667762a931a233142b2cd992c8432.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 2x" sizes=auto data-title="https://s1.51cto.com/images/blog/201809/23/c6d667762a931a233142b2cd992c8432.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" data-alt="https://s1.51cto.com/images/blog/201809/23/c6d667762a931a233142b2cd992c8432.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>通过查看 localAddress 跟 remoteAddress 查看节点关联信息。</p><p>在 NodeB 节点上执行如下命令</p><p><img loading=lazy src="https://s1.51cto.com/images/blog/201809/23/be124927d617e9e6ea6fddab1fe5938d.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" srcset="https://s1.51cto.com/images/blog/201809/23/be124927d617e9e6ea6fddab1fe5938d.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk=, https://s1.51cto.com/images/blog/201809/23/be124927d617e9e6ea6fddab1fe5938d.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 1.5x, https://s1.51cto.com/images/blog/201809/23/be124927d617e9e6ea6fddab1fe5938d.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 2x" sizes=auto data-title="https://s1.51cto.com/images/blog/201809/23/be124927d617e9e6ea6fddab1fe5938d.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" data-alt="https://s1.51cto.com/images/blog/201809/23/be124927d617e9e6ea6fddab1fe5938d.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>在 NodeC 节点上执行如下命令</p><div class=highlight id=id-49><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; admin.peers
</span></span><span class=line><span class=cl><span class=o>[]</span></span></span></code></pre></td></tr></table></div></div><h4 id=45-将-nodec-加入-nodea-与-nodeb>4.5 将 NodeC 加入 NodeA 与 NodeB</h4><p>在 NodeA 节点上执行如下命令</p><div class=highlight id=id-50><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt;admin.addPeer<span class=o>(</span><span class=s2>&#34;enode://246782d2429f4697e18009505989ed82c2c0a664aab96ed80b96e28be42b6d9e2d11b27806ea43e46fddfcb3e9a41e9df4889636f51e3dadc0c937b0735d0bdc@172.16.222.191:30303&#34;</span><span class=o>)</span></span></span></code></pre></td></tr></table></div></div><p>在 NodeB 节点上执行如下命令</p><div class=highlight id=id-51><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt;admin.addPeer<span class=o>(</span><span class=s2>&#34;enode://246782d2429f4697e18009505989ed82c2c0a664aab96ed80b96e28be42b6d9e2d11b27806ea43e46fddfcb3e9a41e9df4889636f51e3dadc0c937b0735d0bdc@172.16.222.191:30303&#34;</span><span class=o>)</span></span></span></code></pre></td></tr></table></div></div><h4 id=46-查看节点加入信息>4.6 查看节点加入信息</h4><p>在 NodeA 节点上执行如下命令</p><p><img loading=lazy src="https://s1.51cto.com/images/blog/201809/23/81981335147af8327eab454f0d0c0aa7.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" srcset="https://s1.51cto.com/images/blog/201809/23/81981335147af8327eab454f0d0c0aa7.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk=, https://s1.51cto.com/images/blog/201809/23/81981335147af8327eab454f0d0c0aa7.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 1.5x, https://s1.51cto.com/images/blog/201809/23/81981335147af8327eab454f0d0c0aa7.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 2x" sizes=auto data-title="https://s1.51cto.com/images/blog/201809/23/81981335147af8327eab454f0d0c0aa7.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" data-alt="https://s1.51cto.com/images/blog/201809/23/81981335147af8327eab454f0d0c0aa7.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>在 NodeB 节点上执行如下命令</p><p><img loading=lazy src="https://s1.51cto.com/images/blog/201809/23/88f203a475aef146659a9b0709892b50.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" srcset="https://s1.51cto.com/images/blog/201809/23/88f203a475aef146659a9b0709892b50.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk=, https://s1.51cto.com/images/blog/201809/23/88f203a475aef146659a9b0709892b50.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 1.5x, https://s1.51cto.com/images/blog/201809/23/88f203a475aef146659a9b0709892b50.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 2x" sizes=auto data-title="https://s1.51cto.com/images/blog/201809/23/88f203a475aef146659a9b0709892b50.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" data-alt="https://s1.51cto.com/images/blog/201809/23/88f203a475aef146659a9b0709892b50.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>在 NodeC 节点上执行如下命令</p><p><img loading=lazy src="https://s1.51cto.com/images/blog/201809/23/8b778eb62c043cf3fe8868c1c518eec2.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" srcset="https://s1.51cto.com/images/blog/201809/23/8b778eb62c043cf3fe8868c1c518eec2.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk=, https://s1.51cto.com/images/blog/201809/23/8b778eb62c043cf3fe8868c1c518eec2.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 1.5x, https://s1.51cto.com/images/blog/201809/23/8b778eb62c043cf3fe8868c1c518eec2.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 2x" sizes=auto data-title="https://s1.51cto.com/images/blog/201809/23/8b778eb62c043cf3fe8868c1c518eec2.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" data-alt="https://s1.51cto.com/images/blog/201809/23/8b778eb62c043cf3fe8868c1c518eec2.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>注意: 节点关机后，会自动被删除，节点重新启动后，会自动加入节点集群, 但是如果所有节点全部断掉，则需要重新添加。</p><h3 id=5-测试>5. 测试</h3><h4 id=51-转账测试>5.1 转账测试</h4><p>查看当前节点上的账户</p><div class=highlight id=id-52><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; personal.listAccounts
</span></span><span class=line><span class=cl><span class=c1># 或者</span>
</span></span><span class=line><span class=cl>&gt; eth.accounts</span></span></code></pre></td></tr></table></div></div><p>创建新账户</p><div class=highlight id=id-53><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; personal.newAccount<span class=o>(</span><span class=s2>&#34;shuzang1996&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;0xcd3d95c64394452313b539a1f2de54eab2b80eed&#34;</span>
</span></span><span class=line><span class=cl>&gt; personal.newAccount<span class=o>(</span><span class=s2>&#34;shuzang1997&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;0xc4f132a71da05257a71ae5872beabd12c50dbb81&#34;</span></span></span></code></pre></td></tr></table></div></div><p>查看创建的账户</p><div class=highlight id=id-54><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; personal.listAccounts
</span></span><span class=line><span class=cl><span class=o>[</span><span class=s2>&#34;0xcd3d95c64394452313b539a1f2de54eab2b80eed&#34;</span>,
</span></span><span class=line><span class=cl><span class=s2>&#34;0xc4f132a71da05257a71ae5872beabd12c50dbb81&#34;</span><span class=o>]</span></span></span></code></pre></td></tr></table></div></div><p>查看账户地址</p><div class=highlight id=id-55><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; personal.listWallets</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src="https://s1.51cto.com/images/blog/201809/23/b700aee79e063512c2f2c8f248a45919.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" srcset="https://s1.51cto.com/images/blog/201809/23/b700aee79e063512c2f2c8f248a45919.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk=, https://s1.51cto.com/images/blog/201809/23/b700aee79e063512c2f2c8f248a45919.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 1.5x, https://s1.51cto.com/images/blog/201809/23/b700aee79e063512c2f2c8f248a45919.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 2x" sizes=auto data-title="https://s1.51cto.com/images/blog/201809/23/b700aee79e063512c2f2c8f248a45919.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" data-alt="https://s1.51cto.com/images/blog/201809/23/b700aee79e063512c2f2c8f248a45919.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>查看挖矿账户</p><div class=highlight id=id-56><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; eth.coinbase
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:17:20.246<span class=o>]</span> Etherbase automatically configured       <span class=nv>address</span><span class=o>=</span>0xcD3d95c64394452313b539a1f2dE54Eab2B80eEd
</span></span><span class=line><span class=cl><span class=s2>&#34;0xcd3d95c64394452313b539a1f2de54eab2b80eed&#34;</span></span></span></code></pre></td></tr></table></div></div><p>默认情况下，平台会选择创建的第一个账户作为挖矿账户 (coinbase)，可以通过 miner.setEthbase() 进行 coinbase 账户的设置。</p><h4 id=52-挖矿测试>5.2 挖矿测试</h4><p>注意：在执行挖矿命令之前，务必在节点上面设置挖矿账户 (coinbase)，否则会报错<code>Error: etherbase missing: etherbase must be explicitly specified</code></p><p>当前账户信息为</p><div class=highlight id=id-57><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NodeA:<span class=o>[</span><span class=s2>&#34;0xcd3d95c64394452313b539a1f2de54eab2b80eed&#34;</span>,<span class=s2>&#34;0xc4f132a71da05257a71ae5872beabd12c50dbb81&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>NodeB：<span class=o>[</span><span class=s2>&#34;0x22160d844b4016ed8f45ce63c405de72b1946696&#34;</span>,<span class=s2>&#34;0x23e80b2f1f74fc6da4bcb015d17ed642bcc98c06&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>NodeC:
</span></span><span class=line><span class=cl><span class=o>[</span><span class=s2>&#34;0xa37539c0f41fea23c81f65b196df825202bc3bb5&#34;</span>,<span class=s2>&#34;0x3c9cdb2f29606a0b35ae95b51521a41bb5b48e27&#34;</span><span class=o>]</span></span></span></code></pre></td></tr></table></div></div><p>启动挖矿</p><div class=highlight id=id-58><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; miner.start<span class=o>()</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:41.223<span class=o>]</span> Updated mining threads                   <span class=nv>threads</span><span class=o>=</span><span class=m>6</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:41.223<span class=o>]</span> Transaction pool price threshold updated <span class=nv>price</span><span class=o>=</span><span class=m>1000000000</span>
</span></span><span class=line><span class=cl>null
</span></span><span class=line><span class=cl>&gt; INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:41.225<span class=o>]</span> Commit new mining work                   <span class=nv>number</span><span class=o>=</span><span class=m>1</span> <span class=nv>sealhash</span><span class=o>=</span>b16ebe…9b0094 <span class=nv>uncles</span><span class=o>=</span><span class=m>0</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>gas</span><span class=o>=</span><span class=m>0</span> <span class=nv>fees</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>794.985µs
</span></span><span class=line><span class=cl>&gt; INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:52.671<span class=o>]</span> Successfully sealed new block            <span class=nv>number</span><span class=o>=</span><span class=m>1</span> <span class=nv>sealhash</span><span class=o>=</span>b16ebe…9b0094 <span class=nv>hash</span><span class=o>=</span>082473…eb94b6 <span class=nv>elapsed</span><span class=o>=</span>11.446s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:52.671<span class=o>]</span> ined potential block                  <span class=nv>number</span><span class=o>=</span><span class=m>1</span> <span class=nv>hash</span><span class=o>=</span>082473…eb94b6
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:52.672<span class=o>]</span> Commit new mining work                   <span class=nv>number</span><span class=o>=</span><span class=m>2</span> <span class=nv>sealhash</span><span class=o>=</span>7a67a7…3c98aa <span class=nv>uncles</span><span class=o>=</span><span class=m>0</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>gas</span><span class=o>=</span><span class=m>0</span> <span class=nv>fees</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>1.062ms
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:55.115<span class=o>]</span> Successfully sealed new block            <span class=nv>number</span><span class=o>=</span><span class=m>2</span> <span class=nv>sealhash</span><span class=o>=</span>7a67a7…3c98aa <span class=nv>hash</span><span class=o>=</span>c5cd53…c3e66b <span class=nv>elapsed</span><span class=o>=</span>2.443s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:55.115<span class=o>]</span> ined potential block                  <span class=nv>number</span><span class=o>=</span><span class=m>2</span> <span class=nv>hash</span><span class=o>=</span>c5cd53…c3e66b
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:55.116<span class=o>]</span> Commit new mining work                   <span class=nv>number</span><span class=o>=</span><span class=m>3</span> <span class=nv>sealhash</span><span class=o>=</span>cc1414…f36ad7 <span class=nv>uncles</span><span class=o>=</span><span class=m>0</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>gas</span><span class=o>=</span><span class=m>0</span> <span class=nv>fees</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>343.53µs
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:55.166<span class=o>]</span> Successfully sealed new block            <span class=nv>number</span><span class=o>=</span><span class=m>3</span> <span class=nv>sealhash</span><span class=o>=</span>cc1414…f36ad7 <span class=nv>hash</span><span class=o>=</span>765d41…03ce17 <span class=nv>elapsed</span><span class=o>=</span>50.270ms
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:55.166<span class=o>]</span> ined potential block                  <span class=nv>number</span><span class=o>=</span><span class=m>3</span> <span class=nv>hash</span><span class=o>=</span>765d41…03ce17
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:55.167<span class=o>]</span> Commit new mining work                   <span class=nv>number</span><span class=o>=</span><span class=m>4</span> <span class=nv>sealhash</span><span class=o>=</span>cb5122…e36b2c <span class=nv>uncles</span><span class=o>=</span><span class=m>0</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>gas</span><span class=o>=</span><span class=m>0</span> <span class=nv>fees</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>718.996µs
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:58.048<span class=o>]</span> Successfully sealed new block            <span class=nv>number</span><span class=o>=</span><span class=m>4</span> <span class=nv>sealhash</span><span class=o>=</span>cb5122…e36b2c <span class=nv>hash</span><span class=o>=</span>ab1e6d…03b40b <span class=nv>elapsed</span><span class=o>=</span>2.881s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:58.048<span class=o>]</span> ined potential block                  <span class=nv>number</span><span class=o>=</span><span class=m>4</span> <span class=nv>hash</span><span class=o>=</span>ab1e6d…03b40b
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:58.049<span class=o>]</span> Commit new mining work                   <span class=nv>number</span><span class=o>=</span><span class=m>5</span> <span class=nv>sealhash</span><span class=o>=</span>0dd5ab…5d47d9 <span class=nv>uncles</span><span class=o>=</span><span class=m>0</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>gas</span><span class=o>=</span><span class=m>0</span> <span class=nv>fees</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>159.</span></span></code></pre></td></tr></table></div></div><p>注意: 尽量将虚拟机的配置调高一点，否则会出现以下这些信息，耗时非常久。</p><div class=highlight id=id-59><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:48:45.223<span class=o>]</span> Updated mining threads                   <span class=nv>threads</span><span class=o>=</span><span class=m>2</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:48:45.229<span class=o>]</span> Transaction pool price threshold updated <span class=nv>price</span><span class=o>=</span><span class=m>1000000000</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:48:45.230<span class=o>]</span> Etherbase automatically configured       <span class=nv>address</span><span class=o>=</span>0x22160D844B4016eD8f45cE63C405DE72B1946696
</span></span><span class=line><span class=cl>null
</span></span><span class=line><span class=cl>&gt; INFO <span class=o>[</span>09-23<span class=p>|</span>18:48:45.236<span class=o>]</span> Commit new mining work                   <span class=nv>number</span><span class=o>=</span><span class=m>1</span> <span class=nv>sealhash</span><span class=o>=</span>88e805…da6df6 <span class=nv>uncles</span><span class=o>=</span><span class=m>0</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>gas</span><span class=o>=</span><span class=m>0</span> <span class=nv>fees</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>4.290ms
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:48:48.930<span class=o>]</span> Generating DAG in progress               <span class=nv>epoch</span><span class=o>=</span><span class=m>0</span> <span class=nv>percentage</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>2.961s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:48:51.895<span class=o>]</span> Generating DAG in progress               <span class=nv>epoch</span><span class=o>=</span><span class=m>0</span> <span class=nv>percentage</span><span class=o>=</span><span class=m>1</span> <span class=nv>elapsed</span><span class=o>=</span>5.926s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:48:54.739<span class=o>]</span> Generating DAG in progress               <span class=nv>epoch</span><span class=o>=</span><span class=m>0</span> <span class=nv>percentage</span><span class=o>=</span><span class=m>2</span> <span class=nv>elapsed</span><span class=o>=</span>8.770s
</span></span><span class=line><span class=cl>..........无尽的等待.........
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:53:50.638<span class=o>]</span> Generated ethash verification cache      <span class=nv>epoch</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>5m4.669s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:54:08.357<span class=o>]</span> Generating DAG in progress               <span class=nv>epoch</span><span class=o>=</span><span class=m>1</span> <span class=nv>percentage</span><span class=o>=</span><span class=m>0</span>  <span class=nv>elapsed</span><span class=o>=</span>15.480s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:54:19.874<span class=o>]</span> Generating DAG in progress               <span class=nv>epoch</span><span class=o>=</span><span class=m>1</span> <span class=nv>percentage</span><span class=o>=</span><span class=m>1</span>  <span class=nv>elapsed</span><span class=o>=</span>26.997s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:54:29.911<span class=o>]</span> Generating DAG in progress               <span class=nv>epoch</span><span class=o>=</span><span class=m>1</span> <span class=nv>percentage</span><span class=o>=</span><span class=m>2</span>  <span class=nv>elapsed</span><span class=o>=</span>37.034s
</span></span><span class=line><span class=cl>..........无尽的等待.........
</span></span><span class=line><span class=cl>WARN <span class=o>[</span>09-23<span class=p>|</span>18:57:57.836<span class=o>]</span> Discarded bad propagated block           <span class=nv>number</span><span class=o>=</span><span class=m>1</span> <span class=nv>hash</span><span class=o>=</span>082473…eb94b6
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:58.398<span class=o>]</span> Block synchronisation started 
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:58.404<span class=o>]</span> Mining aborted due to sync 
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:58.611<span class=o>]</span> Imported new state entries               <span class=nv>count</span><span class=o>=</span><span class=m>1</span> <span class=nv>elapsed</span><span class=o>=</span>1.352ms   <span class=nv>processed</span><span class=o>=</span><span class=m>1</span> <span class=nv>pending</span><span class=o>=</span><span class=m>0</span> <span class=nv>retry</span><span class=o>=</span><span class=m>0</span> <span class=nv>duplicate</span><span class=o>=</span><span class=m>0</span> <span class=nv>unexpected</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:58.870<span class=o>]</span> Imported new block headers               <span class=nv>count</span><span class=o>=</span><span class=m>4</span> <span class=nv>elapsed</span><span class=o>=</span>95.436ms  <span class=nv>number</span><span class=o>=</span><span class=m>4</span> <span class=nv>hash</span><span class=o>=</span>ab1e6d…03b40b
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:58.889<span class=o>]</span> Imported new chain segment               <span class=nv>blocks</span><span class=o>=</span><span class=m>4</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>mgas</span><span class=o>=</span>0.000 <span class=nv>elapsed</span><span class=o>=</span>16.862ms  <span class=nv>mgasps</span><span class=o>=</span>0.000 <span class=nv>number</span><span class=o>=</span><span class=m>4</span> <span class=nv>hash</span><span class=o>=</span>ab1e6d…03b40b <span class=nv>cache</span><span class=o>=</span>849.00B
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:58.892<span class=o>]</span> Imported new block headers               <span class=nv>count</span><span class=o>=</span><span class=m>1</span> <span class=nv>elapsed</span><span class=o>=</span>20.452ms  <span class=nv>number</span><span class=o>=</span><span class=m>5</span> <span class=nv>hash</span><span class=o>=</span>75e595…4e4cc2
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>18:57:58.893<span class=o>]</span> Imported new chain segment               <span class=nv>blocks</span><span class=o>=</span><span class=m>1</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>mgas</span><span class=o>=</span>0.000 <span class=nv>elapsed</span><span class=o>=</span>316.348µs <span class=nv>mgasps</span><span class=o>=</span>0.000 <span class=nv>number</span><span class=o>=</span><span class=m>5</span> <span class=nv>hash</span><span class=o>=</span><span class=m>7</span>
</span></span><span class=line><span class=cl>..........无尽的等待.........
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>19:07:35.250<span class=o>]</span> Generated ethash verification cache      <span class=nv>epoch</span><span class=o>=</span><span class=m>1</span> <span class=nv>elapsed</span><span class=o>=</span>13m42.368s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>19:09:28.613<span class=o>]</span> Successfully sealed new block            <span class=nv>number</span><span class=o>=</span><span class=m>37</span> <span class=nv>sealhash</span><span class=o>=</span>95e0e0…ad356d <span class=nv>hash</span><span class=o>=</span>7506d6…015be8 <span class=nv>elapsed</span><span class=o>=</span>10m54.093s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>19:09:28.614<span class=o>]</span> ined potential block                  <span class=nv>number</span><span class=o>=</span><span class=m>37</span> <span class=nv>hash</span><span class=o>=</span>7506d6…015be8
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>19:09:28.619<span class=o>]</span> Commit new mining work                   <span class=nv>number</span><span class=o>=</span><span class=m>38</span> <span class=nv>sealhash</span><span class=o>=</span>96b6b0…b3d462 <span class=nv>uncles</span><span class=o>=</span><span class=m>0</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>gas</span><span class=o>=</span><span class=m>0</span> <span class=nv>fees</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>662.942µs
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>19:12:33.104<span class=o>]</span> Successfully sealed new block            <span class=nv>number</span><span class=o>=</span><span class=m>38</span> <span class=nv>sealhash</span><span class=o>=</span>96b6b0…b3d462 <span class=nv>hash</span><span class=o>=</span>a91e1b…a15902 <span class=nv>elapsed</span><span class=o>=</span>3m4.484s
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>19:12:33.105<span class=o>]</span> ined potential block                  <span class=nv>number</span><span class=o>=</span><span class=m>38</span> <span class=nv>hash</span><span class=o>=</span>a91e1b…a15902
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>19:12:33.107<span class=o>]</span> Commit new mining work                   <span class=nv>number</span><span class=o>=</span><span class=m>39</span> <span class=nv>sealhash</span><span class=o>=</span>6bf2a3…0d8be3 <span class=nv>uncles</span><span class=o>=</span><span class=m>0</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>gas</span><span class=o>=</span><span class=m>0</span> <span class=nv>fees</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>2.170ms</span></span></code></pre></td></tr></table></div></div><p>停止挖矿</p><div class=highlight id=id-60><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; miner.stop<span class=o>()</span></span></span></code></pre></td></tr></table></div></div><h4 id=53-查询余额>5.3 查询余额</h4><p>查询NodeA coinbase 账户(0xcd3d95c64394452313b539a1f2de54eab2b80eed)</p><div class=highlight id=id-61><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; eth.getBalance<span class=o>(</span>eth.coinbase<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>180000000000000000000</span></span></span></code></pre></td></tr></table></div></div><p>或者</p><div class=highlight id=id-62><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; eth.getBalance<span class=o>(</span>eth.accounts<span class=o>[</span>0<span class=o>])</span>
</span></span><span class=line><span class=cl><span class=m>180000000000000000000</span></span></span></code></pre></td></tr></table></div></div><p>可以对结果进行单位转换</p><div class=highlight id=id-63><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt;  web3.fromWei<span class=o>(</span>eth.getBalance<span class=o>(</span>eth.accounts<span class=o>[</span>0<span class=o>])</span>,<span class=s1>&#39;ether&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>180</span></span></span></code></pre></td></tr></table></div></div><p>NodeB 查询 NodeA 的 coinbase 账户</p><div class=highlight id=id-64><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; eth.getBalance<span class=o>(</span><span class=s2>&#34;0xcd3d95c64394452313b539a1f2de54eab2b80eed&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>180000000000000000000</span></span></span></code></pre></td></tr></table></div></div><p>NodeC 查询 NodeA 的 coinbase 账户</p><div class=highlight id=id-65><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; eth.getBalance<span class=o>(</span><span class=s2>&#34;0xcd3d95c64394452313b539a1f2de54eab2b80eed&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>180000000000000000000</span></span></span></code></pre></td></tr></table></div></div><p>同样，在 NodeA 和 NodeC 上面同样可以查询 NodeB 上面账号地址的余额。</p><h4 id=54-交易转账>5.4 交易转账</h4><p><strong>场景</strong>: NodeA(原有额度: 180) 的挖矿地址向 NodeB(原有额度: 10) 的挖矿地址转入 2 ETH</p><p>在进行交易转账之前，我们需要对交易转出方的账户进行解锁操作。NodeA 上执行如下命令，要求输入的密码是使用personal.newAccount创建账户时小括号内的参数</p><div class=highlight id=id-66><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; personal.unlockAccount<span class=o>(</span><span class=s2>&#34;0xcd3d95c64394452313b539a1f2de54eab2b80eed&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>Unlock account 0xcd3d95c64394452313b539a1f2de54eab2b80eed
</span></span><span class=line><span class=cl>Passphrase: 
</span></span><span class=line><span class=cl>true</span></span></code></pre></td></tr></table></div></div><p>设置转账金额，将 ETH 转成 Wei 进行交易</p><div class=highlight id=id-67><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; <span class=nv>transferAmount</span><span class=o>=</span> web3.toWei<span class=o>(</span>2,<span class=s1>&#39;ether&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;2000000000000000000&#34;</span></span></span></code></pre></td></tr></table></div></div><p>执行转账</p><div class=highlight id=id-68><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt;eth.sendTransaction<span class=o>({</span>from:<span class=s2>&#34;0xcd3d95c64394452313b539a1f2de54eab2b80eed&#34;</span>,to:<span class=s2>&#34;0x22160d844b4016ed8f45ce63c405de72b1946696&#34;</span>,value:transferAmount<span class=o>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>20:13:20.968<span class=o>]</span> Setting new <span class=nb>local</span> account                <span class=nv>address</span><span class=o>=</span>0xcD3d95c64394452313b539a1f2dE54Eab2B80eEd
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-23<span class=p>|</span>20:13:20.968<span class=o>]</span> Submitted transaction                    <span class=nv>fullhash</span><span class=o>=</span>0xd115c9ccfb1bfcc92faaf3ef6fae34ba670ef68cb03807d82d943141851985ce <span class=nv>recipient</span><span class=o>=</span>0x22160D844B4016eD8f45cE63C405DE72B1946696
</span></span><span class=line><span class=cl><span class=s2>&#34;0xd115c9ccfb1bfcc92faaf3ef6fae34ba670ef68cb03807d82d943141851985ce&#34;</span></span></span></code></pre></td></tr></table></div></div><p>查询交易池状态</p><div class=highlight id=id-69><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; txpool.status
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  pending: 1,
</span></span><span class=line><span class=cl>  queued: <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div><p>执行挖矿，指定只挖一个区块</p><div class=highlight id=id-70><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; miner.start<span class=o>()</span>  <span class=p>;</span> admin.sleepBlocks<span class=o>(</span>1<span class=o>)</span>,miner.stop<span class=o>()</span></span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src="https://s1.51cto.com/images/blog/201809/23/598f90361f820d9bd76c28352b61abbf.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" srcset="https://s1.51cto.com/images/blog/201809/23/598f90361f820d9bd76c28352b61abbf.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk=, https://s1.51cto.com/images/blog/201809/23/598f90361f820d9bd76c28352b61abbf.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 1.5x, https://s1.51cto.com/images/blog/201809/23/598f90361f820d9bd76c28352b61abbf.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 2x" sizes=auto data-title="https://s1.51cto.com/images/blog/201809/23/598f90361f820d9bd76c28352b61abbf.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" data-alt="https://s1.51cto.com/images/blog/201809/23/598f90361f820d9bd76c28352b61abbf.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>查看交易池</p><div class=highlight id=id-71><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; txpool.status
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  pending: 0,
</span></span><span class=line><span class=cl>  queued: <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div><p>查看NodeB 的 CoinBase 账户余额</p><div class=highlight id=id-72><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; web3.fromWei<span class=o>(</span>eth.getBalance<span class=o>(</span><span class=s2>&#34;0x22160d844b4016ed8f45ce63c405de72b1946696&#34;</span><span class=o>)</span>,<span class=s1>&#39;ether&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>12</span></span></span></code></pre></td></tr></table></div></div><h2 id=附录>附录</h2><h3 id=1-创世区块配置文件参数说明>1. 创世区块配置文件参数说明</h3><table><thead><tr><th>参数名</th><th>说明</th></tr></thead><tbody><tr><td>chainId</td><td>指定独立的区块链网络 ID，1-4 为保留 ID，其中 1 为主网 ID，其余为测试网</td></tr><tr><td>alloc</td><td>用来设置账号以及账号的以太币数量，私有链可以不进行设置</td></tr><tr><td>coinbase</td><td>用于获取挖矿奖励的矿工账号</td></tr><tr><td>difficulty</td><td>设置挖矿的难度系数</td></tr><tr><td>extraData</td><td>附加信息，自定义即可</td></tr><tr><td>gasLimit</td><td>设置对 gas 的消耗总量的限制, 私有链中可以填写任意数值 (大数值)</td></tr><tr><td>nonce</td><td>用于进行挖矿的随机数</td></tr><tr><td>mixhash</td><td>与 nonce 配合使用，用于挖矿</td></tr><tr><td>parentHash</td><td>上一个区块的 Hash 值，由于该区块为创世区块，所以父 Hash 值为 0</td></tr><tr><td>timestamp</td><td>时间戳</td></tr></tbody></table><p>data0 目录中的相关文件列表</p><p><img loading=lazy src="https://s1.51cto.com/images/blog/201809/23/3fb7ef20a861d9fed05427bcf778cf96.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" srcset="https://s1.51cto.com/images/blog/201809/23/3fb7ef20a861d9fed05427bcf778cf96.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk=, https://s1.51cto.com/images/blog/201809/23/3fb7ef20a861d9fed05427bcf778cf96.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 1.5x, https://s1.51cto.com/images/blog/201809/23/3fb7ef20a861d9fed05427bcf778cf96.png?x-oss-process=image/watermark%2csize_16%2ctext_QDUxQ1RP5Y2a5a6i%2ccolor_FFFFFF%2ct_100%2cg_se%2cx_10%2cy_10%2cshadow_90%2ctype_ZmFuZ3poZW5naGVpdGk= 2x" sizes=auto data-title="https://s1.51cto.com/images/blog/201809/23/3fb7ef20a861d9fed05427bcf778cf96.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" data-alt="https://s1.51cto.com/images/blog/201809/23/3fb7ef20a861d9fed05427bcf778cf96.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><ul><li><strong>chaindata : 存储区块数据</strong></li><li><strong>keystore: 存储账户数据</strong></li></ul><h3 id=2-私链服务启动常见参数说明>2. 私链服务启动常见参数说明</h3><table><thead><tr><th>参数名</th><th>说明</th></tr></thead><tbody><tr><td>identity</td><td>用于标识区块链的名称</td></tr><tr><td>init</td><td>用于指定创世区块的位置，并且创建创世区块以及相关目录结构</td></tr><tr><td>datadir</td><td>设置当前区块链网络数据存放的位置</td></tr><tr><td>port</td><td>区块链启动的监听端口，默认为 30303</td></tr><tr><td>rpc</td><td>启用 RPC 服务，可以用于智能合约的部署与调试，默认监听 127.0.0.1, 端口为 8545</td></tr><tr><td>rpcapi</td><td>设置 RPC 提供的 API 接口类型，一般为 db,eth.net.web3</td></tr><tr><td>networkid</td><td>设置当前区块链的网络 ID</td></tr><tr><td>nodiscover</td><td>设置节点不被自动发现，用于控制节点的加入</td></tr><tr><td>console</td><td>启用命令行模式，用于执行命令</td></tr><tr><td>help</td><td>帮助命令，所有参数的汇总</td></tr></tbody></table><h3 id=3-控制台命令说明>3. 控制台命令说明</h3><p>以太坊提供了一个交互式的 JavaScript 环境，可以在该环境中进行命令或者代码的执行操作，其中一些常用的以太坊 JavaScript 对象可以直接被调用。</p><table><thead><tr><th>对象名</th><th>说明</th></tr></thead><tbody><tr><td>eth</td><td>操作区块链相关的方法</td></tr><tr><td>eth.accounts</td><td>查看当前系统中的所有账户地址</td></tr><tr><td>eth.getBalance()</td><td>查询账户余额，返回单位为 Wei(1 ether=10^18Wei)</td></tr><tr><td>eth.blockNumber</td><td>列出区块总数</td></tr><tr><td>eth.getTransaction()</td><td>获取指定交易的状态信息</td></tr><tr><td>eth.getBlock()</td><td>获取指定区块的信息</td></tr><tr><td>net</td><td>用于查看 p2p 网络状态</td></tr><tr><td>admin</td><td>管理节点相关的方法</td></tr><tr><td>admin.peers</td><td>查看通讯的节点信息</td></tr><tr><td>admin.addPeer()</td><td>添加通讯 P2P 节点</td></tr><tr><td>miner</td><td>启动 / 停止挖矿相关方法</td></tr><tr><td>personal</td><td>用于管理账户</td></tr><tr><td>personal.newAccount()</td><td>创建账户</td></tr><tr><td>personal.unlockAccount()</td><td>解锁账户</td></tr><tr><td>txpool</td><td>查看交易池信息, txpool.status()</td></tr><tr><td>web3</td><td>包含了以上对象以及单位换算等方法</td></tr><tr><td>web3.fromWei()</td><td>Wei 换算成 ether 或者其他单位</td></tr><tr><td>web3.toWei()</td><td>将 ether 或者其他单位换算成 Wei</td></tr></tbody></table></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2020-11-11 00:00:00">更新于 2020-11-11&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/2019/use-virtual-machine-builds-ethereum-private-chain/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Pocket" data-sharer=pocket data-url=https://shuzang.github.io/2019/use-virtual-machine-builds-ethereum-private-chain/><i class="fa-brands fa-get-pocket fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://shuzang.github.io/2019/use-virtual-machine-builds-ethereum-private-chain/ data-title=以太坊开发1-虚拟机搭建以太坊私链><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/ class=post-tag>区块链</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2019/blockchain-based-platform-architecture-for-industrial-iot/ class=post-nav-item rel=prev title="Blockchain-Based Platform Architecture for Industrial IoT"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Blockchain-Based Platform Architecture for Industrial IoT</a>
<a href=/2019/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%912-%E5%88%9B%E4%B8%96%E5%8C%BA%E5%9D%97%E6%96%87%E4%BB%B6genesis.json/ class=post-nav-item rel=next title=以太坊开发2-创世区块文件genesis.json>以太坊开发2-创世区块文件genesis.json<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-reward><div class=comment></div><input type=checkbox class=reward-input name=reward id=fi-reward hidden>
<label class=reward-button for=fi-reward>赞赏</label><div class=reward-ways data-mode=static><div><img loading=lazy src=/images/alipay.png srcset="/images/alipay.png, /images/alipay.png 1.5x, /images/alipay.png 2x" sizes=auto data-title="Shuzang 支付宝" data-alt="Shuzang 支付宝" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>支付宝</span></div><div><img loading=lazy src=/images/wechatpay.png srcset="/images/wechatpay.png, /images/wechatpay.png 1.5x, /images/wechatpay.png 2x" sizes=auto data-title="Shuzang 微信" data-alt="Shuzang 微信" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>微信</span></div></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom">Hava a great day !</div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2018 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=/>Shuzang</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><a href=https://github.com/shuzang/shuzang.github.io title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=https://unpkg.com/lightgallery@2.6.1/css/lightgallery-bundle.min.css><link rel=stylesheet href=https://unpkg.com/katex@0.16.2/dist/katex.min.css><link rel=stylesheet href=https://unpkg.com/pace-js@1.2.4/themes/blue/pace-theme-minimal.css><script src=https://unpkg.com/autocomplete.js@0.38.1/dist/autocomplete.min.js defer></script><script src=https://unpkg.com/fuse.js@6.6.2/dist/fuse.min.js defer></script><script src=https://unpkg.com/twemoji@14.0.2/dist/twemoji.min.js defer></script><script src=https://unpkg.com/lightgallery@2.6.1/lightgallery.min.js defer></script><script src=https://unpkg.com/lightgallery@2.6.1/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=https://unpkg.com/lightgallery@2.6.1/plugins/zoom/lg-zoom.min.js defer></script><script src=https://unpkg.com/sharer.js@0.5.1/sharer.min.js async defer></script><script src=https://unpkg.com/katex@0.16.2/dist/katex.min.js defer></script><script src=https://unpkg.com/katex@0.16.2/dist/contrib/auto-render.min.js defer></script><script src=https://unpkg.com/katex@0.16.2/dist/contrib/copy-tex.min.js defer></script><script src=https://unpkg.com/katex@0.16.2/dist/contrib/mhchem.min.js defer></script><script src=https://unpkg.com/pangu@4.0.7/dist/browser/pangu.min.js defer></script><script src=https://unpkg.com/pace-js@1.2.4/pace.min.js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{enable:!1},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0,selector:"article"},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},twemoji:!0}</script><script src=/js/theme.min.js defer></script></body></html>