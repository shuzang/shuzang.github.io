<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>研究记录4-利用虚拟机搭建实验平台(失败) - Shuzang's Blog</title><meta name=author content="Shuzang"><meta name=author-link content><meta name=description content="先声明结论：最后由于网络原因没有成功，这种在多台电脑中安装虚拟机来联网的方式是存在一定问题的，其次，本篇所述的搭建方法过于繁琐，稍有不慎需要"><meta name=keywords content="科研记录"><meta itemprop=name content="研究记录4-利用虚拟机搭建实验平台(失败)"><meta itemprop=description content="先声明结论：最后由于网络原因没有成功，这种在多台电脑中安装虚拟机来联网的方式是存在一定问题的，其次，本篇所述的搭建方法过于繁琐，稍有不慎需要"><meta itemprop=datePublished content="2019-09-13T00:00:00+00:00"><meta itemprop=dateModified content="2020-11-24T00:00:00+00:00"><meta itemprop=wordCount content="9233"><meta itemprop=image content="https://shuzang.github.io/logo.png"><meta itemprop=keywords content="科研记录,"><meta property="og:title" content="研究记录4-利用虚拟机搭建实验平台(失败)"><meta property="og:description" content="先声明结论：最后由于网络原因没有成功，这种在多台电脑中安装虚拟机来联网的方式是存在一定问题的，其次，本篇所述的搭建方法过于繁琐，稍有不慎需要"><meta property="og:type" content="article"><meta property="og:url" content="https://shuzang.github.io/2019/using-virtual-machine-to-build-experimental-platform/"><meta property="og:image" content="https://shuzang.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-09-13T00:00:00+00:00"><meta property="article:modified_time" content="2020-11-24T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shuzang.github.io/logo.png"><meta name=twitter:title content="研究记录4-利用虚拟机搭建实验平台(失败)"><meta name=twitter:description content="先声明结论：最后由于网络原因没有成功，这种在多台电脑中安装虚拟机来联网的方式是存在一定问题的，其次，本篇所述的搭建方法过于繁琐，稍有不慎需要"><meta name=application-name content="Shuzang's Blog"><meta name=apple-mobile-web-app-title content="Shuzang's Blog"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://shuzang.github.io/2019/using-virtual-machine-to-build-experimental-platform/><link rel=prev href=https://shuzang.github.io/2019/vmware-usage/><link rel=next href=https://shuzang.github.io/2019/golang-basic-grammar-1-background-and-preliminary-exploration/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"研究记录4-利用虚拟机搭建实验平台(失败)","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/shuzang.github.io\/2019\/using-virtual-machine-to-build-experimental-platform\/"},"genre":"posts","keywords":"科研记录","wordcount":9233,"url":"https:\/\/shuzang.github.io\/2019\/using-virtual-machine-to-build-experimental-platform\/","datePublished":"2019-09-13T00:00:00+00:00","dateModified":"2020-11-24T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Shuzang"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title="Shuzang's Blog"><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title="Shuzang's Blog" data-alt="Shuzang's Blog" class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Shuzang's Blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Shuzang's Blog"><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title=/images/avatar.png data-alt=/images/avatar.png class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Shuzang's Blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>研究记录4-利用虚拟机搭建实验平台(失败)</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title=Shuzang data-alt=Shuzang class=avatar style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;Shuzang</span></span>
<span class=post-category>收录于 <a href=/categories/%E7%A0%94%E7%A9%B6%E7%94%9F%E7%9A%84%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 研究生的区块链学习之路</a></span></div><div class=post-meta-line><span title="发布于 2019-09-13 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2019-09-13>2019-09-13</time></span>&nbsp;<span title="更新于 2020-11-24 00:00:00"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2020-11-24>2020-11-24</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 9233 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 19 分钟</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#一-前言>一. 前言</a></li><li><a href=#二-计算机环境配置>二. 计算机环境配置</a><ul><li><a href=#1-设备和操作系统选择>1. 设备和操作系统选择</a></li><li><a href=#2-静态ip分配>2. 静态ip分配</a></li><li><a href=#3-操作系统设置>3. 操作系统设置</a></li><li><a href=#4-区块链环境配置>4. 区块链环境配置</a></li></ul></li><li><a href=#三-树莓派启动及环境配置>三. 树莓派启动及环境配置</a><ul><li><a href=#1-树莓派启动>1. 树莓派启动</a></li><li><a href=#2-树莓派基本配置>2. 树莓派基本配置</a></li></ul></li><li><a href=#四-私链网络搭建及测试运行>四. 私链网络搭建及测试运行</a></li><li><a href=#五-总结>五. 总结</a></li><li><a href=#附录-树莓派安装-quourm-节点>附录 树莓派安装 quourm 节点</a><ul><li><a href=#交叉编译20190909>交叉编译（2019.09.09）</a></li><li><a href=#ubuntu-mate0910-am>Ubuntu mate（09.10 am）</a></li><li><a href=#raspbian下自编译quorum0910-pm>Raspbian下自编译quorum(09.10 pm)</a></li><li><a href=#istantul-tool0911-am>istantul-tool(09.11 am)</a></li><li><a href=#运行geth文件0911-am>运行geth文件（09.11 am）</a></li></ul></li></ul></nav></div></div><div class=content id=content><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden=true></i>注意<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>本文最后更新于 2020-11-24，文中内容可能已过时。</div></div></div><p>先声明结论：最后由于网络原因没有成功，这种在多台电脑中安装虚拟机来联网的方式是存在一定问题的，其次，本篇所述的搭建方法过于繁琐，稍有不慎需要全部从头再来，在后面的实验中我们使用了简化的搭建流程。</p><h2 id=一-前言>一. 前言</h2><p>为了设计一个对物联网的访问控制方案，首先利用两台树莓派和两台计算机搭建完成了一个 Quorum 区块链实验平台，并采用了 Istanbul-BFT 共识算法，但未启用隐私管理器。之后将在该实验平台上部署编写的访问控制合约。实验平台的网络拓扑如下：</p><p><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/YJS_20190913_%e5%88%a9%e7%94%a8%e8%b7%af%e7%94%b1%e5%99%a8%e5%bb%ba%e7%ab%8b%e5%b1%80%e5%9f%9f%e7%bd%91.png srcset="https://picped-1301226557.cos.ap-beijing.myqcloud.com/YJS_20190913_%e5%88%a9%e7%94%a8%e8%b7%af%e7%94%b1%e5%99%a8%e5%bb%ba%e7%ab%8b%e5%b1%80%e5%9f%9f%e7%bd%91.png, https://picped-1301226557.cos.ap-beijing.myqcloud.com/YJS_20190913_%e5%88%a9%e7%94%a8%e8%b7%af%e7%94%b1%e5%99%a8%e5%bb%ba%e7%ab%8b%e5%b1%80%e5%9f%9f%e7%bd%91.png 1.5x, https://picped-1301226557.cos.ap-beijing.myqcloud.com/YJS_20190913_%e5%88%a9%e7%94%a8%e8%b7%af%e7%94%b1%e5%99%a8%e5%bb%ba%e7%ab%8b%e5%b1%80%e5%9f%9f%e7%bd%91.png 2x" sizes=auto data-title=利用路由器建立局域网 data-alt=利用路由器建立局域网 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>IBFT 共识允许的最小节点数量为 4，所以设置了 4 个节点，其中，两台电脑作为管理者或者用户的角色，能比较容易的和区块链交互，因为传感器和执行器本身没有足够的能力运行区块链节点，两台树莓派作为 IoT 设备的网关，我们所验证的是其中一台树莓派管理的设备向另一台树莓派管理的设备发起的访问。这里要注意两点：</p><ol><li>系统中不止设备对设备的访问，一定还包括用户通过 PC 或移动设备对 IoT 设备的访问；</li><li>使用树莓派的原因是尽量模拟实际的环境，但事实上，树莓派依然与实际环境相差巨大，更多的是验证当前方案在资源受限的网关设备上运行的可能性及对设备造成的运行压力。</li></ol><p>下面介绍平台的搭建过程，主要分为以下几步</p><ol><li>计算机环境配置</li><li>树莓派启动和环境配置</li><li>Quorum 私链网络搭建和测试运行</li></ol><h2 id=二-计算机环境配置>二. 计算机环境配置</h2><h3 id=1-设备和操作系统选择>1. 设备和操作系统选择</h3><p>实验平台共使用了两台计算机和两台树莓派。设备和操作系统的详细信息如下：</p><table><thead><tr><th>设备</th><th>CPU</th><th>操作系统</th><th>内存</th><th>硬盘</th></tr></thead><tbody><tr><td>清华同方</td><td>Intel Core i5-4460, 3.2GHz</td><td>Ubuntu 18.04 LTS(虚拟机)</td><td>2GB</td><td>50GB</td></tr><tr><td>华硕A550</td><td>Intel Core i5-4200, 2.8GHz</td><td>Ubuntu 18.04 LTS(虚拟机)</td><td>2GB</td><td>50GB</td></tr><tr><td>Raspberry Pi 3 Model B Plus</td><td>quad-core ARM Cortex A53, 1.4GHz</td><td>Raspbian Buster</td><td>1GB</td><td>32GB(microSD card)</td></tr><tr><td>Raspberry Pi 3 Model B</td><td>quad-core ARM Cortex A53, 1.2GHz</td><td>Raspbian Buster</td><td>1GB</td><td>16GB(microSD card)</td></tr></tbody></table><h3 id=2-静态ip分配>2. 静态ip分配</h3><p>两台计算机的操作环境是在虚拟机上完成的，涉及到网络相关操作，这里事先对各设备进行静态ip的分配</p><table><thead><tr><th>设备</th><th>主机名</th><th>IP地址</th><th>操作系统</th></tr></thead><tbody><tr><td>清华同方（PC）</td><td>NodeA</td><td>192.168.191.2</td><td>Ubuntu 18.04 LTS</td></tr><tr><td>华硕（Laptop)</td><td>NodeB</td><td>192.168.191.3</td><td>Ubuntu 18.04 LTS</td></tr><tr><td>Pi 3B+</td><td>NodeC</td><td>192.168.191.4</td><td>Raspbian Buster</td></tr><tr><td>Pi 3B</td><td>NodeD</td><td>192.168.191.5</td><td>Raspbian Buster</td></tr></tbody></table><p>注：以下以 PC 为例进行相关配置，Laptop 配置操作基本相同。</p><h3 id=3-操作系统设置>3. 操作系统设置</h3><p>在 VM ware 中安装 Ubuntu 18.04 虚拟机，安装完成后完成如下基础配置操作：</p><p><strong>(1) 更新源和系统</strong></p><p>根据自己需要选择是否更换软件源，此处我使用了原生的源</p><div class=highlight id=id-1><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get update
</span></span><span class=line><span class=cl>$ sudo apt-get upgrade</span></span></code></pre></td></tr></table></div></div><p><strong>(2) 调整系统时间</strong></p><p>查看系统时区是否正确</p><div class=highlight id=id-2><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ timedatectl
</span></span><span class=line><span class=cl>                      Local time: 五 2019-09-13 11:07:13 +08
</span></span><span class=line><span class=cl>                  Universal time: 五 2019-09-13 03:07:13 UTC
</span></span><span class=line><span class=cl>                        RTC time: 五 2019-09-13 03:07:13
</span></span><span class=line><span class=cl>                       Time zone: Asia/Ulaanbaatar <span class=o>(</span>+08, +0800<span class=o>)</span>
</span></span><span class=line><span class=cl>       System clock synchronized: yes
</span></span><span class=line><span class=cl>systemd-timesyncd.service active: yes
</span></span><span class=line><span class=cl>                 RTC in <span class=nb>local</span> TZ: no</span></span></code></pre></td></tr></table></div></div><p>若不正确，使用下列命令设置时区，时区根据自己所处位置调整</p><div class=highlight id=id-3><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ timedatectl set-timezone Asia/Shanghai</span></span></code></pre></td></tr></table></div></div><p><strong>(3) 设置主机名</strong></p><div class=highlight id=id-4><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo hostnamectl set-hostname NodeA</span></span></code></pre></td></tr></table></div></div><p>重启终端查看新的主机名</p><div class=highlight id=id-5><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ hostnamectl
</span></span><span class=line><span class=cl>   Static hostname: NodeA
</span></span><span class=line><span class=cl>         Icon name: computer-vm
</span></span><span class=line><span class=cl>           Chassis: vm
</span></span><span class=line><span class=cl>        Machine ID: d16107a02250422baa2e04fb10c98558
</span></span><span class=line><span class=cl>           Boot ID: ea8fbdb520774a52a205281b4034f8b0
</span></span><span class=line><span class=cl>    Virtualization: vmware
</span></span><span class=line><span class=cl>  Operating System: Ubuntu 18.04.3 LTS
</span></span><span class=line><span class=cl>            Kernel: Linux 4.15.0-20-generic
</span></span><span class=line><span class=cl>      Architecture: x86-64</span></span></code></pre></td></tr></table></div></div><p><strong>(4) 设置静态ip</strong></p><p>安装 <code>net-tools</code> 工具</p><div class=highlight id=id-6><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get install net-tools</span></span></code></pre></td></tr></table></div></div><p>设置虚拟机网络为桥接模式，桥接到无线网卡。在<code>/etc/netplan</code>目录下创建配置文件</p><div class=highlight id=id-7><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo nano /etc/netplan/02_config.yaml</span></span></code></pre></td></tr></table></div></div><p>在配置文件中添加如下信息</p><div class=highlight id=id-8><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>renderer</span><span class=p>:</span><span class=w> </span><span class=l>networkd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>ethernets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>ens33</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>addresses</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span>- <span class=m>192.168.191.2</span><span class=l>/24</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>gateway4</span><span class=p>:</span><span class=w> </span><span class=m>192.168.191.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>nameservers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=nt>search</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>mydomain, otherdomain]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=nt>addresses</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=m>1.1.1.1</span><span class=p>,</span><span class=w> </span><span class=m>8.8.8.8</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p><code>ens33</code>是网卡名，<code>addresses</code>下的内容为自定义的静态ip，<code>gateway4</code>为网关地址。保存退出，使用<code>netplan</code>启用设置，并查询更改后的ip地址</p><div class=highlight id=id-9><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo netplan apply
</span></span><span class=line><span class=cl>$ ifconfig
</span></span><span class=line><span class=cl>ens33: <span class=nv>flags</span><span class=o>=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class=m>1500</span>
</span></span><span class=line><span class=cl>        inet 192.168.191.2  netmask 255.255.255.0  broadcast 192.168.191.255
</span></span><span class=line><span class=cl>        inet6 fe80::94ff:42f8:57d5:a20f  prefixlen <span class=m>64</span>  scopeid 0x20&lt;link&gt;
</span></span><span class=line><span class=cl>        ether 00:0c:29:09:08:33  txqueuelen <span class=m>1000</span>  <span class=o>(</span>以太网<span class=o>)</span>
</span></span><span class=line><span class=cl>        RX packets <span class=m>155321</span>  bytes <span class=m>207407688</span> <span class=o>(</span>207.4 MB<span class=o>)</span>
</span></span><span class=line><span class=cl>        RX errors <span class=m>0</span>  dropped <span class=m>0</span>  overruns <span class=m>0</span>  frame <span class=m>0</span>
</span></span><span class=line><span class=cl>        TX packets <span class=m>76320</span>  bytes <span class=m>4839627</span> <span class=o>(</span>4.8 MB<span class=o>)</span>
</span></span><span class=line><span class=cl>        TX errors <span class=m>0</span>  dropped <span class=m>0</span> overruns <span class=m>0</span>  carrier <span class=m>0</span>  collisions <span class=m>0</span>
</span></span><span class=line><span class=cl>lo: ...</span></span></code></pre></td></tr></table></div></div><p><strong>(5) 重新安装VMware tools</strong></p><p>只有安装 VMware tools 之后，虚拟机界面才会自动调整全屏，并且能在虚拟机和主机之间互传文件。</p><h3 id=4-区块链环境配置>4. 区块链环境配置</h3><p>使用的是 Quorum 区块链，共识是 Istanbul BFT。</p><p><strong>(1) 安装golang</strong></p><p>获取与安装 go1.13</p><div class=highlight id=id-10><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ wget https://dl.google.com/go/go1.13.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>$ sudo tar -xzf go1.13.linux-amd64.tar.gz -C /usr/local
</span></span><span class=line><span class=cl>$ rm go1.13.linux-amd64.tar.gz</span></span></code></pre></td></tr></table></div></div><p>设置环境变量</p><div class=highlight id=id-11><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo nano /etc/profile
</span></span><span class=line><span class=cl><span class=c1># 在打开的文件末尾添加下列语句</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$PATH</span>:/usr/local/go/bin</span></span></code></pre></td></tr></table></div></div><p>更新的环境变量在下一次登录之前不会生效，但可以通过下面的命令使其直接生效</p><div class=highlight id=id-12><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>source</span> /etc/profile
</span></span><span class=line><span class=cl><span class=c1># 查看生效后的环境变量设置</span>
</span></span><span class=line><span class=cl>$ go version
</span></span><span class=line><span class=cl>go version go1.13 linux/amd64</span></span></code></pre></td></tr></table></div></div><p>注：真正生效必须重启系统</p><p><strong>(2) 安装geth for quorum</strong></p><p>获取编译后的二进制包</p><div class=highlight id=id-13><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ wget https://bintray.com/quorumengineering/quorum/download_file?file_path<span class=o>=</span>v2.2.5/geth_v2.2.5_linux_amd64.tar.gz</span></span></code></pre></td></tr></table></div></div><p>解压缩并安装</p><div class=highlight id=id-14><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo tar -xzf download_file?file_path<span class=o>=</span>v2.2.5%2Fgeth_v2.2.5_linux_amd64.tar.gz -C /usr/local/bin
</span></span><span class=line><span class=cl>$ rm download_file?file_path<span class=o>=</span>v2.2.5%2Fgeth_v2.2.5_linux_amd64.tar.gz</span></span></code></pre></td></tr></table></div></div><p>测试安装</p><div class=highlight id=id-15><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth version
</span></span><span class=line><span class=cl>WARN <span class=o>[</span>09-13<span class=p>|</span>16:03:38.966<span class=o>]</span> Sanitizing cache to Go<span class=err>&#39;</span>s GC limits       <span class=nv>provided</span><span class=o>=</span><span class=m>1024</span> <span class=nv>updated</span><span class=o>=</span><span class=m>655</span>
</span></span><span class=line><span class=cl>Geth
</span></span><span class=line><span class=cl>Version: 1.8.18-stable
</span></span><span class=line><span class=cl>Git Commit: c894c2d70eacf30740d03b53ed2fb39e42641295
</span></span><span class=line><span class=cl>Quorum Version: 2.2.5
</span></span><span class=line><span class=cl>Architecture: amd64
</span></span><span class=line><span class=cl>Protocol Versions: <span class=o>[</span><span class=m>63</span> 62<span class=o>]</span>
</span></span><span class=line><span class=cl>Network Id: <span class=m>1337</span>
</span></span><span class=line><span class=cl>Go Version: go1.11.12
</span></span><span class=line><span class=cl>Operating System: linux
</span></span><span class=line><span class=cl><span class=nv>GOPATH</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=nv>GOROOT</span><span class=o>=</span>/home/travis/.gimme/versions/go1.11.12.linux.amd64</span></span></code></pre></td></tr></table></div></div><p><strong>(3) 获取并编译istanbul-tools</strong></p><p>istanbul-tools 用来初始化 istanbul-BFT 共识网络及进行网络测试</p><div class=highlight id=id-16><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get install git
</span></span><span class=line><span class=cl>$ mkdir istanbul <span class=o>&amp;&amp;</span> <span class=nb>cd</span> istanbul
</span></span><span class=line><span class=cl>$ git clone https://github.com/jpmorganchase/istanbul-tools.git
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> istanbul-tools</span></span></code></pre></td></tr></table></div></div><p>执行编译</p><div class=highlight id=id-17><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get install -y build-essential
</span></span><span class=line><span class=cl>$ make</span></span></code></pre></td></tr></table></div></div><p>编译后的文件位于/build/bin目录下，执行测试</p><div class=highlight id=id-18><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ./build/bin/istanbul istanbul --version
</span></span><span class=line><span class=cl>istanbul version v1.0.1</span></span></code></pre></td></tr></table></div></div><h2 id=三-树莓派启动及环境配置>三. 树莓派启动及环境配置</h2><p>以Pi 3B+为例，Pi3B 配置操作基本相同</p><h3 id=1-树莓派启动>1. 树莓派启动</h3><p>将 Raspbian Buster 镜像写入准备好的SD卡，重新加载在电脑中的SD卡会出现boot盘，同时也是树莓派的<code>/boot</code>目录。在boot盘根目录新建名为<code>ssh</code>的文件，开启SSH连接。同时新建<code>wpa_supplicant.conf</code>文件，编辑其内容如下：</p><div class=highlight id=id-19><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
</span></span><span class=line><span class=cl>update_config=1
</span></span><span class=line><span class=cl>country=CN
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>network={
</span></span><span class=line><span class=cl>    ssid=&#34;WiFi名&#34;
</span></span><span class=line><span class=cl>    psk=&#34;密码&#34;
</span></span><span class=line><span class=cl>    priority=10
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div><p>将其中的ssid和psk更改为自己无线网络的网络名和密码。将配置好的SD卡卸载并插入树莓派，通电启动。使用Advanced IP Scanner扫描无线网络的网段，获取树莓派ip，本实验无线网络网段为192.168.191.1-254。</p><p>使用扫描到的ip通过Putty利用SSH协议进行登录。</p><h3 id=2-树莓派基本配置>2. 树莓派基本配置</h3><p><strong>(1) 更新源及系统</strong></p><p>编辑/etc/apt/sources.list文件</p><div class=highlight id=id-20><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/apt/sources.list</span></span></code></pre></td></tr></table></div></div><p>注释掉原来的源，将源更新为：</p><div class=highlight id=id-21><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main contrib non-free rpi
</span></span><span class=line><span class=cl>deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main contrib non-free rpi</span></span></code></pre></td></tr></table></div></div><p>保存退出，编辑/etc/apt/sources.list.d/raspi.list文件</p><div class=highlight id=id-22><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/apt/sources.list.d/raspi.list</span></span></code></pre></td></tr></table></div></div><p>将源更新为：</p><div class=highlight id=id-23><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>deb http://mirror.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui
</span></span><span class=line><span class=cl>deb-src http://mirror.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui</span></span></code></pre></td></tr></table></div></div><p>更新源文件列表，更新软件</p><div class=highlight id=id-24><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get update
</span></span><span class=line><span class=cl>$ sudo apt-get upgrade</span></span></code></pre></td></tr></table></div></div><p><strong>(2) 安装xrdp供远程连接</strong></p><div class=highlight id=id-25><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get install xrdp</span></span></code></pre></td></tr></table></div></div><p><strong>(3) 开启ftp供文件传输</strong></p><p>安装vsftpd</p><div class=highlight id=id-26><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo apt-get install vsftpd</span></span></code></pre></td></tr></table></div></div><p>编辑配置文件</p><div class=highlight id=id-27><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo nano /etc/vsftpd.conf</span></span></code></pre></td></tr></table></div></div><p>启用对树莓派的写入权限</p><div class=highlight id=id-28><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Uncomment this to enable any form of FTP </span>
</span></span><span class=line><span class=cl>write command.write_enable<span class=o>=</span>YES</span></span></code></pre></td></tr></table></div></div><p>保存退出，启用vsftpd</p><div class=highlight id=id-29><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo service vsftpd start</span></span></code></pre></td></tr></table></div></div><p><strong>(4) 修改pi账户密码，时区和主机名</strong></p><div class=highlight id=id-30><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo raspi-config</span></span></code></pre></td></tr></table></div></div><p>选择第一项<code>Change User Password</code>，键入新密码并确定，</p><p>选择第四项<code>Localisation Options</code>，选择<code>Change Timezone</code>，将时区更改为<code>Asia/Shanghai</code></p><p>全部设置完成后选择<code>Finish</code>退出，终端将看到如下输出</p><div class=highlight id=id-31><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Current default <span class=nb>time</span> zone: <span class=s1>&#39;Asia/Shanghai&#39;</span>
</span></span><span class=line><span class=cl>Local <span class=nb>time</span> is now:      Fri Sep <span class=m>13</span> 18:40:56 CST 2019.
</span></span><span class=line><span class=cl>Universal Time is now:  Fri Sep <span class=m>13</span> 10:40:56 UTC 2019.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>New password:
</span></span><span class=line><span class=cl>Retype new password:
</span></span><span class=line><span class=cl>passwd: password updated successfully
</span></span><span class=line><span class=cl>OK</span></span></code></pre></td></tr></table></div></div><p>设置主机名</p><div class=highlight id=id-32><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo hostnamectl set-hostname NodeC</span></span></code></pre></td></tr></table></div></div><p>编辑/etc/hosts文件，将127.0.1.1对应的raspberry更改为NodeC</p><div class=highlight id=id-33><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>127.0.0.1       localhost
</span></span><span class=line><span class=cl>::1             localhost ip6-localhost ip6-loopback
</span></span><span class=line><span class=cl>ff02::1         ip6-allnodes
</span></span><span class=line><span class=cl>ff02::2         ip6-allrouters
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>127.0.1.1       NodeC</span></span></code></pre></td></tr></table></div></div><p>退出终端并使用新密码重新登录，主机名将更改为NodeC。注意此时用户名仍为pi。</p><p><strong>(5) 设置静态ip</strong></p><p>编辑<code>/etc/dhcpcd.conf</code>文件</p><div class=highlight id=id-34><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo nano /etc/dhcpcd.conf</span></span></code></pre></td></tr></table></div></div><p>在末尾添加如下内容</p><div class=highlight id=id-35><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>interface wlan0
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>static ip_address=192.168.191.4/24
</span></span><span class=line><span class=cl>static routers=192.168.191.1
</span></span><span class=line><span class=cl>static domain_name_servers=192.168.191.1</span></span></code></pre></td></tr></table></div></div><p>重启并以新的ip登录树莓派。</p><p>(6) 获取并安装geth</p><div class=highlight id=id-36><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git clone -b gethonly https://github.com/shuzang/quorum-raspbian.git
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> quorum-raspbian
</span></span><span class=line><span class=cl>$ sudo cp geth /usr/local/bin
</span></span><span class=line><span class=cl>$ sudo chmod +x /usr/local/bin/geth</span></span></code></pre></td></tr></table></div></div><p>测试安装是否成功</p><div class=highlight id=id-37><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth version
</span></span><span class=line><span class=cl>WARN <span class=o>[</span>09-13<span class=p>|</span>19:51:40.051<span class=o>]</span> Sanitizing cache to Go<span class=err>&#39;</span>s GC limits       <span class=nv>provided</span><span class=o>=</span><span class=m>1024</span> <span class=nv>updated</span><span class=o>=</span><span class=m>308</span>
</span></span><span class=line><span class=cl>Geth
</span></span><span class=line><span class=cl>Version: 1.8.18-stable
</span></span><span class=line><span class=cl>Quorum Version: 2.2.5
</span></span><span class=line><span class=cl>Architecture: arm
</span></span><span class=line><span class=cl>Protocol Versions: <span class=o>[</span><span class=m>63</span> 62<span class=o>]</span>
</span></span><span class=line><span class=cl>Network Id: <span class=m>1337</span>
</span></span><span class=line><span class=cl>Go Version: go1.11.6
</span></span><span class=line><span class=cl>Operating System: linux
</span></span><span class=line><span class=cl><span class=nv>GOPATH</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=nv>GOROOT</span><span class=o>=</span>/usr/lib/go-1.11</span></span></code></pre></td></tr></table></div></div><h2 id=四-私链网络搭建及测试运行>四. 私链网络搭建及测试运行</h2><p>各节点数据和相关文件的前期生成都在NodeA中由istanbul-tools工具完成。切换到NodeA节点的PC，在istanbul目录下创建四个节点的工作目录</p><div class=highlight id=id-38><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>cd</span> ~/istanbul
</span></span><span class=line><span class=cl>$ mkdir NodeA NodeB NodeC NodeD</span></span></code></pre></td></tr></table></div></div><p>进入领导节点（这里是NodeA）目录，使用istanbul-tools工具为四个节点生成安装玩家，该命令会为所有的初始验证者节点生成 <code>static-nodes.json</code>, <code>genesis.json</code>和 nodekeys三种文件。</p><div class=highlight id=id-39><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>cd</span> NodeA
</span></span><span class=line><span class=cl>$ ../istanbul-tools/build/bin/istanbul setup --num <span class=m>4</span> --nodes --quorum --save --verbose</span></span></code></pre></td></tr></table></div></div><p>将输出生成的文件信息</p><div class=highlight id=id-40><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>validators</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;Address&#34;</span><span class=p>:</span> <span class=s2>&#34;0x93c20b1ffa9bf8738bf194d5203e3d2e2a48428d&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;Nodekey&#34;</span><span class=p>:</span> <span class=s2>&#34;6f17ec19de39281ea72a6d91d1e780bf5a0e35602f0e844e82dcc9d6a9ba7716&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;NodeInfo&#34;</span><span class=p>:</span> <span class=s2>&#34;enode://faa50654f681a890c28be2faeef9211afaf1563c08ddb8990f6b39c561e002ea687707be68c16363f65c0755f785cb16e3b7be84e5e4eb260b0d4a6f6f83ef87@0.0.0.0:30303?discport=0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;Address&#34;</span><span class=p>:</span> <span class=s2>&#34;0xff75bd429c43de6719c2983c1e991b0279909559&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;Nodekey&#34;</span><span class=p>:</span> <span class=s2>&#34;b7c11c512d33e3c1de97abd8a690cdbcfac9c6802a43a6ff850b244d90258908&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;NodeInfo&#34;</span><span class=p>:</span> <span class=s2>&#34;enode://c286de4e89f4f209a6b32284b31829251ccb23bf5ab3bbe57ba08754392635ae755848dd6c4f367c7d92284e54e4b9f0d1a896924309380eb947e3b8c6641392@0.0.0.0:30303?discport=0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;Address&#34;</span><span class=p>:</span> <span class=s2>&#34;0xf22670e572a42729a2c10fb26f57bba46cbc3a42&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;Nodekey&#34;</span><span class=p>:</span> <span class=s2>&#34;9b3740640431f0d6543f730308509fb9bc35307f826b1dd838b6812a6067f477&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;NodeInfo&#34;</span><span class=p>:</span> <span class=s2>&#34;enode://cb50baa67204df2246b143e2982e40a89b2924e5c19e2834876c34042f0a81a2e2604ab210d19a048762f5355258d9840932ba868227857d928495d398c04af0@0.0.0.0:30303?discport=0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;Address&#34;</span><span class=p>:</span> <span class=s2>&#34;0x350686ae7615e87a046fc4261fe58fda3872aa65&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;Nodekey&#34;</span><span class=p>:</span> <span class=s2>&#34;b6fd16bc88c8f96430b9ec0c4f6991c0f958e70026fce1abc959b295774f4e94&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=nt>&#34;NodeInfo&#34;</span><span class=p>:</span> <span class=s2>&#34;enode://214dce3278a2b45fb0bf2a1d53c24eb213c5cbb08307e842feab0202cad4f685c5c62a4197d29318f07eb813bf4189db05096b551849039bf81fb74f0211320f@0.0.0.0:30303?discport=0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>static-nodes.json</span>
</span></span><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>	<span class=s2>&#34;enode://faa50654f681a890c28be2faeef9211afaf1563c08ddb8990f6b39c561e002ea687707be68c16363f65c0755f785cb16e3b7be84e5e4eb260b0d4a6f6f83ef87@0.0.0.0:30303?discport=0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=s2>&#34;enode://c286de4e89f4f209a6b32284b31829251ccb23bf5ab3bbe57ba08754392635ae755848dd6c4f367c7d92284e54e4b9f0d1a896924309380eb947e3b8c6641392@0.0.0.0:30303?discport=0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=s2>&#34;enode://cb50baa67204df2246b143e2982e40a89b2924e5c19e2834876c34042f0a81a2e2604ab210d19a048762f5355258d9840932ba868227857d928495d398c04af0@0.0.0.0:30303?discport=0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=s2>&#34;enode://214dce3278a2b45fb0bf2a1d53c24eb213c5cbb08307e842feab0202cad4f685c5c62a4197d29318f07eb813bf4189db05096b551849039bf81fb74f0211320f@0.0.0.0:30303?discport=0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>genesis.json</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;chainId&#34;</span><span class=p>:</span> <span class=mi>10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;homesteadBlock&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;eip150Block&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;eip150Hash&#34;</span><span class=p>:</span> <span class=s2>&#34;0x0000000000000000000000000000000000000000000000000000000000000000&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;eip155Block&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;eip158Block&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;byzantiumBlock&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;constantinopleBlock&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;istanbul&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;epoch&#34;</span><span class=p>:</span> <span class=mi>30000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;policy&#34;</span><span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;txnSizeLimit&#34;</span><span class=p>:</span> <span class=mi>64</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;isQuorum&#34;</span><span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;nonce&#34;</span><span class=p>:</span> <span class=s2>&#34;0x0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;0x5d7c4ae8&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;extraData&#34;</span><span class=p>:</span> <span class=s2>&#34;0x0000000000000000000000000000000000000000000000000000000000000000f89af8549493c20b1ffa9bf8738bf194d5203e3d2e2a48428d94ff75bd429c43de6719c2983c1e991b027990955994f22670e572a42729a2c10fb26f57bba46cbc3a4294350686ae7615e87a046fc4261fe58fda3872aa65b8410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;gasLimit&#34;</span><span class=p>:</span> <span class=s2>&#34;0xe0000000&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;difficulty&#34;</span><span class=p>:</span> <span class=s2>&#34;0x1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;mixHash&#34;</span><span class=p>:</span> <span class=s2>&#34;0x63746963616c2062797a616e74696e65206661756c7420746f6c6572616e6365&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;coinbase&#34;</span><span class=p>:</span> <span class=s2>&#34;0x0000000000000000000000000000000000000000&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;alloc&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;350686ae7615e87a046fc4261fe58fda3872aa65&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;balance&#34;</span><span class=p>:</span> <span class=s2>&#34;0x446c3b15f9926687d2c40534fdb564000000000000&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;93c20b1ffa9bf8738bf194d5203e3d2e2a48428d&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;balance&#34;</span><span class=p>:</span> <span class=s2>&#34;0x446c3b15f9926687d2c40534fdb564000000000000&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;f22670e572a42729a2c10fb26f57bba46cbc3a42&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;balance&#34;</span><span class=p>:</span> <span class=s2>&#34;0x446c3b15f9926687d2c40534fdb564000000000000&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;ff75bd429c43de6719c2983c1e991b0279909559&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;balance&#34;</span><span class=p>:</span> <span class=s2>&#34;0x446c3b15f9926687d2c40534fdb564000000000000&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;number&#34;</span><span class=p>:</span> <span class=s2>&#34;0x0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;gasUsed&#34;</span><span class=p>:</span> <span class=s2>&#34;0x0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;parentHash&#34;</span><span class=p>:</span> <span class=s2>&#34;0x0000000000000000000000000000000000000000000000000000000000000000&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>查看生成的文件</p><div class=highlight id=id-41><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ls -l
</span></span><span class=line><span class=cl>total <span class=m>24</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> shuzang shuzang <span class=m>4096</span> Sep <span class=m>14</span> 10:05 <span class=m>0</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> shuzang shuzang <span class=m>4096</span> Sep <span class=m>14</span> 10:05 <span class=m>1</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> shuzang shuzang <span class=m>4096</span> Sep <span class=m>14</span> 10:05 <span class=m>2</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> shuzang shuzang <span class=m>4096</span> Sep <span class=m>14</span> 10:05 <span class=m>3</span>
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> shuzang shuzang <span class=m>1792</span> Sep <span class=m>14</span> 10:05 genesis.json
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> shuzang shuzang  <span class=m>666</span> Sep <span class=m>14</span> 10:05 static-nodes.json</span></span></code></pre></td></tr></table></div></div><p>使用预定的IP(端口号不改，使用默认的30303即可）为所有验证者节点更新 <code>static-nodes.json</code> 文件。 在 <code>static-nodes.json</code>中，每个节点占据一行，第几行即代表第几个节点。</p><div class=highlight id=id-42><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat static-nodes.json
</span></span><span class=line><span class=cl>....更新ip如下
</span></span><span class=line><span class=cl><span class=o>[</span>	<span class=s2>&#34;enode://faa50654f681a890c28be2faeef9211afaf1563c08ddb8990f6b39c561e002ea687707be68c16363f65c0755f785cb16e3b7be84e5e4eb260b0d4a6f6f83ef87@192.168.191.2:30303?discport=0&#34;</span>,
</span></span><span class=line><span class=cl>	<span class=s2>&#34;enode://c286de4e89f4f209a6b32284b31829251ccb23bf5ab3bbe57ba08754392635ae755848dd6c4f367c7d92284e54e4b9f0d1a896924309380eb947e3b8c6641392@192.168.191.3:30303?discport=0&#34;</span>,
</span></span><span class=line><span class=cl>	<span class=s2>&#34;enode://cb50baa67204df2246b143e2982e40a89b2924e5c19e2834876c34042f0a81a2e2604ab210d19a048762f5355258d9840932ba868227857d928495d398c04af0@192.168.191.4:30303?discport=0&#34;</span>,
</span></span><span class=line><span class=cl>	<span class=s2>&#34;enode://214dce3278a2b45fb0bf2a1d53c24eb213c5cbb08307e842feab0202cad4f685c5c62a4197d29318f07eb813bf4189db05096b551849039bf81fb74f0211320f@192.168.191.5:30303?discport=0&#34;</span>
</span></span><span class=line><span class=cl><span class=o>]</span></span></span></code></pre></td></tr></table></div></div><p>在每个节点的工作目录创建名为<code>data</code>的数据目录，在<code>data</code>目录创建<code>geth</code>目录</p><div class=highlight id=id-43><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>cd</span> ..
</span></span><span class=line><span class=cl>$ mkdir -p NodeA/data/geth
</span></span><span class=line><span class=cl>$ mkdir -p NodeB/data/geth
</span></span><span class=line><span class=cl>$ mkdir -p NodeC/data/geth
</span></span><span class=line><span class=cl>$ mkdir -p NodeD/data/geth</span></span></code></pre></td></tr></table></div></div><p>在四个节点的工作目录中分别为各自节点生成初始账户，账户地址会显示在终端，记住为每个节点账户所设的密码</p><div class=highlight id=id-44><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth --datadir NodeA/data account new
</span></span><span class=line><span class=cl>WARN <span class=o>[</span>09-14<span class=p>|</span>10:18:26.738<span class=o>]</span> Sanitizing cache to Go<span class=s1>&#39;s GC limits       provided=1024 updated=655
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:18:26.748] Maximum peer count                       ETH=25 LES=0 total=25
</span></span></span><span class=line><span class=cl><span class=s1>Your new account is locked with a password. Please give a password. Do not forget this password.
</span></span></span><span class=line><span class=cl><span class=s1>Passphrase: 
</span></span></span><span class=line><span class=cl><span class=s1>Repeat passphrase: 
</span></span></span><span class=line><span class=cl><span class=s1>Address: {b619ead9d3d72b675a471b3d8ff67673de8ae7f4}
</span></span></span><span class=line><span class=cl><span class=s1>$ geth --datadir NodeB/data account new
</span></span></span><span class=line><span class=cl><span class=s1>WARN [09-14|10:18:41.953] Sanitizing cache to Go&#39;</span>s GC limits       <span class=nv>provided</span><span class=o>=</span><span class=m>1024</span> <span class=nv>updated</span><span class=o>=</span><span class=m>655</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:18:41.954<span class=o>]</span> Maximum peer count                       <span class=nv>ETH</span><span class=o>=</span><span class=m>25</span> <span class=nv>LES</span><span class=o>=</span><span class=m>0</span> <span class=nv>total</span><span class=o>=</span><span class=m>25</span>
</span></span><span class=line><span class=cl>Your new account is locked with a password. Please give a password. Do not forget this password.
</span></span><span class=line><span class=cl>Passphrase: 
</span></span><span class=line><span class=cl>Repeat passphrase: 
</span></span><span class=line><span class=cl>Address: <span class=o>{</span>4cd5ae20dba37c96717f328dc6c02e1c1927be1c<span class=o>}</span>
</span></span><span class=line><span class=cl>$ geth --datadir NodeC/data account new
</span></span><span class=line><span class=cl>WARN <span class=o>[</span>09-14<span class=p>|</span>10:18:56.231<span class=o>]</span> Sanitizing cache to Go<span class=s1>&#39;s GC limits       provided=1024 updated=655
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:18:56.232] Maximum peer count                       ETH=25 LES=0 total=25
</span></span></span><span class=line><span class=cl><span class=s1>Your new account is locked with a password. Please give a password. Do not forget this password.
</span></span></span><span class=line><span class=cl><span class=s1>Passphrase: 
</span></span></span><span class=line><span class=cl><span class=s1>Repeat passphrase: 
</span></span></span><span class=line><span class=cl><span class=s1>Address: {461d9bc69d4a32cb599310843bf5bf88342cc03c}
</span></span></span><span class=line><span class=cl><span class=s1>$ geth --datadir NodeD/data account new
</span></span></span><span class=line><span class=cl><span class=s1>WARN [09-14|10:19:09.591] Sanitizing cache to Go&#39;</span>s GC limits       <span class=nv>provided</span><span class=o>=</span><span class=m>1024</span> <span class=nv>updated</span><span class=o>=</span><span class=m>655</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:19:09.592<span class=o>]</span> Maximum peer count                       <span class=nv>ETH</span><span class=o>=</span><span class=m>25</span> <span class=nv>LES</span><span class=o>=</span><span class=m>0</span> <span class=nv>total</span><span class=o>=</span><span class=m>25</span>
</span></span><span class=line><span class=cl>Your new account is locked with a password. Please give a password. Do not forget this password.
</span></span><span class=line><span class=cl>Passphrase: 
</span></span><span class=line><span class=cl>Repeat passphrase: 
</span></span><span class=line><span class=cl>Address: <span class=o>{</span>51ef0c6536e69e2ea46f5ec5e150da423305c63d<span class=o>}</span></span></span></code></pre></td></tr></table></div></div><p>为了添加账户到初始区块，使用上述产生的账户地址更新<code>genesis.json</code>文件的<code>alloc</code>字段内容。</p><div class=highlight id=id-45><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat NodeA/genesis.json
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;config&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;chainId&#34;</span>: 10,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;homesteadBlock&#34;</span>: 0,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;eip150Block&#34;</span>: 0,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;eip150Hash&#34;</span>: <span class=s2>&#34;0x0000000000000000000000000000000000000000000000000000000000000000&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;eip155Block&#34;</span>: 0,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;eip158Block&#34;</span>: 0,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;byzantiumBlock&#34;</span>: 0,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;constantinopleBlock&#34;</span>: 0,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;istanbul&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;epoch&#34;</span>: 30000,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;policy&#34;</span>: <span class=m>0</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;txnSizeLimit&#34;</span>: 64,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;isQuorum&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;nonce&#34;</span>: <span class=s2>&#34;0x0&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;timestamp&#34;</span>: <span class=s2>&#34;0x5d7c4ae8&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;extraData&#34;</span>: <span class=s2>&#34;0x0000000000000000000000000000000000000000000000000000000000000000f89af8549493c20b1ffa9bf8738bf194d5203e3d2e2a48428d94ff75bd429c43de6719c2983c1e991b027990955994f22670e572a42729a2c10fb26f57bba46cbc3a4294350686ae7615e87a046fc4261fe58fda3872aa65b8410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;gasLimit&#34;</span>: <span class=s2>&#34;0xe0000000&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;difficulty&#34;</span>: <span class=s2>&#34;0x1&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;mixHash&#34;</span>: <span class=s2>&#34;0x63746963616c2062797a616e74696e65206661756c7420746f6c6572616e6365&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;coinbase&#34;</span>: <span class=s2>&#34;0x0000000000000000000000000000000000000000&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;alloc&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;b619ead9d3d72b675a471b3d8ff67673de8ae7f4&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;balance&#34;</span>: <span class=s2>&#34;0x446c3b15f9926687d2c40534fdb564000000000000&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;4cd5ae20dba37c96717f328dc6c02e1c1927be1c&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;balance&#34;</span>: <span class=s2>&#34;0x446c3b15f9926687d2c40534fdb564000000000000&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;461d9bc69d4a32cb599310843bf5bf88342cc03c&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;balance&#34;</span>: <span class=s2>&#34;0x446c3b15f9926687d2c40534fdb564000000000000&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;51ef0c6536e69e2ea46f5ec5e150da423305c63d&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;balance&#34;</span>: <span class=s2>&#34;0x446c3b15f9926687d2c40534fdb564000000000000&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;number&#34;</span>: <span class=s2>&#34;0x0&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;gasUsed&#34;</span>: <span class=s2>&#34;0x0&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;parentHash&#34;</span>: <span class=s2>&#34;0x0000000000000000000000000000000000000000000000000000000000000000&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></td></tr></table></div></div><p>将之前步骤中产生的初始化文件移动到相应节点的工作目录。这些文件现在位于领导节点的工作目录。<code>genesis.json</code>放到每个节点的工作目录, <code>static-nodes.json</code>放到每个节点的<code>data</code>目录。<code>X/nodekey</code>放到对应节点的<code>data/geth</code></p><div class=highlight id=id-46><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cp NodeA/genesis.json NodeB
</span></span><span class=line><span class=cl>$ cp NodeA/genesis.json NodeC
</span></span><span class=line><span class=cl>$ cp NodeA/genesis.json NodeD
</span></span><span class=line><span class=cl>$ cp NodeA/static-nodes.json NodeA/data/
</span></span><span class=line><span class=cl>$ cp NodeA/static-nodes.json NodeB/data/
</span></span><span class=line><span class=cl>$ cp NodeA/static-nodes.json NodeC/data/
</span></span><span class=line><span class=cl>$ cp NodeA/static-nodes.json NodeD/data/
</span></span><span class=line><span class=cl>$ cp NodeA/0/nodekey NodeA/data/geth
</span></span><span class=line><span class=cl>$ cp NodeA/1/nodekey NodeB/data/geth
</span></span><span class=line><span class=cl>$ cp NodeA/2/nodekey NodeC/data/geth
</span></span><span class=line><span class=cl>$ cp NodeA/3/nodekey NodeD/data/geth</span></span></code></pre></td></tr></table></div></div><p>将NodeB，NodeC，NodeD文件夹使用ftp文件传输协议分别移动到对应的三个设备的用户主目录下，使用的软件是FileZilla。</p><p>分别在各自设备的迁移过去的Node文件夹根目录执行节点初始化工作</p><div class=highlight id=id-47><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 在NodeA设备</span>
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> NodeA
</span></span><span class=line><span class=cl>$ geth --datadir data init genesis.json
</span></span><span class=line><span class=cl>WARN <span class=o>[</span>09-14<span class=p>|</span>10:42:06.033<span class=o>]</span> Sanitizing cache to Go<span class=s1>&#39;s GC limits       provided=1024 updated=655
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:42:06.049] Maximum peer count                       ETH=25 LES=0 total=25
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:42:06.056] Allocated cache and file handles         database=/home/shuzang/istanbul/NodeA/data/geth/chaindata cache=16 handles=16
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:42:06.079] Writing custom genesis block 
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:42:06.088] Persisted trie from memory database      nodes=5 size=819.00B time=224.043µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:42:06.088] Successfully wrote genesis state         database=chaindata                                        hash=7d00b6…27b2d4
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:42:06.088] Allocated cache and file handles         database=/home/shuzang/istanbul/NodeA/data/geth/lightchaindata cache=16 handles=16
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:42:06.091] Writing custom genesis block 
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:42:06.091] Persisted trie from memory database      nodes=5 size=819.00B time=48.242µs  gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B
</span></span></span><span class=line><span class=cl><span class=s1>INFO [09-14|10:42:06.091] Successfully wrote genesis state         database=lightchaindata                                        hash=7d00b6…27b2d4
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1># 在NodeB设备
</span></span></span><span class=line><span class=cl><span class=s1>$ cd ~/NodeB
</span></span></span><span class=line><span class=cl><span class=s1>$ geth --datadir data init genesis.json
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1># 在NodeC设备
</span></span></span><span class=line><span class=cl><span class=s1>$ cd ~/NodeC
</span></span></span><span class=line><span class=cl><span class=s1>$ geth --datadir data init genesis.json
</span></span></span><span class=line><span class=cl><span class=s1>WARN [09-14|10:44:13.570] Sanitizing cache to Go&#39;</span>s GC limits       <span class=nv>provided</span><span class=o>=</span><span class=m>1024</span> <span class=nv>updated</span><span class=o>=</span><span class=m>308</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:44:13.594<span class=o>]</span> Maximum peer count                       <span class=nv>ETH</span><span class=o>=</span><span class=m>25</span> <span class=nv>LES</span><span class=o>=</span><span class=m>0</span> <span class=nv>total</span><span class=o>=</span><span class=m>25</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:44:13.607<span class=o>]</span> Allocated cache and file handles         <span class=nv>database</span><span class=o>=</span>/home/pi/NodeC/data/geth/chaindata <span class=nv>cache</span><span class=o>=</span><span class=m>16</span> <span class=nv>handles</span><span class=o>=</span><span class=m>16</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:44:13.659<span class=o>]</span> Writing custom genesis block
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:44:13.663<span class=o>]</span> Persisted trie from memory database      <span class=nv>nodes</span><span class=o>=</span><span class=m>5</span> <span class=nv>size</span><span class=o>=</span>819.00B <span class=nv>time</span><span class=o>=</span>679.667µs <span class=nv>gcnodes</span><span class=o>=</span><span class=m>0</span> <span class=nv>gcsize</span><span class=o>=</span>0.00B <span class=nv>gctime</span><span class=o>=</span>0s <span class=nv>livenodes</span><span class=o>=</span><span class=m>1</span> <span class=nv>livesize</span><span class=o>=</span>0.00B
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:44:13.666<span class=o>]</span> Successfully wrote genesis state         <span class=nv>database</span><span class=o>=</span>chaindata                          <span class=nv>hash</span><span class=o>=</span>7d00b6…27b2d4
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:44:13.666<span class=o>]</span> Allocated cache and file handles         <span class=nv>database</span><span class=o>=</span>/home/pi/NodeC/data/geth/lightchaindata <span class=nv>cache</span><span class=o>=</span><span class=m>16</span> <span class=nv>handles</span><span class=o>=</span><span class=m>16</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:44:13.694<span class=o>]</span> Writing custom genesis block
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:44:13.697<span class=o>]</span> Persisted trie from memory database      <span class=nv>nodes</span><span class=o>=</span><span class=m>5</span> <span class=nv>size</span><span class=o>=</span>819.00B <span class=nv>time</span><span class=o>=</span>573.516µs <span class=nv>gcnodes</span><span class=o>=</span><span class=m>0</span> <span class=nv>gcsize</span><span class=o>=</span>0.00B <span class=nv>gctime</span><span class=o>=</span>0s <span class=nv>livenodes</span><span class=o>=</span><span class=m>1</span> <span class=nv>livesize</span><span class=o>=</span>0.00B
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:44:13.699<span class=o>]</span> Successfully wrote genesis state         <span class=nv>database</span><span class=o>=</span>lightchaindata                          <span class=nv>hash</span><span class=o>=</span>7d00b6…27b2d4
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 在NodeD设备</span>
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> ~/NodeD
</span></span><span class=line><span class=cl>$ geth --datadir data init genesis.json
</span></span><span class=line><span class=cl>WARN <span class=o>[</span>09-14<span class=p>|</span>10:45:59.139<span class=o>]</span> Sanitizing cache to Go<span class=err>&#39;</span>s GC limits       <span class=nv>provided</span><span class=o>=</span><span class=m>1024</span> <span class=nv>updated</span><span class=o>=</span><span class=m>308</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:45:59.155<span class=o>]</span> Maximum peer count                       <span class=nv>ETH</span><span class=o>=</span><span class=m>25</span> <span class=nv>LES</span><span class=o>=</span><span class=m>0</span> <span class=nv>total</span><span class=o>=</span><span class=m>25</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:45:59.166<span class=o>]</span> Allocated cache and file handles         <span class=nv>database</span><span class=o>=</span>/home/pi/NodeD/data/geth/chaindata <span class=nv>cache</span><span class=o>=</span><span class=m>16</span> <span class=nv>handles</span><span class=o>=</span><span class=m>16</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:45:59.215<span class=o>]</span> Writing custom genesis block 
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:45:59.234<span class=o>]</span> Persisted trie from memory database      <span class=nv>nodes</span><span class=o>=</span><span class=m>5</span> <span class=nv>size</span><span class=o>=</span>819.00B <span class=nv>time</span><span class=o>=</span>16.193125ms <span class=nv>gcnodes</span><span class=o>=</span><span class=m>0</span> <span class=nv>gcsize</span><span class=o>=</span>0.00B <span class=nv>gctime</span><span class=o>=</span>0s <span class=nv>livenodes</span><span class=o>=</span><span class=m>1</span> <span class=nv>livesize</span><span class=o>=</span>0.00B
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:45:59.239<span class=o>]</span> Successfully wrote genesis state         <span class=nv>database</span><span class=o>=</span>chaindata                          <span class=nv>hash</span><span class=o>=</span>7d00b6…27b2d4
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:45:59.240<span class=o>]</span> Allocated cache and file handles         <span class=nv>database</span><span class=o>=</span>/home/pi/NodeD/data/geth/lightchaindata <span class=nv>cache</span><span class=o>=</span><span class=m>16</span> <span class=nv>handles</span><span class=o>=</span><span class=m>16</span>
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:45:59.265<span class=o>]</span> Writing custom genesis block 
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:45:59.269<span class=o>]</span> Persisted trie from memory database      <span class=nv>nodes</span><span class=o>=</span><span class=m>5</span> <span class=nv>size</span><span class=o>=</span>819.00B <span class=nv>time</span><span class=o>=</span>596.146µs   <span class=nv>gcnodes</span><span class=o>=</span><span class=m>0</span> <span class=nv>gcsize</span><span class=o>=</span>0.00B <span class=nv>gctime</span><span class=o>=</span>0s <span class=nv>livenodes</span><span class=o>=</span><span class=m>1</span> <span class=nv>livesize</span><span class=o>=</span>0.00B
</span></span><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:45:59.271<span class=o>]</span> Successfully wrote genesis state         <span class=nv>database</span><span class=o>=</span>lightchaindata                          <span class=nv>hash</span><span class=o>=</span>7d00b6…27b2d4</span></span></code></pre></td></tr></table></div></div><p><strong>以下步骤在四个设备上都要执行</strong></p><p>在各自设备Node目录下创建start.sh脚本用于启动节点，脚本基本内容如下</p><div class=highlight id=id-48><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=nv>PRIVATE_CONFIG</span><span class=o>=</span>ignore nohup geth --datadir data --nodiscover --istanbul.blockperiod <span class=m>5</span> --syncmode full --mine --minerthreads <span class=m>1</span> --verbosity <span class=m>5</span> --networkid <span class=m>10</span> --rpc --rpcaddr 0.0.0.0 --rpcapi admin,db,eth,debug,miner,net,shh,txpool,personal,web3,quorum,istanbul --ws --wsorigins<span class=o>=</span><span class=s2>&#34;*&#34;</span> --wsaddr 0.0.0.0 --emitcheckpoints --port <span class=m>30303</span> 2&gt;&gt;node.log <span class=p>&amp;</span></span></span></code></pre></td></tr></table></div></div><p>查找是否有残留启动的geth进程，若有，杀掉该进程</p><div class=highlight id=id-49><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>See <span class=k>if</span> the any geth nodes are running.
</span></span><span class=line><span class=cl>$ ps <span class=p>|</span> grep geth
</span></span><span class=line><span class=cl>Kill geth processes
</span></span><span class=line><span class=cl>$ killall -INT geth</span></span></code></pre></td></tr></table></div></div><p>授予start.sh脚本执行权限，执行该脚本</p><div class=highlight id=id-50><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.... 跳转到脚本所在目录
</span></span><span class=line><span class=cl>$ chmod +x start.sh
</span></span><span class=line><span class=cl>$ ./start.sh</span></span></code></pre></td></tr></table></div></div><p>执行完后查找geth进程是否启动，并执行<code>geth attach</code>命令接入geth控制台</p><div class=highlight id=id-51><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ps <span class=p>|</span> grep geth
</span></span><span class=line><span class=cl> <span class=m>16877</span> pts/0    00:00:01 geth</span></span></code></pre></td></tr></table></div></div><p>接下来可在任一设备的节点目录下使用<code>geth attach</code>命令接入geth控制台执行操作</p><div class=highlight id=id-52><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ geth attach data/geth.ipc
</span></span><span class=line><span class=cl>WARN <span class=o>[</span>09-14<span class=p>|</span>11:00:13.142<span class=o>]</span> Sanitizing cache to Go<span class=err>&#39;</span>s GC limits       <span class=nv>provided</span><span class=o>=</span><span class=m>1024</span> <span class=nv>updated</span><span class=o>=</span><span class=m>655</span>
</span></span><span class=line><span class=cl>Welcome to the Geth JavaScript console!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>instance: Geth/v1.8.18-stable-c894c2d7<span class=o>(</span>quorum-v2.2.5<span class=o>)</span>/linux-amd64/go1.11.12
</span></span><span class=line><span class=cl>coinbase: 0x93c20b1ffa9bf8738bf194d5203e3d2e2a48428d
</span></span><span class=line><span class=cl>at block: <span class=m>0</span> <span class=o>(</span>Sat, <span class=m>14</span> Sep <span class=m>2019</span> 10:05:28 CST<span class=o>)</span>
</span></span><span class=line><span class=cl> datadir: /home/shuzang/istanbul/NodeA/data
</span></span><span class=line><span class=cl> modules: admin:1.0 debug:1.0 eth:1.0 istanbul:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; </span></span></code></pre></td></tr></table></div></div><p>在NodeA的geth控制台使用<code>admin.peers</code>命令查看已连接节点，可以看到NodeC和NodeD都已接入。NodeB设备此时未启动，所以没有接入。</p><div class=highlight id=id-53><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>&gt;</span> <span class=err>admin.peers</span>
</span></span><span class=line><span class=cl><span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=err>caps:</span> <span class=err>[</span><span class=nt>&#34;istanbul/64&#34;</span><span class=err>]</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>enode:</span> <span class=nt>&#34;enode://214dce3278a2b45fb0bf2a1d53c24eb213c5cbb08307e842feab0202cad4f685c5c62a4197d29318f07eb813bf4189db05096b551849039bf81fb74f0211320f@192.168.191.5:45822&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>id:</span> <span class=nt>&#34;5e62fd3b39e5ae259d604f90350686ae7615e87a046fc4261fe58fda3872aa65&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>name:</span> <span class=nt>&#34;Geth/v1.8.18-stable(quorum-v2.2.5)/linux-arm/go1.11.6&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>network:</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>      <span class=err>inbound:</span> <span class=err>true,</span>
</span></span><span class=line><span class=cl>      <span class=err>localAddress:</span> <span class=nt>&#34;192.168.191.2:30303&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=err>remoteAddress:</span> <span class=nt>&#34;192.168.191.5:45822&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=err>static:</span> <span class=err>false,</span>
</span></span><span class=line><span class=cl>      <span class=err>trusted:</span> <span class=err>false</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=err>protocols:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=err>istanbul:</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>        <span class=err>difficulty:</span> <span class=err>1,</span>
</span></span><span class=line><span class=cl>        <span class=err>head:</span> <span class=nt>&#34;0x7d00b604f84c3962821cecbf007d8cf0c3e185d6c3b12a901ec4d996d927b2d4&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=err>version:</span> <span class=err>64</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>}</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>caps:</span> <span class=err>[</span><span class=nt>&#34;istanbul/64&#34;</span><span class=err>]</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>enode:</span> <span class=nt>&#34;enode://cb50baa67204df2246b143e2982e40a89b2924e5c19e2834876c34042f0a81a2e2604ab210d19a048762f5355258d9840932ba868227857d928495d398c04af0@192.168.191.4:47390&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>id:</span> <span class=nt>&#34;c31b4abe77e8a91a1a03d06ff22670e572a42729a2c10fb26f57bba46cbc3a42&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>name:</span> <span class=nt>&#34;Geth/v1.8.18-stable(quorum-v2.2.5)/linux-arm/go1.11.6&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=err>network:</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>      <span class=err>inbound:</span> <span class=err>true,</span>
</span></span><span class=line><span class=cl>      <span class=err>localAddress:</span> <span class=nt>&#34;192.168.191.2:30303&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=err>remoteAddress:</span> <span class=nt>&#34;192.168.191.4:47390&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=err>static:</span> <span class=err>false,</span>
</span></span><span class=line><span class=cl>      <span class=err>trusted:</span> <span class=err>false</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=err>protocols:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=err>istanbul:</span> <span class=err>{</span>
</span></span><span class=line><span class=cl>        <span class=err>difficulty:</span> <span class=err>1,</span>
</span></span><span class=line><span class=cl>        <span class=err>head:</span> <span class=nt>&#34;0x7d00b604f84c3962821cecbf007d8cf0c3e185d6c3b12a901ec4d996d927b2d4&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=err>version:</span> <span class=err>64</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=err>}</span>
</span></span><span class=line><span class=cl><span class=err>}</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>至此私链网络搭建完毕，之后交易和合约部署都可通过geth控制台进行</p><h2 id=五-总结>五. 总结</h2><p>由于网络质量问题，区块链共识无法正常运行，合约部署无法完成。</p><div class=highlight id=id-54><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>INFO <span class=o>[</span>09-14<span class=p>|</span>10:56:00.419<span class=o>]</span> Commit new mining work                   <span class=nv>number</span><span class=o>=</span><span class=m>1</span> <span class=nv>sealhash</span><span class=o>=</span>1305ae…019d90 <span class=nv>uncles</span><span class=o>=</span><span class=m>0</span> <span class=nv>txs</span><span class=o>=</span><span class=m>0</span> <span class=nv>gas</span><span class=o>=</span><span class=m>0</span> <span class=nv>fees</span><span class=o>=</span><span class=m>0</span> <span class=nv>elapsed</span><span class=o>=</span>556.954µs
</span></span><span class=line><span class=cl>TRACE<span class=o>[</span>09-14<span class=p>|</span>10:56:00.420<span class=o>]</span> Dial error                               <span class=nv>task</span><span class=o>=</span><span class=s2>&#34;staticdial 5e62fd3b39e5ae25 192.168.191.5:30303&#34;</span> <span class=nv>err</span><span class=o>=</span><span class=s2>&#34;dial tcp 192.168.191.5:30303: connect: connection refused&#34;</span>
</span></span><span class=line><span class=cl>DEBUG<span class=o>[</span>09-14<span class=p>|</span>10:56:00.421<span class=o>]</span> Can<span class=err>&#39;</span>t resolve node                       <span class=nv>id</span><span class=o>=</span>0x8e6a40         <span class=nv>err</span><span class=o>=</span><span class=s2>&#34;discovery is disabled&#34;</span>
</span></span><span class=line><span class=cl>TRACE<span class=o>[</span>09-14<span class=p>|</span>10:56:00.421<span class=o>]</span> Dial task <span class=k>done</span>                           <span class=nv>task</span><span class=o>=</span><span class=s2>&#34;staticdial 5e62fd3b39e5ae25 192.168.191.5:30303&#34;</span>
</span></span><span class=line><span class=cl>TRACE<span class=o>[</span>09-14<span class=p>|</span>10:56:00.420<span class=o>]</span> handleRequest                            <span class=nv>address</span><span class=o>=</span>0x93C20b1ffA9BF8738BF194d5203e3D2E2A48428d <span class=nv>state</span><span class=o>=</span><span class=s2>&#34;Accept request&#34;</span> <span class=nv>seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>number</span><span class=o>=</span><span class=m>1</span> <span class=nv>hash</span><span class=o>=</span>23cc4d…b11876
</span></span><span class=line><span class=cl>TRACE<span class=o>[</span>09-14<span class=p>|</span>10:56:00.422<span class=o>]</span> Dial error                               <span class=nv>task</span><span class=o>=</span><span class=s2>&#34;staticdial c31b4abe77e8a91a 192.168.191.4:30303&#34;</span> <span class=nv>err</span><span class=o>=</span><span class=s2>&#34;dial tcp 192.168.191.4:30303: connect: connection refused&#34;</span></span></span></code></pre></td></tr></table></div></div><p>主要原因估计是PC上的节点装在了虚拟机里，虚拟机又使用桥接模式，导致最后丢包率和延迟都比较高。</p><p><a href=https://www.ywlib.com/archives/109.html target=_blank rel="external nofollow noopener noreferrer">解决Hyper-V内虚拟机网络延迟高的问题(ping延时大)</a></p><h2 id=附录-树莓派安装-quourm-节点>附录 树莓派安装 quourm 节点</h2><p>在熟悉了树莓派并和虚拟机顺利组网以后，首要面临的事情就是在树莓派中安装quorum节点，由于暂时不使用隐私保护功能，不安装隐私管理器<code>Tessera</code>或<code>Constellation</code>。需要安装的只包括：</p><ul><li>quorum的客户端geth</li><li>Istanbul BFT共识配置工具istanbul-tool</li></ul><h3 id=交叉编译20190909>交叉编译（2019.09.09）</h3><p><a href=https://github.com/jpmorganchase/quorum target=_blank rel="external nofollow noopener noreferrer">quorum项目</a>没有提供可用于arm架构的二进制包，只能自己编译。然而，在树莓派中直接进行编译存在两个问题</p><ol><li>会占用很多不必要的空间，quorum项目文件编译后大小在360M以上</li><li>编译istanbul-tool依赖于golang的某些包，需要访问google，很多ip无法访问。</li></ol><p>因此，最终选择了在PC中进行交叉编译，幸运的是，由于quorum的源项目ethereum可以交叉编译，quorum继承了交叉编译的功能。文档仍然需要看<a href=https://github.com/ethereum/go-ethereum/wiki/Cross-compiling-Ethereum target=_blank rel="external nofollow noopener noreferrer">Cross compiling Ethereum</a>。交叉编译依赖于名为<code>xgo</code>的包，而这个包依赖于Docker和Go，因此，交叉编译之前需要先安装它们。</p><p><em>注：交叉编译在Ubuntu18.04系统下进行。</em></p><p>安装golang</p><div class=highlight id=id-55><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo snap install go --classic
</span></span><span class=line><span class=cl>$ go version</span></span></code></pre></td></tr></table></div></div><p><a href=https://docs.docker.com/install/linux/docker-ce/ubuntu/ target=_blank rel="external nofollow noopener noreferrer">安装docker(使用脚本)</a></p><div class=highlight id=id-56><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl -fsSL https://get.docker.com -o get-docker.sh
</span></span><span class=line><span class=cl>$ sudo sh get-docker.sh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;output truncated&gt;
</span></span><span class=line><span class=cl><span class=c1># 想在非root用户下运行，需要将用户添加到docker group。执行如下命令</span>
</span></span><span class=line><span class=cl>$ sudo usermod -aG docker your-user</span></span></code></pre></td></tr></table></div></div><p>下载quorum</p><div class=highlight id=id-57><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git clone https://github.com/jpmorganchase/quorum.git</span></span></code></pre></td></tr></table></div></div><p>执行交叉编译</p><div class=highlight id=id-58><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>cd</span> quorum
</span></span><span class=line><span class=cl>$ make geth-linux-arm-7
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> build/bin
</span></span><span class=line><span class=cl><span class=c1># 在该目录下可以找到编译后的geth文件</span></span></span></code></pre></td></tr></table></div></div><p>心态爆炸，交叉编译后的geth在树莓派中无法执行，Ubuntu18.04下原本编译完直接放到/usr/local/bin下面即可使用，raspbian中当我放到同样的目录下不起作用，也不知道是交叉编译失败了还是raspbian系统不支持。考虑到raspbian基于Debian，现在不知道Debian应该把可执行文件放在哪里，网上找了很久没找到相关资料。(交叉编译其实可以，直接跳到文章最后可看到方法)</p><h3 id=ubuntu-mate0910-am>Ubuntu mate（09.10 am）</h3><p>quorum的issue中有个项目组的<a href=https://github.com/jpmorganchase/quorum/issues/661 target=_blank rel="external nofollow noopener noreferrer">回答</a>，其中说quorum运行在树莓派中是肯定可以的，这一点终于可以放心，还推荐用Ubuntu，那就试试。</p><blockquote><p>“Yes. Whilst I haven&rsquo;t tried it, I&rsquo;m aware that folks have done this and you can find articles on the internet describing how to do it for Ethereum (Quorum will be the same). My suggestion would be to install Ubuntu on the Rasberry and follow the normal steps for building Quorum.”</p></blockquote><p><a href=https://www.raspberrypi.org/downloads/ target=_blank rel="external nofollow noopener noreferrer">树莓派官网</a>提供的Ubuntu可用镜像有三种：Ubuntu Mate，Ubuntu Core，Ubuntu Server。看到Ubuntu Mate的种种特性，我动心了，看起来好像是专门定制的。</p><p><a href=https://ubuntu-mate.org/raspberry-pi/ target=_blank rel="external nofollow noopener noreferrer">Ubuntu Mate说明及下载</a>，选择的镜像是</p><div class=highlight id=id-59><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Raspberry Pi(recommended)
</span></span><span class=line><span class=cl>For aarch32(ARMv7)computers,like:
</span></span><span class=line><span class=cl>- Raspberry Pi Model B 2
</span></span><span class=line><span class=cl>- Raspberry Pi Model B 3
</span></span><span class=line><span class=cl>- Raspberry Pi Model B 3+</span></span></code></pre></td></tr></table></div></div><p>下载，镜像写入，根目录预先建立<code>ssh</code>和<code>wpa_supplicant.conf</code>文件，插入树莓派，启动运行，扫描不到ip，看起来WiFi没法自动联网。通过网线接到PC上共享网络，ssh访问被拒，接到路由器上一样不行。找资料，关于Ubuntu mate的资料比较少，最终在<a href=https://ubuntu-mate.org/raspberry-pi/ target=_blank rel="external nofollow noopener noreferrer">官方下载页-Additional feature</a>找到一个对特性的说明，称Ubuntu mate没有像raspbian的pi账户一样预定义的用户账户，所有的配置需要在第一次启动时手动完成，ssh预先也没有安装，需要启动后自己安装<code>openssh-server</code>并启用。完了，彻底崩溃，本来没有用户账户就无法登录，连ssh都没有，第一次必须得用屏幕了。屏幕，我没有。。。</p><p>考虑到笔记本电脑上有个HDMI接口，买线总比买屏幕便宜，跑到商店买了根双头HDMI线。回来一试，没用，网上说是因为笔记本的HDMI只能输出信号，没法输入，因此不能作为HDMI屏幕使用。转眼又看到了VGA接口，这个怎么样，结果一查，HDMI转VGA也没用，笔记本的VGA同样只有输出功能，平板，手机全都不行，不能作为显示设备，最多只能用ssh连接。</p><p>台式机的显示器总行了吧，资料上说要自带电源，怕烧坏树莓派。没事，台式的显示器本来就接电源线。又去店里换一个HDMI转VGA的线，是店里唯一的线，结果是坏的，把线接到树莓派上没有反应，提示<code>请检查线缆</code>而不是<code>无信号输入</code>，拿笔记本试了一下，果然不行，完全检测不到第二屏幕。换！店里没线了怎么办，本来想换HDMI转DVI的，因为显示器后面还有个DVI接口，但店员小哥不推荐，说是用DVI的少，最后拿了HDMI转VGA母口的线，又多买了一根双头VGA线，亏到爆。</p><p>不过，总算好使了。</p><p>当在显示器上看到Ubuntu mate的界面时我是激动的，太不容易了。初始配置之后还需要进行系统安装，怪不得没法直接进入。但是路由器的WiFi接入不了，或者连接后没法上网，完全没有头绪，只好先用手机开了热点，这倒是没问题。</p><p>把之前交叉编译的<code>geth</code>文件拷贝到了Ubuntu mate，放到<code>/usr/local/bin</code>目录下，运行<code>geth version</code>测试，倒是可以了，可惜屏幕打印的文本乱码。重新启动了一下树莓派，结果无限循环启动。初始界面提示如下</p><div class=highlight id=id-60><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Driver &#39;sdhost-bcm2835&#39; already registered, aborting...</span></span></code></pre></td></tr></table></div></div><p>论坛上也有人遇到了这个<a href=https://ubuntu-mate.community/t/raspberry-pi-3-model-b-plus-ubuntu-mate-installation-error-driver-sdhost-bcm2835-already-registered-aborting/19300 target=_blank rel="external nofollow noopener noreferrer">问题</a>，但从去年11月到今年5月，回帖的所有人都遇到同样的问题而没有办法解决，我已经放弃了。</p><h3 id=raspbian下自编译quorum0910-pm>Raspbian下自编译quorum(09.10 pm)</h3><p>树莓派上编译使用quorum的人不多，但编译ethereum的人绝对不少，现在想起来，终于意识到一件事，大部分人还是在raspbian系统下编译使用的，既然ethereum的<code>geth</code>客户端可以，quorum没道理不行。有可能不是系统的问题，因为raspbian和ubuntu其实都属于基于Debian的发行版，那就是交叉编译问题了。找不到哪里出的错，干脆直接在Raspbian下编译一次quorum吧，空间占用多一点就多一点，还是足够的，唯一的问题只有翻墙，但这是没办法的事情，而且<code>geth</code>的编译暂时还不需要，<code>istanbul-tool</code>才需要。</p><blockquote><p>注：其实raspbian下翻墙试过了，我有surfshark的账号，官方也给了步骤，<a href=https://support.surfshark.com/hc/en-us/articles/360013425373-How-to-set-up-Surfshark-VPN-on-Raspberry-Pi target=_blank rel="external nofollow noopener noreferrer">How to set up Surfshark VPN on Raspberry Pi</a>，但最后一步连接总是出错，错误提示为</p><p>TLS Error: TLS handshake failed</p><p>网上关于这个Error的问题不少，但都没起作用，就放弃了。</p></blockquote><p>重新写入了之前备份的raspbian镜像（备份真的很有用，能省好多事儿）。启动树莓派，使用预定义的静态ip登录，安装go，下载github上的quorum项目(主要是这里直接下载比<code>git clone</code>快多了)。执行编译，注意使用<code>sudo make all</code>，因为编译需要分配存储空间，不给权限过不了。</p><p>树莓派卡死了。。。</p><p>重启了一次，第二次又卡死了，看来不是意外，应该是编译出了问题，果然，等了很久后，编译退出，系统正常了，但出现了错误提示，是一个存储问题。</p><div class=highlight id=id-61><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl> running gcc failed: fork/exec /usr/bin/gcc: cannot allocate memory</span></span></code></pre></td></tr></table></div></div><p>Ethereum的论坛有人在编译时遇到了同样的问题，<a href=https://ethereum.stackexchange.com/questions/12222/installing-geth-on-raspberry-pi-3-cannot-allocate-memory-error target=_blank rel="external nofollow noopener noreferrer">Installing geth on Raspberry Pi 3 - cannot allocate memory error</a>，回帖提到是因为编译所需的内存不够的缘故，建议杀掉内存占用大而且不用的进程。使用<code>free -h</code>查看</p><div class=highlight id=id-62><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>              total        used        free      shared  buff/cache   available
</span></span><span class=line><span class=cl>Mem:          926Mi       119Mi       575Mi       7.0Mi       231Mi       744Mi
</span></span><span class=line><span class=cl>Swap:          99Mi          0B        99Mi</span></span></code></pre></td></tr></table></div></div><p>不算少啊，700多M呢，再用<code>top</code>命令看进程，并按<code>M</code>键按内存占用排序，发现杀哪个进程都不合适。回帖中还有人提到可以调整交换空间大小，就是第二行的Swap，树莓派默认100M，可以调大点，问题的说明及解决方案见<a href=https://raspberrypi.stackexchange.com/questions/70/how-to-set-up-swap-space target=_blank rel="external nofollow noopener noreferrer">How to set up swap space</a>。</p><p>树莓派使用<code>dphys-swapfile</code>文件定义交换空间大小，打开配置文件</p><div class=highlight id=id-63><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo nano /etc/dphys-swapfile</span></span></code></pre></td></tr></table></div></div><p>启用内容只有一行</p><div class=highlight id=id-64><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>CONF_SWAPSIZE=100</span></span></code></pre></td></tr></table></div></div><p>代表默认100M交换空间大小，把数值改成合适的内容，我直接改了1024。然后重新启用新的配置文件。</p><div class=highlight id=id-65><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo /etc/init.d/dphys-swapfile restart</span></span></code></pre></td></tr></table></div></div><p>完成后再用<code>free -h</code>命令查看交换空间大小就变了，此时重新编译，编译速度会大大加快，等待一段时间后，编译顺利执行完毕。将编译得到的文件复制到/usr/local/bin目录下。</p><div class=highlight id=id-66><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo cp build/bin/geth /usr/local/bin
</span></span><span class=line><span class=cl>$ sudo cp build/bin/bootnode /usr/local/bin
</span></span><span class=line><span class=cl><span class=c1># 验证</span>
</span></span><span class=line><span class=cl>$ geth version</span></span></code></pre></td></tr></table></div></div><p>成功。</p><h3 id=istantul-tool0911-am>istantul-tool(09.11 am)</h3><p>istantul-tool的编译毫无办法，编译过程要访问google，有些ip无法访问，但既然这里编译没有指明针对arm架构，明天把虚拟机编译好的文件拿过来试试。</p><p>Linux编译得到的istanbul文件在树莓派中无法执行，错误提示为</p><div class=highlight id=id-67><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>-bash: ./istanbul: cannot execute binary file: Exec format error</span></span></code></pre></td></tr></table></div></div><p>使用<code>file istanbul</code>命令查看文件信息</p><div class=highlight id=id-68><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>istanbul: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64                                                                                                                        .so.2, for GNU/Linux 3.2.0, Go BuildID=Whu77pcg5_4qdJyzC6lH/RiHbDbxGfs3BFqYFYhdk/Uvgfkwy9en1ShuGpCcPB/qCr7Qg3bewybrm4                                                                                                                        vmE3B, BuildID[sha1]=588353ce35513ef4a2d9695f458a338e226093b1, not stripped</span></span></code></pre></td></tr></table></div></div><p>x86-64的，看来还是架构相关，项目本身没有提供对arm的编译功能，没有办法了。不过有可能不需要在树莓派中运行，我们只需要在作为主节点的虚拟机利用它生成各节点数据，然后拷贝到树莓派中就行。</p><h3 id=运行geth文件0911-am>运行geth文件（09.11 am）</h3><p>直接拷贝编译的geth文件到另一个树莓派，并使用<code>cp</code>命令复制到/usr/local/bin目录无法执行，提示</p><div class=highlight id=id-69><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>-bash: /usr/local/bin/geth: Permission denied</span></span></code></pre></td></tr></table></div></div><p>是因为没有执行权限，使用<code>chmod</code>命令授予权限即可顺利执行</p><div class=highlight id=id-70><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>cd</span> quorum
</span></span><span class=line><span class=cl>$ sudo cp build/bin/geth /usr/local/bin
</span></span><span class=line><span class=cl>$ sudo chmod +x /usr/local/bin/geth
</span></span><span class=line><span class=cl>$ geth version
</span></span><span class=line><span class=cl>WARN <span class=o>[</span>09-11<span class=p>|</span>03:13:38.840<span class=o>]</span> Sanitizing cache to Go<span class=err>&#39;</span>s GC limits       <span class=nv>provided</span><span class=o>=</span><span class=m>1024</span> <span class=nv>updated</span><span class=o>=</span><span class=m>308</span>
</span></span><span class=line><span class=cl>Geth
</span></span><span class=line><span class=cl>Version: 1.8.18-stable
</span></span><span class=line><span class=cl>Quorum Version: 2.2.5
</span></span><span class=line><span class=cl>Architecture: arm
</span></span><span class=line><span class=cl>Protocol Versions: <span class=o>[</span><span class=m>63</span> 62<span class=o>]</span>
</span></span><span class=line><span class=cl>Network Id: <span class=m>1337</span>
</span></span><span class=line><span class=cl>Go Version: go1.11.6
</span></span><span class=line><span class=cl>Operating System: linux
</span></span><span class=line><span class=cl><span class=nv>GOPATH</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=nv>GOROOT</span><span class=o>=</span>/usr/lib/go-1.11</span></span></code></pre></td></tr></table></div></div><p>这样看来，交叉编译的结果也不是因为系统不支持，应该也是没有执行权限，下面是使用geth version命令测试交叉编译的geth的结果。</p><div class=highlight id=id-71><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>WARN <span class=o>[</span>09-11<span class=p>|</span>03:27:52.671<span class=o>]</span> Sanitizing cache to Go<span class=err>&#39;</span>s GC limits       <span class=nv>provided</span><span class=o>=</span><span class=m>1024</span>                                      <span class=nv>updated</span><span class=o>=</span><span class=m>308</span>
</span></span><span class=line><span class=cl>Geth
</span></span><span class=line><span class=cl>Version: 1.8.18-stable
</span></span><span class=line><span class=cl>Git Commit: 7e87e403407fcb3b3c417739eef2fe1dae923add
</span></span><span class=line><span class=cl>Quorum Version: 2.2.5
</span></span><span class=line><span class=cl>Architecture: arm
</span></span><span class=line><span class=cl>Protocol Versions: <span class=o>[</span><span class=m>63</span> 62<span class=o>]</span>
</span></span><span class=line><span class=cl>Network Id: <span class=m>1337</span>
</span></span><span class=line><span class=cl>Go Version: go1.12
</span></span><span class=line><span class=cl>Operating System: linux
</span></span><span class=line><span class=cl><span class=nv>GOPATH</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=nv>GOROOT</span><span class=o>=</span>/usr/local/go</span></span></code></pre></td></tr></table></div></div><p>走了好多弯路。。。原来一开始的结果就可以。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2020-11-24 00:00:00">更新于 2020-11-24&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/2019/using-virtual-machine-to-build-experimental-platform/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Pocket" data-sharer=pocket data-url=https://shuzang.github.io/2019/using-virtual-machine-to-build-experimental-platform/><i class="fa-brands fa-get-pocket fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://shuzang.github.io/2019/using-virtual-machine-to-build-experimental-platform/ data-title=研究记录4-利用虚拟机搭建实验平台(失败)><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/%E7%A7%91%E7%A0%94%E8%AE%B0%E5%BD%95/ class=post-tag>科研记录</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2019/vmware-usage/ class=post-nav-item rel=prev title=VMware虚拟机使用技巧><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>VMware虚拟机使用技巧</a>
<a href=/2019/golang-basic-grammar-1-background-and-preliminary-exploration/ class=post-nav-item rel=next title=Golang语法基础1-背景与初探>Golang语法基础1-背景与初探<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-reward><div class=comment></div><input type=checkbox class=reward-input name=reward id=fi-reward hidden>
<label class=reward-button for=fi-reward>赞赏</label><div class=reward-ways data-mode=static><div><img loading=lazy src=/images/alipay.png srcset="/images/alipay.png, /images/alipay.png 1.5x, /images/alipay.png 2x" sizes=auto data-title="Shuzang 支付宝" data-alt="Shuzang 支付宝" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>支付宝</span></div><div><img loading=lazy src=/images/wechatpay.png srcset="/images/wechatpay.png, /images/wechatpay.png 1.5x, /images/wechatpay.png 2x" sizes=auto data-title="Shuzang 微信" data-alt="Shuzang 微信" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>微信</span></div></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom">Hava a great day !</div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2018 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=/>Shuzang</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><a href=https://github.com/shuzang/shuzang.github.io title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/twemoji/twemoji.min.js defer></script><script src=/lib/lightgallery/lightgallery.min.js defer></script><script src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script src=/lib/pace/pace.min.js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{enable:!1},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0,selector:"article"},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},twemoji:!0}</script><script src=/js/theme.min.js defer></script></body></html>