<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>hugo搭建个人博客3-进阶设置 | Shuzang's Blog</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=Description content="书藏的个人博客，包括Golang、数据结构、算法的学习记录，各类生活技能的学习，每周五发布一期自己的生活周刊"><link rel=prev href=https://shuzang.github.io/2019/%E7%A7%91%E5%AD%A6%E7%B2%BE%E7%A5%9E%E4%B8%8E%E4%BA%BA%E6%96%87%E7%B4%A0%E5%85%BB/><link rel=next href=https://shuzang.github.io/2019/research-proposal-title-select/><link rel=canonical href=https://shuzang.github.io/2019/hugo-blog-advanced-setup/><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><meta name=twitter:card content="summary"><meta name=twitter:title content="hugo搭建个人博客3-进阶设置"><meta name=twitter:description content="本文是 Hugo 使用记录的第二篇，介绍如何为Hugo开启更多的功能。 1. 添加菜单栏页面 我们可以自己建立新的菜单页面1 ，比如我新建life页面用作展示阅"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"hugo搭建个人博客3-进阶设置","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/shuzang.github.io\/2019\/hugo-blog-advanced-setup\/"},"image":{"@type":"ImageObject","url":"https:\/\/shuzang.github.io\/cover.png","width":800,"height":600},"genre":"posts","keywords":"Hugo","wordcount":5598,"url":"https:\/\/shuzang.github.io\/2019\/hugo-blog-advanced-setup\/","datePublished":"2019-07-12T00:00:00\x2b00:00","dateModified":"2020-04-05T00:00:00\x2b00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"shuzang","logo":{"@type":"ImageObject","url":"https:\/\/shuzang.github.io\/logo.png","width":127,"height":40}},"description":""}</script><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/css/lib/fontawesome-free/all.min.css></head><body><script>window.isDark=(window.localStorage&&window.localStorage.getItem('theme'))==='dark';window.isDark&&document.body.classList.add('dark-theme');</script><div class=wrapper><nav class=navbar><div class=top-scroll-bar></div><div class=navbar-container><div class="navbar-header animated bounceIn"><a href=https://shuzang.github.io>Shuzang's Blog</a></div><div class=navbar-menu><a class=menu-item href=https://shuzang.github.io/posts>Posts</a><a class=menu-item href=https://shuzang.github.io/tags>Tags</a><a class=menu-item href=https://shuzang.github.io/categories>Categories</a><a class=menu-item href=https://shuzang.github.io/about>About</a><a href=javascript:void(0); class=theme-switch><i class="fas fa-adjust fa-rotate-180 fa-fw" title="Switch Theme"></i></a></div></div></nav><nav class=navbar-mobile><div class=top-scroll-bar></div><div class=navbar-container><div class=navbar-header><div class="navbar-header-title animated bounceIn"><a href=https://shuzang.github.io>Shuzang's Blog</a></div><div class=menu-toggle id=menu-toggle><span></span><span></span><span></span></div></div><div class=navbar-menu id=mobile-menu><a class=menu-item href=https://shuzang.github.io/posts>Posts</a><a class=menu-item href=https://shuzang.github.io/tags>Tags</a><a class=menu-item href=https://shuzang.github.io/categories>Categories</a><a class=menu-item href=https://shuzang.github.io/about>About</a><a href=javascript:void(0); class=theme-switch><i class="fas fa-adjust fa-rotate-180 fa-fw" title="Switch Theme"></i></a></div></div></nav><main class=main><div class=container><article class=page><h1 class="post-title animated flipInX">hugo搭建个人博客3-进阶设置</h1><div class=post-meta><i class="far fa-calendar-alt fa-fw"></i>published on&nbsp;<time datetime=2019-07-12>2019-07-12</time>&nbsp;
<i class="fas fa-pencil-alt fa-fw"></i>about 5598 words&nbsp;<span class=post-category><i class="far fa-folder fa-fw"></i>included in&nbsp;<a href=https://shuzang.github.io/categories/%E7%88%B1%E7%BC%96%E7%A8%8B%E7%88%B1%E6%8A%80%E6%9C%AF%E7%9A%84%E5%AD%A9%E5%AD%90/>爱编程爱技术的孩子</a>&nbsp;</span></div><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#1-添加菜单栏页面>1. 添加菜单栏页面</a></li><li><a href=#2-字数统计>2. 字数统计</a></li><li><a href=#2-开启评论>2. 开启评论</a></li><li><a href=#3-打赏>3. 打赏</a></li><li><a href=#4-英文url>4. 英文URL</a></li><li><a href=#5-图片插入>5. 图片插入</a></li><li><a href=#6-自定义样式>6. 自定义样式</a></li><li><a href=#8-添加独立域名>8. 添加独立域名</a><ul><li><a href=#31-选购域名>3.1 选购域名</a></li><li><a href=#32-dns解析>3.2 DNS解析</a></li><li><a href=#33-github-上的设置>3.3 GitHub 上的设置</a></li><li><a href=#34-其他玩法>3.4 其他玩法</a></li></ul></li><li><a href=#9-代码高亮>9. 代码高亮</a></li><li><a href=#10-视频>10. 视频</a></li><li><a href=#11-音频>11. 音频</a></li><li><a href=#12-数学公式>12. 数学公式</a></li><li><a href=#待完成>待完成</a></li></ul></nav></div></div><div class=post-toc-mobile id=post-toc-mobile><details><summary><div class=post-toc-title><span>Contents</span>
<span><i class="details icon fas fa-angle-down"></i></span></div></summary><div class=post-toc-content><nav id=TableOfContentsMobile><ul><li><a href=#1-添加菜单栏页面>1. 添加菜单栏页面</a></li><li><a href=#2-字数统计>2. 字数统计</a></li><li><a href=#2-开启评论>2. 开启评论</a></li><li><a href=#3-打赏>3. 打赏</a></li><li><a href=#4-英文url>4. 英文URL</a></li><li><a href=#5-图片插入>5. 图片插入</a></li><li><a href=#6-自定义样式>6. 自定义样式</a></li><li><a href=#8-添加独立域名>8. 添加独立域名</a><ul><li><a href=#31-选购域名>3.1 选购域名</a></li><li><a href=#32-dns解析>3.2 DNS解析</a></li><li><a href=#33-github-上的设置>3.3 GitHub 上的设置</a></li><li><a href=#34-其他玩法>3.4 其他玩法</a></li></ul></li><li><a href=#9-代码高亮>9. 代码高亮</a></li><li><a href=#10-视频>10. 视频</a></li><li><a href=#11-音频>11. 音频</a></li><li><a href=#12-数学公式>12. 数学公式</a></li><li><a href=#待完成>待完成</a></li></ul></nav></div></details></div><div class=post-content><p>本文是 Hugo 使用记录的第二篇，介绍如何为Hugo开启更多的功能。</p><a class=post-dummy-target id=1-添加菜单栏页面></a><h2>1. 添加菜单栏页面</h2><a class=post-dummy-target id=fnref:1></a><p>我们可以自己建立新的菜单页面<sup><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> ，比如我新建<code>life</code>页面用作展示阅读的书籍、电影和游览的景点。建立页面文件的命令如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ hugo new life.md
</code></pre></td></tr></table></div><a class=post-dummy-target id=fnref:2></a></div><p>然后编辑项目根目录下的站点配置文件<code>config.toml</code>，添加页面说明。其中<code>weight</code>字段的值决定了该页面在菜单栏的顺序<sup><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，其值越大，顺序越靠后。按照习惯，<code>About</code>页面放在最后，所以其<code>weight</code>字段值设置为5。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-toml data-lang=toml><span class=c># 添加Tags和Life菜单，并修改About菜单的weight字段值为5（为了调整菜单栏显示顺序）</span>
  <span class=p>[</span><span class=p>[</span><span class=nx>menu</span><span class=p>.</span><span class=nx>main</span><span class=p>]</span><span class=p>]</span>
    <span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;Tags&#34;</span>
    <span class=nx>url</span> <span class=p>=</span> <span class=s2>&#34;/tags/&#34;</span>
    <span class=nx>weight</span> <span class=p>=</span> <span class=mi>3</span>

  <span class=p>[</span><span class=p>[</span><span class=nx>menu</span><span class=p>.</span><span class=nx>main</span><span class=p>]</span><span class=p>]</span>
    <span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;Life&#34;</span>
    <span class=nx>url</span> <span class=p>=</span> <span class=s2>&#34;/life/&#34;</span>
    <span class=nx>weight</span> <span class=p>=</span> <span class=mi>4</span>
</code></pre></td></tr></table></div></div><p>新建的life.md文件位于content目录下，编辑文件内容从而决定实际的页面显示内容。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ ls content -l
total <span class=m>2</span>
-rw-r--r-- <span class=m>1</span> lylw1 <span class=m>197609</span>  <span class=m>658</span>  9月 <span class=m>16</span> 11:34 about.md
-rw-r--r-- <span class=m>1</span> lylw1 <span class=m>197609</span> <span class=m>3343</span>  9月 <span class=m>25</span> 11:34 life.md
</code></pre></td></tr></table></div></div><a class=post-dummy-target id=2-字数统计></a><h2>2. 字数统计</h2><p>中文(<a href=https://github.com/nodejh/hugo-theme-cactus-plus/issues/18 target=_blank>详情</a>)统计的支持可以通过在<code>config.toml</code>中添加如下语句启用</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-toml data-lang=toml><span class=nx>hasCJKLanguage</span> <span class=p>=</span> <span class=kc>true</span>
</code></pre></td></tr></table></div></div><a class=post-dummy-target id=2-开启评论></a><h2>2. 开启评论</h2><p>使用gitalk，首先在GitHub 上创建一个 <a href=https://github.com/settings/applications/new target=_blank>Github Application</a>，记录 <code>Client ID</code> 和 <code>Client Secret</code></p><p>然后编辑<code>config.toml</code>以下字段</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-toml data-lang=toml><span class=p>[</span><span class=nx>params</span><span class=p>.</span><span class=nx>gitalk</span><span class=p>]</span>
<span class=nx>owner</span> <span class=p>=</span> <span class=s2>&#34;shuzang&#34;</span>       <span class=c># 你的GitHub ID       </span>
<span class=nx>repo</span> <span class=p>=</span> <span class=s2>&#34;blog&#34;</span>        <span class=c># 博客网址    </span>
<span class=nx>clientId</span> <span class=p>=</span> <span class=s2>&#34;&#34;</span>    <span class=c># 刚刚记录的client ID      </span>
<span class=nx>clientSecret</span> <span class=p>=</span> <span class=s2>&#34;&#34;</span> <span class=c># 刚刚记录的client secret</span>
<span class=nx>labels</span> <span class=p>=</span> <span class=s2>&#34;gitalk&#34;</span>
</code></pre></td></tr></table></div></div><p>提交到仓库后就能看到博文下开启了评论区</p><p>现在更换使用Valine评论系统，步骤暂未总结</p><a class=post-dummy-target id=3-打赏></a><h2>3. 打赏</h2><p>有些主题支持加入打赏图片，但KeepIt不支持，不过这里还是记录一下。利用<a href=http://www.9thws.com/# target=_blank>第九工厂</a>的免费模板制作好看的打赏二维码。</p><a class=post-dummy-target id=4-英文url></a><h2>4. 英文URL</h2><p>文章分享和访问时，中文URL是最麻烦的一件事情，为了解决这个问题，我阅读了一遍hugo文档中的<a href=https://gohugo.io/content-management/urls/ target=_blank>URL Management</a>，最终决定使用如下办法。</p><p>首先修改站点配置文件<code>config.toml</code>中的<code>Permalinks</code>字段如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-toml data-lang=toml><span class=p>[</span><span class=nx>Permalinks</span><span class=p>]</span>
 <span class=nx>posts</span> <span class=p>=</span> <span class=s2>&#34;/:year/:month/:slug/&#34;</span>
</code></pre></td></tr></table></div></div><p>初始状态该字段值为<code>posts = "/:year/:month/:filename/"</code>，使用文件名作为URL，但是文件名作为管理和查找的手段，使用英文较为不便，而文章标题为了便于阅读，也不方便命名为英文，只能使用额外的<code>slug</code>字段。</p><p>之后在每篇文章头部的配置信息中添加<code>slug</code>字段即可，一个例子如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-toml data-lang=toml><span class=nx>title</span><span class=err>:</span> <span class=nx>Golang语法基础100问</span>
<span class=nx>date</span><span class=err>:</span> <span class=mi>2019</span><span class=mi>-12</span><span class=mi>-23</span>
<span class=nx>slug</span><span class=err>:</span> <span class=s2>&#34;100 question of Golang basic syntax&#34;</span>
<span class=nx>tags</span><span class=err>:</span> <span class=p>[</span><span class=nx>Golang</span><span class=p>]</span>
<span class=nx>categories</span><span class=err>:</span> <span class=p>[</span><span class=nx>爱编程爱技术的孩子</span><span class=p>]</span>
</code></pre></td></tr></table></div></div><p>这篇文章最后的URL将会是<code>http://shuzang.github.io/2019/12/100-question-of-golang-basic-syntax/</code></p><a class=post-dummy-target id=5-图片插入></a><h2>5. 图片插入</h2><p>博客维护所面临的一个重要问题就是图床，一开始使用Github作为图床，后来迁移到Github issue，再后来因为图片经常加载不出来，迁移到了路过图床，不过用别的图床总归不放心，图片不多的情况下，最终决定将所有图片放到本地，操作步骤如下</p><p>首先，对于Hugo来说，所有的静态文件都应该位于根目录的static目录下，比如，我在该目录下存放了 <code>example.img</code> 图片，那么在文章中就可以用以下方式引用图片</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>![](/example.img)
</code></pre></td></tr></table></div></div><p>这是因为静态文件的查找规则就是以 static 为根目录，所以图片从这里寻找。为了保证清晰的文件结构，便于之后寻找图片，我们采用如下规则存放图片：一篇文章的所有图片放在以文章名命名的一个文件夹中，该文件夹放在<code>static/images</code>目录下。如本文文件名为「hugo搭建个人博客3-进阶设置」，则本文所有图片放在 <code>static/images/hugo搭建个人博客3-进阶设置</code>目录下，在文章中插入图片时，使用的路径为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>![](/images/example.img)
</code></pre></td></tr></table></div></div><p>其中，example.img为图片名。至此为止，网页中可以正常显示插入的图片，但是Typora中无法显示图片，因此我们需要设置Typora的图片根目录，方法是在文章开头的YAML头中添加如下字段</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=w>
</span></code></pre></td></tr></table></div></div><p>路径根据自己的文章位置而定，也可以在工具栏选择「格式—>图像—>设置图片根目录」，产生的效果是相同的，也是在文章头部添加该字段。</p><p>最后，我们在Typora的偏好设置中，设置插入图片时自动复制到相应的目录下即可，这样所有的图片都可以和博客代码存放在一起。、</p><p>这种方法唯一的缺点是所有图片和博客项目源码的总大小不能超过1G，因为一个Github项目空间最大1G</p><a class=post-dummy-target id=6-自定义样式></a><h2>6. 自定义样式</h2><p>通过定义自定义 <code>.scss</code> 样式文件, <strong>LoveIt</strong> 主题支持可配置的样式.</p><p>包含自定义 <code>.scss</code> 样式文件的目录相对于 <strong>你的项目根目录</strong> 的路径为 <code>config/css</code>.</p><p>在 <code>config/css/_override.scss</code> 中, 你可以覆盖 <code>themes/LoveIt/assets/css/_variables.scss</code> 中的变量以自定义样式.</p><p>这是一个例子:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-scss data-lang=scss><span class=k>@import</span> <span class=sx>url(</span><span class=sx>&#39;https://fonts.googleapis.com/css?family=Fira+Mono:400,700&amp;display=swap&amp;subset=latin-ext&#39;</span><span class=sx>)</span><span class=p>;</span>
<span class=nv>$code-font-family</span><span class=o>:</span> <span class=n>Fira</span> <span class=n>Mono</span><span class=o>,</span> <span class=n>Source</span> <span class=n>Code</span> <span class=n>Pro</span><span class=o>,</span> <span class=n>Menlo</span><span class=o>,</span> <span class=n>Consolas</span><span class=o>,</span> <span class=n>Monaco</span><span class=o>,</span> <span class=no>monospace</span><span class=p>;</span>
</code></pre></td></tr></table></div></div><p>在 <code>config/css/_custom.scss</code> 中, 你可以添加一些 CSS 样式代码以自定义样式.</p><a class=post-dummy-target id=8-添加独立域名></a><h2>8. 添加独立域名</h2><p>给部署在 GitHub Pages 上的博客添加独立域名，是早就想做的事，以前是因为没什么需求，.me域名比较贵，国内购买域名备案又比较麻烦，所以一直没做。这次选择了.top域名，买了三年才67，可以了，三年以后开始工作再考虑换.me域名，毕竟这个冷门的字段应该没人要。而且发现部署在github pages不需要备案，因为服务器不在国内。</p><a class=post-dummy-target id=31-选购域名></a><h3>3.1 选购域名</h3><p>可能很多人已经买好了域名了，你可以[跳过这部分](#GitHub 上的设置)</p><p>要想给博客绑定独立域名，首先你得拥有一个域名。得去域名注册网站购买域名，国内的域名商推荐<a href=https://wanwang.aliyun.com/ target=_blank>万网</a>，国外的推荐 <a href=https://www.godaddy.com/ target=_blank>GoDaddy</a>，因为他们分别是中国最大和世界最大的域名注册服务商。不了解的领域当然挑知名有信誉的总是没错的。</p><p>要是买<code>.me</code>域名就真的只能在GoDaddy买了，首年24，续费不知道，但是还需要购买隐私保护，这样就变成了每年60，要是工作后还负担的起，现在买这个还是算了。<code>.io</code>首年就320，更负担不起了。国内的话，<code>.com</code>，<code>.net</code>这些就不想了，基本都已经被注册了，于是选择了<code>.top</code>，一口气买了三年，一共67，而且在国内购买的好处是本身对WHOIS中的个人信息提供隐私保护。阿里云之前对域名提供的隐私保护服务已经停用了，主要是因为</p><blockquote><p>为落实<a href=https://www.icann.org/news/announcement-2018-05-22-zh target=_blank>ICANN临时规范</a>要求，自2018年5月25日起阿里云WHOIS查询公开信息中将不再显示域名注册人、管理联系人和技术联系人的个人数据，包括姓名、邮箱、电话、街道地址等。</p></blockquote><p>这样域名的注册信息已得到默认保护，不再需要额外开通隐私保护。</p><p>具体选购过程大致是：<strong>搜索域名 -> 将喜欢的域名加入购物车 ->选择域名注册模板(没有的话要创建)-> 付款 -> 购买成功</strong>，实际使用还需要进行邮箱验证和实名认证，否则域名无法启用。</p><p>最为繁琐的域名备案过程可以跳过，因为博客挂载在github pages，而只有服务器在国内的网站才需要备案。</p><a class=post-dummy-target id=32-dns解析></a><h3>3.2 DNS解析</h3><p>使用CNAME别名映射域名，比设置A记录更方便，最重要的是A记录无法开启https。参数设置如下图所示。</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/BC_20190712_1Heu1H.png alt=CNAME设置 class=lazyload><figcaption class=image-caption>CNAME设置</figcaption></figure></p><p>访问网址时可能会加www前缀，因此可以设置一个二级域名解析，方法相同。</p><a class=post-dummy-target id=33-github-上的设置></a><h3>3.3 GitHub 上的设置</h3><p>到 Github <code>shuzang.github.io</code>仓库设置里，在 <code>Custom domain</code> 这里填写<code>shuzang.top</code>域名并保存。</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/BC_20190712_1He3HP.png alt=github域名设置 class=lazyload><figcaption class=image-caption>github域名设置</figcaption></figure></p><p><code>Custom domain</code> 下方 <code>Enforce HTTPS</code> 这个选项一并勾选，Github 跟 Let’s Encrypt 有合作，如果勾选了这个选项，Let’s Encrypt 就会给你的博客签发一张 SSL 证书，免费的。</p><p><figure><img src=/svg/loading.min.svg data-sizes=auto data-src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/BC_20190712_1HeJN8.png alt=启用HTTPS class=lazyload><figcaption class=image-caption>启用HTTPS</figcaption></figure></p><p>发现上面这种方法每次提交后都需要重新填写<code>custom domin</code>字段，因此采用另一种方式，创建一个名为 <code>CNAME</code> 的文件放在<code>content</code>目录，其中的内容<strong>只</strong>写上你的域名，像这样</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>shuzang.top
</code></pre></td></tr></table></div></div><p>使用hugo命令生成文件会将CNAME文件直接复制到public目录，并通过持续集成将其推送到master分支根目录。</p><p>等几分钟 (刷新 DNS 缓存)，然后在浏览器中输入<code>shuzang.top</code>，回车，不出意外看到了自己的博客。</p><a class=post-dummy-target id=34-其他玩法></a><h3>3.4 其他玩法</h3><p>除了将域名绑定给博客外博客，还可以用域名干一些别的事。</p><p>比如，<strong>使用 A 记录将 <code>mail.shuzang.me</code> 这个二级域名指向 <code>207.46.149.80</code> 就可以 “搭建” 一个 <a href=http://mail.shuzang.top/ target=_blank>临时邮箱</a>服务</strong> (感谢 <a href=https://moeclub.org/ target=_blank>萌咖 | MoeClub.org</a> 提供的服务器)</p><p>如果你还有一台拥有<strong>公网 IP</strong> 的服务器，可玩性就更高了！</p><p>如果有能力，你甚至可以拥有自己的搜索引擎</p><a class=post-dummy-target id=9-代码高亮></a><h2>9. 代码高亮</h2><a class=post-dummy-target id=fnref:3></a><p>KeepIt主题本身对代码高亮的渲染是在本地执行的，使用的是<a href=https://github.com/google/code-prettify target=_blank>google code prettify</a>，高亮风格较少而且作者没提供配置选项，通过使用<code>Highlight.js</code>库可以自定义代码高亮格式<sup><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>。</p><p>为了最大程度的保持原主题文件的代码，我们首先将主题文件夹下<code>layouts/partials/js.html</code>文件复制到Hugo项目文件夹，令其位于同样的目录，然后删除文件中的以下语句</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html>{{ $prettify := resources.Get &#34;/js/prettify.min.js&#34; }}
</code></pre></td></tr></table></div></div><p>之后删除<code>js.html</code>文件中所有<code>$prettify</code>字段。</p><p>复制主题文件夹<code>layouts/partials/head.html</code>文件到项目文件夹，并添加如下内容</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>link</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://cdn.bootcss.com/highlight.js/9.15.10/styles/atom-one-light.min.css&#34;</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span><span class=p></span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js&#34;</span><span class=p></span><span class=p>&gt;</span><span class=p>&lt;</span><span class=p>/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.bootcss.com/highlight.js/9.15.10/languages/go.min.js&#34;</span><span class=p></span><span class=p>&gt;</span><span class=p>&lt;</span><span class=p>/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>script</span><span class=p></span><span class=p>&gt;</span><span class=nx>hljs</span><span class=p>.</span><span class=nx>initHighlightingOnLoad</span><span class=p>(</span><span class=p>)</span><span class=p>;</span><span class=p>&lt;</span><span class=p>/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div><p>以上代码使用了<a href=https://www.bootcdn.cn/highlight.js/ target=_blank>bootCDN</a>对<code>Highlight.js</code>进行加速，并额外添加了对go语言代码高亮的支持。</p><p>最后需要删除主题文件夹中的某些内容，包括</p><ol><li><p><code>assets/js/prettify.min.js</code>文件</p></li><li><p><code>assets/css/main.scss</code>的以下内容</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-scss data-lang=scss><span class=k>@import</span> <span class=s2>&#34;</span><span class=s2>_common/_prettyprint/default.scss</span><span class=s2>&#34;</span>
</code></pre></td></tr></table></div></div></li></ol><p>此时代码就可以以浅色的atom格式高亮了，不过可惜的是不显示代码行数，就只能等以后再说了。</p><p>还要注意的是以后每次更新主题都要删除主题文件夹中以上两个内容。</p><a class=post-dummy-target id=10-视频></a><h2>10. 视频</h2><p>可以使用html代码直接在文章中嵌入视频，因为各视频网站一般会在分享链接中提供iframe格式的代码，以B站为例，复制如下代码放在文章中相应的位置即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>iframe</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;//player.bilibili.com/player.html?aid=75064361&#34;</span> <span class=na>scrolling</span><span class=o>=</span><span class=s>&#34;no&#34;</span> <span class=na>border</span><span class=o>=</span><span class=s>&#34;0&#34;</span> <span class=na>frameborder</span><span class=o>=</span><span class=s>&#34;no&#34;</span> <span class=na>framespacing</span><span class=o>=</span><span class=s>&#34;0&#34;</span> <span class=na>allowfullscreen</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;width: 100%;height: 600px;&#34;</span> <span class=p></span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=p>/</span><span class=nt>iframe</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div><p>注意添加<code>style</code>字段调整高度与宽度，否则可能显示效果不会很好，上面的代码效果如下</p><iframe src="//player.bilibili.com/player.html?aid=75064361" scrolling=no border=0 frameborder=no framespacing=0 allowfullscreen style=width:100%;height:600px></iframe><p>也可以使用短代码来完成，Hugo提供了<a href=https://gohugo.io/templates/shortcode-templates/ target=_blank>Shortcodes</a>功能可以帮助我们定制一些语法，仍以B站视频为例，在项目根目录建立<code>/layouts/shortcodes</code>文件夹，在该文件夹内新建<code>bilibili.html</code>文件，文件内容编辑如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>iframe</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;//player.bilibili.com/player.html?aid={{ .Get 0 }}&#34;</span> 
        <span class=na>scrolling</span><span class=o>=</span><span class=s>&#34;no&#34;</span> <span class=na>border</span><span class=o>=</span><span class=s>&#34;0&#34;</span> <span class=na>frameborder</span><span class=o>=</span><span class=s>&#34;no&#34;</span> <span class=na>framespacing</span><span class=o>=</span><span class=s>&#34;0&#34;</span> 
        <span class=na>allowfullscreen</span><span class=o>=</span><span class=s>&#34;true&#34;</span> 
        <span class=na>style</span><span class=o>=</span><span class=s>&#34;width: 100%;height: 600px;&#34;</span> <span class=p></span><span class=p>&gt;</span> 
<span class=p>&lt;</span><span class=p>/</span><span class=nt>iframe</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div><p>以后在文章中添加视频就可以使用如下格式的代码，其中的参数为视频代码，可以在视频URL中找到</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>video <span class=m>75064361</span>
</code></pre></td></tr></table></div></div><p>使用iframe即使在本地的Typora编辑器也可以查看效果，但是代码较多，而是用shortcodes可以精简代码，但只有开启预览或将文章推送到云端才能看到，各有利弊，自己权衡。</p><p>最后还需要提一点，引入视频会导致网页加载速度大幅下滑，如非必要，最好不要引入。</p><a class=post-dummy-target id=11-音频></a><h2>11. 音频</h2><p>在文章中嵌入音频也是一个需求，尤其是歌曲，使用频率比较高，我们在这里注意使用使用 <a href=https://github.com/MoePlayer/APlayer target=_blank>APlayer</a> 和 <a href=https://github.com/metowolf/MetingJS target=_blank>MetingJS</a> 完成这一功能。</p><p>在<code>layouts</code>目录下的head.html文件中添加如下内容</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html><span class=c>&lt;!--</span><span class=c> require APlayer </span><span class=c>--&gt;</span>
<span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css&#34;</span><span class=p></span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js&#34;</span><span class=p></span><span class=p>&gt;</span><span class=p>&lt;</span><span class=p>/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=c>&lt;!--</span><span class=c> require MetingJS </span><span class=c>--&gt;</span>
<span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js&#34;</span><span class=p></span><span class=p>&gt;</span><span class=p>&lt;</span><span class=p>/</span><span class=nt>script</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div><p>然后在文章中可以通过如下语句添加音频</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>meting-js</span> <span class=na>auto</span><span class=o>=</span><span class=s>&#34;https://y.qq.com/n/yqq/song/000xRG4E4diqXD.html&#34;</span><span class=p></span><span class=p>&gt;</span><span class=p>&lt;</span><span class=p>/</span><span class=nt>meting-js</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div><p>播放链接可以通过浏览器从各音乐平台获取，当然，和视频一样使用iframe格式的代码嵌入也是可以的</p><p>最后，也可以使用shortcodes缩短音频代码，在<code>layouts/shortcodes</code>目录下新建audio.html文件，编辑内容如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>meting-js</span> <span class=na>auto</span><span class=o>=</span><span class=s>{{</span> <span class=err>.</span><span class=na>Get</span> <span class=na>0</span> <span class=err>}</span><span class=err>}</span><span class=p></span><span class=p>&gt;</span><span class=p>&lt;</span><span class=p>/</span><span class=nt>meting-js</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div><p>在文章中就可以像下面这样使用，参数为音频网址</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>audio  <span class=s2>&#34;https://y.qq.com/n/yqq/song/000xRG4E4diqXD.html&#34;</span>
</code></pre></td></tr></table></div></div><a class=post-dummy-target id=12-数学公式></a><h2>12. 数学公式</h2><a class=post-dummy-target id=fnref:1></a><p>文章中使用数学公式也是一种需求，但是Hugo本身不提供对这种语法的支持，KeepIt主题也没有提供这个功能，因此需要自己添加<sup><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。</p><p>主要方法是在已经生成好的HTML页面中使用JavaScript来渲染LaTex形式的数学公式，因此选择了这方面最流行的库<a href=https://www.mathjax.org/ target=_blank>MathJax</a>。</p><p>与代码相同，数学公式也有行内(inline)和区块(block)两种，下面展示了这两种写法</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-latex data-lang=latex>When <span class=s>$</span><span class=nb>a </span><span class=nv>\ne</span><span class=nb> </span><span class=m>0</span><span class=s>$</span>, there are two solutions to `<span class=s>\(</span><span class=nb>ax</span><span class=nb>^</span><span class=m>2</span><span class=nb> </span><span class=o>+</span><span class=nb> bx </span><span class=o>+</span><span class=nb> c </span><span class=o>=</span><span class=nb> </span><span class=m>0</span><span class=s>\)</span>` and they are:

<span class=sb>$$</span><span class=nb>x </span><span class=o>=</span><span class=nb> </span><span class=nb>{</span><span class=o>-</span><span class=nb>b </span><span class=nv>\pm</span><span class=nb> </span><span class=nv>\sqrt</span><span class=nb>{</span><span class=nb>b</span><span class=nb>^</span><span class=m>2</span><span class=o>-</span><span class=m>4</span><span class=nb>ac</span><span class=nb>}</span><span class=nb> </span><span class=nv>\over</span><span class=nb> </span><span class=m>2</span><span class=nb>a</span><span class=nb>}</span><span class=s>$$</span>
</code></pre></td></tr></table></div></div><p>Hugo官方其实给了一个<a href=https://gohugo.io/content-management/formats/#enable-mathjax target=_blank>解决办法</a>，分为三步：</p><ol><li><p>引入<code>&lt;script></code>标签</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=o>&lt;</span><span class=nx>script</span> <span class=nx>type</span><span class=o>=</span><span class=s2>&#34;text/javascript&#34;</span> <span class=nx>src</span><span class=o>=</span><span class=s2>&#34;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML&#34;</span><span class=o>&gt;</span>
<span class=o>&lt;</span><span class=err>/</span><span class=err>s</span><span class=err>c</span><span class=err>r</span><span class=err>i</span><span class=err>p</span><span class=err>t</span><span class=err>&gt;</span>
</code></pre></td></tr></table></div></div><p>需要确保这段代码嵌入网站所有页面中，因此把它添加到<code>layouts/partials/head.html</code>文件中。</p></li><li><p>行内公式和特殊字符转义</p><p>第一步执行完后行内公式依然无法显示，如下划线<code>_</code>等特殊字符转义也有问题。因此需要继续添加如下代码，仍然是<code>layouts/partials/head.html</code>文件，两段代码前者做了一些配置，后者自动给<code>className</code>加<code>has-jax</code>后缀。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-js data-lang=js><span class=o>&lt;</span><span class=nx>script</span> <span class=nx>type</span><span class=o>=</span><span class=s2>&#34;text/x-mathjax-config&#34;</span><span class=o>&gt;</span>
<span class=nx>MathJax</span><span class=p>.</span><span class=nx>Hub</span><span class=p>.</span><span class=nx>Config</span><span class=p>(</span><span class=p>{</span>
  <span class=nx>tex2jax</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>inlineMath</span><span class=o>:</span> <span class=p>[</span><span class=p>[</span><span class=s1>&#39;$&#39;</span><span class=p>,</span><span class=s1>&#39;$&#39;</span><span class=p>]</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;\\(&#39;</span><span class=p>,</span><span class=s1>&#39;\\)&#39;</span><span class=p>]</span><span class=p>]</span><span class=p>,</span>
    <span class=nx>displayMath</span><span class=o>:</span> <span class=p>[</span><span class=p>[</span><span class=s1>&#39;$$&#39;</span><span class=p>,</span><span class=s1>&#39;$$&#39;</span><span class=p>]</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;\[&#39;</span><span class=p>,</span><span class=s1>&#39;\]&#39;</span><span class=p>]</span><span class=p>]</span><span class=p>,</span>
    <span class=nx>processEscapes</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
    <span class=nx>processEnvironments</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
    <span class=nx>skipTags</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;script&#39;</span><span class=p>,</span> <span class=s1>&#39;noscript&#39;</span><span class=p>,</span> <span class=s1>&#39;style&#39;</span><span class=p>,</span> <span class=s1>&#39;textarea&#39;</span><span class=p>,</span> <span class=s1>&#39;pre&#39;</span><span class=p>]</span><span class=p>,</span>
    <span class=nx>TeX</span><span class=o>:</span> <span class=p>{</span> <span class=nx>equationNumbers</span><span class=o>:</span> <span class=p>{</span> <span class=nx>autoNumber</span><span class=o>:</span> <span class=s2>&#34;AMS&#34;</span> <span class=p>}</span><span class=p>,</span>
         <span class=nx>extensions</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;AMSmath.js&#34;</span><span class=p>,</span> <span class=s2>&#34;AMSsymbols.js&#34;</span><span class=p>]</span> <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span><span class=p>)</span><span class=p>;</span>
<span class=o>&lt;</span><span class=err>/</span><span class=err>s</span><span class=err>c</span><span class=err>r</span><span class=err>i</span><span class=err>p</span><span class=err>t</span><span class=err>&gt;</span>
   
<span class=o>&lt;</span><span class=nx>script</span> <span class=nx>type</span><span class=o>=</span><span class=s2>&#34;text/x-mathjax-config&#34;</span><span class=o>&gt;</span>
  <span class=nx>MathJax</span><span class=p>.</span><span class=nx>Hub</span><span class=p>.</span><span class=nx>Queue</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// Fix &lt;code&gt; tags after MathJax finishes running. This is a
</span><span class=c1></span>    <span class=c1>// hack to overcome a shortcoming of Markdown. Discussion at
</span><span class=c1></span>    <span class=c1>// https://github.com/mojombo/jekyll/issues/199
</span><span class=c1></span>    <span class=kd>var</span> <span class=nx>all</span> <span class=o>=</span> <span class=nx>MathJax</span><span class=p>.</span><span class=nx>Hub</span><span class=p>.</span><span class=nx>getAllJax</span><span class=p>(</span><span class=p>)</span><span class=p>,</span> <span class=nx>i</span><span class=p>;</span>
    <span class=k>for</span><span class=p>(</span><span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>all</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>i</span> <span class=o>+=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>all</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span><span class=p>.</span><span class=nx>SourceElement</span><span class=p>(</span><span class=p>)</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>.</span><span class=nx>className</span> <span class=o>+=</span> <span class=s1>&#39; has-jax&#39;</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span><span class=p>)</span><span class=p>;</span>
<span class=o>&lt;</span><span class=err>/</span><span class=err>s</span><span class=err>c</span><span class=err>r</span><span class=err>i</span><span class=err>p</span><span class=err>t</span><span class=err>&gt;</span>
</code></pre></td></tr></table></div></div></li><li><p>CSS调整</p><p>最后还需要在CSS中对这种特殊的MathJax进行样式处理，否则行内公式的显示会很奇怪。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-css data-lang=css><span class=nt>code</span><span class=p>.</span><span class=nc>has-jax</span> <span class=p>{</span>
    <span class=k>font</span><span class=p>:</span> <span class=kc>inherit</span><span class=p>;</span>
    <span class=k>font-size</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
    <span class=k>background</span><span class=p>:</span> <span class=kc>inherit</span><span class=p>;</span>
    <span class=k>border</span><span class=p>:</span> <span class=kc>inherit</span><span class=p>;</span>
    <span class=k>color</span><span class=p>:</span> <span class=mh>#515151</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div></li></ol><p>然后以上方法步骤繁琐最后还不一定起作用，因此采用把所有修改写成一个<code>layouts/partials/mathjax.html</code>文件的方法，把官方提到的三处修改合并成一个partial，然后把MathJax的CDN修改到国内。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>script</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span>
        <span class=na>async</span>
        <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML&#34;</span><span class=p></span><span class=p>&gt;</span>
<span class=nx>MathJax</span><span class=p>.</span><span class=nx>Hub</span><span class=p>.</span><span class=nx>Config</span><span class=p>(</span><span class=p>{</span>
  <span class=nx>tex2jax</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>inlineMath</span><span class=o>:</span> <span class=p>[</span><span class=p>[</span><span class=s1>&#39;$&#39;</span><span class=p>,</span><span class=s1>&#39;$&#39;</span><span class=p>]</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;\\(&#39;</span><span class=p>,</span><span class=s1>&#39;\\)&#39;</span><span class=p>]</span><span class=p>]</span><span class=p>,</span>
    <span class=nx>displayMath</span><span class=o>:</span> <span class=p>[</span><span class=p>[</span><span class=s1>&#39;$$&#39;</span><span class=p>,</span><span class=s1>&#39;$$&#39;</span><span class=p>]</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;\[&#39;</span><span class=p>,</span><span class=s1>&#39;\]&#39;</span><span class=p>]</span><span class=p>]</span><span class=p>,</span>
    <span class=nx>processEscapes</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
    <span class=nx>processEnvironments</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
    <span class=nx>skipTags</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;script&#39;</span><span class=p>,</span> <span class=s1>&#39;noscript&#39;</span><span class=p>,</span> <span class=s1>&#39;style&#39;</span><span class=p>,</span> <span class=s1>&#39;textarea&#39;</span><span class=p>,</span> <span class=s1>&#39;pre&#39;</span><span class=p>]</span><span class=p>,</span>
    <span class=nx>TeX</span><span class=o>:</span> <span class=p>{</span> <span class=nx>equationNumbers</span><span class=o>:</span> <span class=p>{</span> <span class=nx>autoNumber</span><span class=o>:</span> <span class=s2>&#34;AMS&#34;</span> <span class=p>}</span><span class=p>,</span>
         <span class=nx>extensions</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;AMSmath.js&#34;</span><span class=p>,</span> <span class=s2>&#34;AMSsymbols.js&#34;</span><span class=p>]</span> <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span><span class=p>)</span><span class=p>;</span>

<span class=nx>MathJax</span><span class=p>.</span><span class=nx>Hub</span><span class=p>.</span><span class=nx>Queue</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// Fix &lt;code&gt; tags after MathJax finishes running. This is a
</span><span class=c1></span>    <span class=c1>// hack to overcome a shortcoming of Markdown. Discussion at
</span><span class=c1></span>    <span class=c1>// https://github.com/mojombo/jekyll/issues/199
</span><span class=c1></span>    <span class=kd>var</span> <span class=nx>all</span> <span class=o>=</span> <span class=nx>MathJax</span><span class=p>.</span><span class=nx>Hub</span><span class=p>.</span><span class=nx>getAllJax</span><span class=p>(</span><span class=p>)</span><span class=p>,</span> <span class=nx>i</span><span class=p>;</span>
    <span class=k>for</span><span class=p>(</span><span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>all</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>i</span> <span class=o>+=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>all</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span><span class=p>.</span><span class=nx>SourceElement</span><span class=p>(</span><span class=p>)</span><span class=p>.</span><span class=nx>parentNode</span><span class=p>.</span><span class=nx>className</span> <span class=o>+=</span> <span class=s1>&#39; has-jax&#39;</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span><span class=p>)</span><span class=p>;</span>
<span class=p>&lt;</span><span class=p>/</span><span class=nt>script</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>style</span><span class=p></span><span class=p>&gt;</span>
<span class=nt>code</span><span class=p>.</span><span class=nc>has-jax</span> <span class=p>{</span>
    <span class=k>font</span><span class=p>:</span> <span class=kc>inherit</span><span class=p>;</span>
    <span class=k>font-size</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
    <span class=k>background</span><span class=p>:</span> <span class=kc>inherit</span><span class=p>;</span>
    <span class=k>border</span><span class=p>:</span> <span class=kc>inherit</span><span class=p>;</span>
    <span class=k>color</span><span class=p>:</span> <span class=mh>#515151</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>&lt;</span><span class=p>/</span><span class=nt>style</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div><p>最后把以上partial模板添加到<code>head.html</code>模板中</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html>{{ partial &#34;mathjax.html&#34; . }}
</code></pre></td></tr></table></div></div><p>但直接修改主题中的文件并不合适，因为原作者可能会进行一定的更新（对我这样的半吊子很依赖作者对主题的更新），好在Hugo对文件的寻找是有优先级的，会首先在项目文件中寻找相应的渲染模板，然后才去主题文件夹寻找，因此将<code>layouts/partials/mathjax.html</code>和<code>layouts/partials/head.html</code>这两个修改后的文件复制到Hugo项目的相同位置，此时就可以直接反馈在页面上了。此时在hugo项目根目录查看目录结构如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>$ ls
archetypes/  content/  layouts/    static/
config.toml  data/     resources/  themes/

$ find layouts -type f <span class=p>|</span> xargs ls -l
-rw-r--r-- <span class=m>1</span> lylw1 <span class=m>197609</span> <span class=m>2679</span> 11月 <span class=m>12</span> 15:51 layouts/partials/head.html
-rw-r--r-- <span class=m>1</span> lylw1 <span class=m>197609</span> <span class=m>1056</span> 11月 <span class=m>12</span> 15:51 layouts/partials/mathjax.html

</code></pre></td></tr></table></div></div><a class=post-dummy-target id=待完成></a><h2>待完成</h2><ul><li>RSS</li><li>站内搜索</li><li>CDN，可参考<a href=https://mogeko.me/2019/056/ target=_blank>为博客添加免费的 CDN (Cloudflare)</a></li><li>SEO</li></ul><section class=footnotes role=doc-endnotes><hr><ol><li role=doc-endnote><p><a class=post-dummy-target id=fn:1></a><a href=https://gohugo.io/templates/menu-templates/ target=_blank>菜单栏添加页面</a> <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li role=doc-endnote><p><a class=post-dummy-target id=fn:2></a><a href=https://discourse.gohugo.io/t/ordering-menu-items/1841 target=_blank>菜单栏标题排序</a> <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li role=doc-endnote><p><a class=post-dummy-target id=fn:3></a><a href=https://note.qidong.name/2017/06/24/hugo-highlight target=_blank>Hugo中添加代码高亮支持</a> <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><div class=post-copyright id=post-footer><p class=copyright-item><span>Author:&nbsp;</span>
<span>shuzang</span></p><p class=copyright-item><span>Updated on:&nbsp;</span>
<span>2020-04-05</span></p><p class=copyright-item><span>Share on:&nbsp;</span>
<span><a href="//twitter.com/share?url=https%3a%2f%2fshuzang.github.io%2f2019%2fhugo-blog-advanced-setup%2f&text=hugo%e6%90%ad%e5%bb%ba%e4%b8%aa%e4%ba%ba%e5%8d%9a%e5%ae%a23-%e8%bf%9b%e9%98%b6%e8%ae%be%e7%bd%ae&via=" target=_blank title="Share on Twitter"><i class="fab fa-twitter fa-fw"></i></a><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fshuzang.github.io%2f2019%2fhugo-blog-advanced-setup%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook-square fa-fw"></i></a><a href="//reddit.com/submit?url=https%3a%2f%2fshuzang.github.io%2f2019%2fhugo-blog-advanced-setup%2f&title=hugo%e6%90%ad%e5%bb%ba%e4%b8%aa%e4%ba%ba%e5%8d%9a%e5%ae%a23-%e8%bf%9b%e9%98%b6%e8%ae%be%e7%bd%ae" target=_blank title="Share on Reddit"><i class="fab fa-reddit fa-fw"></i></a></span></p><p class=copyright-item></p><p class=copyright-item></p></div><br><div class=post-info-more><section><span class=tag><a href=https://shuzang.github.io/tags/hugo/><i class="fas fa-tag fa-fw"></i>&nbsp;Hugo</a>&nbsp;</span></section><section><span><a href=javascript:window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=https://shuzang.github.io>Home</a></span></section></div><div class=post-nav><a href=https://shuzang.github.io/2019/%E7%A7%91%E5%AD%A6%E7%B2%BE%E7%A5%9E%E4%B8%8E%E4%BA%BA%E6%96%87%E7%B4%A0%E5%85%BB/ class=prev rel=prev title=科学精神与人文素养><i class="fas fa-angle-left fa-fw"></i>科学精神与人文素养</a>
<a href=https://shuzang.github.io/2019/research-proposal-title-select/ class=next rel=next title=研究记录3-开题确定题目>研究记录3-开题确定题目<i class="fas fa-angle-right fa-fw"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright><div class=copyright-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2018 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://shuzang.github.io/about/ target=_blank>shuzang</a> | </span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreffer">Hugo</a> & <a href=https://github.com/dillonzq/LoveIt target=_blank rel="external nofollow noopener noreffer">LoveIt</a></div></div></footer></div><a href=# class=dynamic-to-top id=dynamic-to-top data-scroll><span>&nbsp;</span></a>
<script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-209130979-1','auto');ga('set','anonymizeIp',true);ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=/js/lib/jquery/jquery.slim.min.js></script><script src=/js/lib/lazysizes/lazysizes.min.js></script><script src=/js/lib/smooth-scroll/smooth-scroll.polyfills.min.js></script><script>window.scroll=new SmoothScroll('[data-scroll]',{speed:300,speedAsDuration:true});</script><link rel=stylesheet href=/css/lib/katex/katex.min.css><script src=/js/lib/katex/katex.min.js></script><script defer src=/js/lib/katex/auto-render.min.js></script><link rel=stylesheet href=/css/lib/katex/copy-tex.min.css><script defer src=/js/lib/katex/copy-tex.min.js></script><script defer src=/js/lib/katex/mhchem.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:true},{left:"\\(",right:"\\)",display:false},{left:"\\[",right:"\\]",display:true},{left:"$",right:"$",display:false},]});});</script><script src=/js/blog.min.js></script></body></html>