<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Golang查漏补缺 - Shuzang's Blog</title><meta name=author content="Shuzang"><meta name=author-link content><meta name=description content="查漏补缺的一些问题"><meta name=keywords content="Golang"><meta itemprop=name content="Golang查漏补缺"><meta itemprop=description content="查漏补缺的一些问题"><meta itemprop=datePublished content="2020-10-01T00:00:00+00:00"><meta itemprop=dateModified content="2020-10-01T00:00:00+00:00"><meta itemprop=wordCount content="6525"><meta itemprop=image content="https://shuzang.github.io/logo.png"><meta itemprop=keywords content="Golang,"><meta property="og:title" content="Golang查漏补缺"><meta property="og:description" content="查漏补缺的一些问题"><meta property="og:type" content="article"><meta property="og:url" content="https://shuzang.github.io/2020/golang-supplement/"><meta property="og:image" content="https://shuzang.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-01T00:00:00+00:00"><meta property="article:modified_time" content="2020-10-01T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shuzang.github.io/logo.png"><meta name=twitter:title content="Golang查漏补缺"><meta name=twitter:description content="查漏补缺的一些问题"><meta name=application-name content="Shuzang's Blog"><meta name=apple-mobile-web-app-title content="Shuzang's Blog"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://shuzang.github.io/2020/golang-supplement/><link rel=prev href=https://shuzang.github.io/2020/algorithm-time-and-space-complexity/><link rel=next href=https://shuzang.github.io/2020/efficient-use-of-win10-7-windows-terminal-and-winget/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Golang查漏补缺","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/shuzang.github.io\/2020\/golang-supplement\/"},"genre":"posts","keywords":"Golang","wordcount":6525,"url":"https:\/\/shuzang.github.io\/2020\/golang-supplement\/","datePublished":"2020-10-01T00:00:00+00:00","dateModified":"2020-10-01T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Shuzang"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title="Shuzang's Blog"><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title="Shuzang's Blog" data-alt="Shuzang's Blog" class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Shuzang's Blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/collection/><i class="fa-solid fa-bookmark fa-fw fa-sm" aria-hidden=true></i> 收藏夹</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Shuzang's Blog"><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title=/images/avatar.png data-alt=/images/avatar.png class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Shuzang's Blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/collection/><i class="fa-solid fa-bookmark fa-fw fa-sm" aria-hidden=true></i> 收藏夹</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Golang查漏补缺</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title=Shuzang data-alt=Shuzang class=avatar style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;Shuzang</span></span>
<span class=post-category>收录于 <a href=/categories/%E7%88%B1%E7%BC%96%E7%A8%8B%E7%88%B1%E6%8A%80%E6%9C%AF%E7%9A%84%E5%AD%A9%E5%AD%90/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 爱编程爱技术的孩子</a></span></div><div class=post-meta-line><span title="发布于 2020-10-01 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2020-10-01>2020-10-01</time></span>&nbsp;<span title="更新于 2020-10-01 00:00:00"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2020-10-01>2020-10-01</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 6525 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 14 分钟</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#定义与声明的区别20200815>定义与声明的区别（20200815）</a></li><li><a href=#对自定义类型进行排序20190816>对自定义类型进行排序（20190816）</a><ul><li><a href=#调用sortsort>调用sort.Sort()</a></li><li><a href=#调用sortslice>调用sort.Slice()</a></li></ul></li><li><a href=#程序执行时间优化20190816>程序执行时间优化（20190816）</a><ul><li><a href=#io性能>I/O性能</a></li><li><a href=#排序优化>排序优化</a></li><li><a href=#总结>总结</a></li></ul></li><li><a href=#bufio读取的字符串无法直接进行类型20190827>bufio读取的字符串无法直接进行类型（20190827）</a></li></ul></nav></div></div><div class=content id=content><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-exclamation-triangle fa-fw" aria-hidden=true></i>警告<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>本文最后更新于 2020-10-01，文中内容可能已过时。</div></div></div><p>查漏补缺的一些问题</p><h2 id=定义与声明的区别20200815>定义与声明的区别（20200815）</h2><p>这是一直都比较纠结的一些问题，记录在这里。</p><p>变量的声明有两种情况：</p><ol><li>需要建立存储空间，这种称为定义性声明（defining declaration），简称定义</li><li>不需要建立存储空间，这种称为引用性声明（referncing declaration）</li></ol><p>所以广义的讲，声明包含定义，定义是声明的一个特例。</p><p>在 Go 中，基本变量类型在声明时都会分配存储空间并分配默认值，因此都属于定义性声明</p><div class=highlight id=id-1><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>a</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>    <span class=nx>b</span> <span class=kt>float32</span>
</span></span><span class=line><span class=cl>    <span class=nx>c</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>但是，像切片、映射、通道等，声明时不会分配存储空间，要分配空间还必须使用 make 内置函数，因此它们是引用性声明</p><div class=highlight id=id-2><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>a</span> <span class=p>[]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=nx>a</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>在 Go 的官方文档中，使用的也都是 declaration 这个词，统一用「声明」来描述</p><h2 id=对自定义类型进行排序20190816>对自定义类型进行排序（20190816）</h2><p>PAT乙级25分的题好多需要根据一个结构体类型的某个字段进行排序，第一次遇到时确实不知所措，然后查了不少解决方案，这里做个总结。</p><p>这一问题一般归结为对自定义类型排序，当然，基本指的是结构体，搜到的解决方案也基本是利用sort包。</p><p>sort包基本的排序都是针对切片的，直接调用的话能找到整型、浮点型和字符串三种类型切片的排序，最简单的整型排序如下：</p><div class=highlight id=id-3><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;sort&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>s</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>int</span><span class=p>{</span><span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>}</span> <span class=c1>// unsorted
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>sort</span><span class=p>.</span><span class=nf>Ints</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>//Output:[1 2 3 4 5 6]
</span></span></span></code></pre></td></tr></table></div></div><h3 id=调用sortsort>调用sort.Sort()</h3><p>不少文章都是通过调用sort.Sort()实现的对结构体的排序，如<a href=https://segmentfault.com/a/1190000008062661 target=_blank rel="external nofollow noopener noreferrer">youyu岁月</a>和<a href=https://segmentfault.com/a/1190000016198631 target=_blank rel="external nofollow noopener noreferrer">Donne</a>的文章就是使用的这种办法。</p><div class=highlight id=id-4><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Sort</span><span class=p>(</span><span class=nx>data</span> <span class=nx>Interface</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>Sort函数会调用一次data.Len确定长度，调用O(n*log(n))次data.Less和data.Swap进行排序。但函数不能保证排序的稳定性。而调用Sort首先需要实现一个接口。</p><div class=highlight id=id-5><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Interface</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Len is the number of elements in the collection.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Less reports whether the element with
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// index i should sort before the element with index j.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Swap swaps the elements with indexes i and j.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>只要实现了Len, Less, Swap三个方法，就能调用Sort实现对结构体的排序，而其中主要就是Less比较逻辑的实现。</p><p>先看一下sort包本身对[]int类型的排序实现</p><div class=highlight id=id-6><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 首先定义了一个[]int类型的别名IntSlice 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>IntSlice</span> <span class=p>[]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=c1>// 获取此 slice 的长度
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>IntSlice</span><span class=p>)</span> <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span>           <span class=p>{</span> <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>p</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// 比较两个元素大小 升序
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>IntSlice</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>&lt;</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// 交换数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>IntSlice</span><span class=p>)</span> <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span>      <span class=p>{</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>],</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>],</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// sort.Ints()内部调用Sort() 方法实现排序
</span></span></span><span class=line><span class=cl><span class=c1>// 注意 要先将[]int 转换为 IntSlice类型 因为此类型才实现了Interface的三个方法 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Ints</span><span class=p>(</span><span class=nx>a</span> <span class=p>[]</span><span class=kt>int</span><span class=p>)</span> <span class=p>{</span> <span class=nf>Sort</span><span class=p>(</span><span class=nf>IntSlice</span><span class=p>(</span><span class=nx>a</span><span class=p>))</span> <span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>然后我们以一个人的结构体为例，结构体中包括其姓名和年龄，按照其年龄对结构体进行排序。</p><div class=highlight id=id-7><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Person</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=nx>Age</span>  <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>ByAge</span> <span class=p>[]</span><span class=nx>Person</span></span></span></code></pre></td></tr></table></div></div><p>仿照[]int实现三个方法</p><div class=highlight id=id-8><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>ByAge</span><span class=p>)</span> <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span>           <span class=p>{</span> <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>ByAge</span><span class=p>)</span> <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span>      <span class=p>{</span> <span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>],</span> <span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>],</span> <span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>ByAge</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>Age</span> <span class=p>&lt;</span> <span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>Age</span> <span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>然后写个完整的程序测试看一看</p><div class=highlight id=id-9><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;sort&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Person</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=nx>Age</span>  <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Person</span><span class=p>)</span> <span class=nf>String</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%s: %d&#34;</span><span class=p>,</span> <span class=nx>p</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span> <span class=nx>p</span><span class=p>.</span><span class=nx>Age</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ByAge implements sort.Interface for []Person based on
</span></span></span><span class=line><span class=cl><span class=c1>// the Age field.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>ByAge</span> <span class=p>[]</span><span class=nx>Person</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>ByAge</span><span class=p>)</span> <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span>           <span class=p>{</span> <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>ByAge</span><span class=p>)</span> <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span>      <span class=p>{</span> <span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>],</span> <span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>],</span> <span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=nx>ByAge</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>Age</span> <span class=p>&lt;</span> <span class=nx>a</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>Age</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>people</span> <span class=o>:=</span> <span class=p>[]</span><span class=nx>Person</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;Bob&#34;</span><span class=p>,</span> <span class=mi>31</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;John&#34;</span><span class=p>,</span> <span class=mi>42</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;Michael&#34;</span><span class=p>,</span> <span class=mi>17</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;Jenny&#34;</span><span class=p>,</span> <span class=mi>26</span><span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>people</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=c1>// There are two ways to sort a slice. First, one can define
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=c1>// a set of methods for the slice type, as with ByAge, and
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=c1>// call sort.Sort. In this first example we use that technique.
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>sort</span><span class=p>.</span><span class=nf>Sort</span><span class=p>(</span><span class=nf>ByAge</span><span class=p>(</span><span class=nx>people</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>people</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//输出结果如下：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>[</span><span class=nx>Bob</span><span class=p>:</span> <span class=mi>31</span> <span class=nx>John</span><span class=p>:</span> <span class=mi>42</span> <span class=nx>Michael</span><span class=p>:</span> <span class=mi>17</span> <span class=nx>Jenny</span><span class=p>:</span> <span class=mi>26</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>Michael</span><span class=p>:</span> <span class=mi>17</span> <span class=nx>Jenny</span><span class=p>:</span> <span class=mi>26</span> <span class=nx>Bob</span><span class=p>:</span> <span class=mi>31</span> <span class=nx>John</span><span class=p>:</span> <span class=mi>42</span><span class=p>]</span></span></span></code></pre></td></tr></table></div></div><p>如果要对某个结构体中多个字段进行排序，可以利用嵌套结构体实现，如下面的代码，该代码来自<a href=https://segmentfault.com/a/1190000008062661 target=_blank rel="external nofollow noopener noreferrer">youyu岁月</a></p><div class=highlight id=id-10><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;sort&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Person</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>    <span class=nx>Age</span>  <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Persons</span> <span class=p>[]</span><span class=nx>Person</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Len()方法和Swap()方法不用变化
</span></span></span><span class=line><span class=cl><span class=c1>// 获取此 slice 的长度
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Persons</span><span class=p>)</span> <span class=nf>Len</span><span class=p>()</span> <span class=kt>int</span> <span class=p>{</span> <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>p</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 交换数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>Persons</span><span class=p>)</span> <span class=nf>Swap</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>],</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>p</span><span class=p>[</span><span class=nx>j</span><span class=p>],</span> <span class=nx>p</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 嵌套结构体  将继承 Person 的所有属性和方法
</span></span></span><span class=line><span class=cl><span class=c1>// 所以相当于SortByName 也实现了 Len() 和 Swap() 方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>SortByName</span> <span class=kd>struct</span><span class=p>{</span> <span class=nx>Persons</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 根据元素的姓名长度降序排序 （此处按照自己的业务逻辑写）
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>SortByName</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=nx>p</span><span class=p>.</span><span class=nx>Persons</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>Name</span><span class=p>)</span> <span class=p>&gt;</span> <span class=nb>len</span><span class=p>(</span><span class=nx>p</span><span class=p>.</span><span class=nx>Persons</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>Name</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>SortByAge</span> <span class=kd>struct</span><span class=p>{</span> <span class=nx>Persons</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 根据元素的年龄降序排序 （此处按照自己的业务逻辑写）
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>p</span> <span class=nx>SortByAge</span><span class=p>)</span> <span class=nf>Less</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>p</span><span class=p>.</span><span class=nx>Persons</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>Age</span> <span class=p>&gt;</span> <span class=nx>p</span><span class=p>.</span><span class=nx>Persons</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>Age</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>persons</span> <span class=o>:=</span> <span class=nx>Persons</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>Name</span><span class=p>:</span> <span class=s>&#34;test123&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>Age</span><span class=p>:</span>  <span class=mi>20</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>Name</span><span class=p>:</span> <span class=s>&#34;test1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>Age</span><span class=p>:</span>  <span class=mi>22</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>Name</span><span class=p>:</span> <span class=s>&#34;test12&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>Age</span><span class=p>:</span>  <span class=mi>21</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;排序前&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>person</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>persons</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>person</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span> <span class=s>&#34;:&#34;</span><span class=p>,</span> <span class=nx>person</span><span class=p>.</span><span class=nx>Age</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>sort</span><span class=p>.</span><span class=nf>Sort</span><span class=p>(</span><span class=nx>SortByName</span><span class=p>{</span><span class=nx>persons</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;排序后&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>person</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>persons</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>person</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span> <span class=s>&#34;:&#34;</span><span class=p>,</span> <span class=nx>person</span><span class=p>.</span><span class=nx>Age</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><h3 id=调用sortslice>调用sort.Slice()</h3><p>更简单的是直接调用sort.Slice()，当然，由于golang官方的包说明稳定没法访问，一直查看的是国内的<a href=https://studygolang.com/pkgdoc target=_blank rel="external nofollow noopener noreferrer">标准库说明文档</a>，完全没有意识到它已经落后了，可能许久未更新，完全没有提到sort包中的Slice函数，但利用这个函数进行自定义类型排序是真有用，还是翻出去看<a href=https://golang.org/pkg/sort/ target=_blank rel="external nofollow noopener noreferrer">官方说明</a>比较好。</p><div class=highlight id=id-11><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Slice</span><span class=p>(</span><span class=nx>slice</span> <span class=kd>interface</span><span class=p>{},</span> <span class=nx>less</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>sort.Slice()以给定的比较函数排序切片，但并不保证排序的稳定性，想要稳定性，可以调用sort.SliceStable()。因为切片类型的广泛使用，调用sort.Slice()能满足大部分的需求，同时减少了自己实现接口需要实现的Len和Swap两个方法，写法上也更加精炼。一个例子如下：</p><div class=highlight id=id-12><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;sort&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>people</span> <span class=o>:=</span> <span class=p>[]</span><span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>Name</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl>		<span class=nx>Age</span>  <span class=kt>int</span>
</span></span><span class=line><span class=cl>	<span class=p>}{</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;Gopher&#34;</span><span class=p>,</span> <span class=mi>7</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;Alice&#34;</span><span class=p>,</span> <span class=mi>55</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;Vera&#34;</span><span class=p>,</span> <span class=mi>24</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span><span class=s>&#34;Bob&#34;</span><span class=p>,</span> <span class=mi>75</span><span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>sort</span><span class=p>.</span><span class=nf>Slice</span><span class=p>(</span><span class=nx>people</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>people</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>Name</span> <span class=p>&lt;</span> <span class=nx>people</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>Name</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;By name:&#34;</span><span class=p>,</span> <span class=nx>people</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sort</span><span class=p>.</span><span class=nf>Slice</span><span class=p>(</span><span class=nx>people</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span> <span class=k>return</span> <span class=nx>people</span><span class=p>[</span><span class=nx>i</span><span class=p>].</span><span class=nx>Age</span> <span class=p>&gt;</span> <span class=nx>people</span><span class=p>[</span><span class=nx>j</span><span class=p>].</span><span class=nx>Age</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;By age:&#34;</span><span class=p>,</span> <span class=nx>people</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>//Output
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>By</span> <span class=nx>name</span><span class=p>:</span> <span class=p>[{</span><span class=nx>Alice</span> <span class=mi>55</span><span class=p>}</span> <span class=p>{</span><span class=nx>Bob</span> <span class=mi>75</span><span class=p>}</span> <span class=p>{</span><span class=nx>Gopher</span> <span class=mi>7</span><span class=p>}</span> <span class=p>{</span><span class=nx>Vera</span> <span class=mi>24</span><span class=p>}]</span>
</span></span><span class=line><span class=cl><span class=nx>By</span> <span class=nx>age</span><span class=p>:</span> <span class=p>[{</span><span class=nx>Bob</span> <span class=mi>75</span><span class=p>}</span> <span class=p>{</span><span class=nx>Alice</span> <span class=mi>55</span><span class=p>}</span> <span class=p>{</span><span class=nx>Vera</span> <span class=mi>24</span><span class=p>}</span> <span class=p>{</span><span class=nx>Gopher</span> <span class=mi>7</span><span class=p>}]</span></span></span></code></pre></td></tr></table></div></div><p>值得注意的一点是，这里的排序结果依赖于less函数的内容，并不是默认升序，如上述程序。</p><h2 id=程序执行时间优化20190816>程序执行时间优化（20190816）</h2><p>最近在刷PAT乙级的题，因为PAT考点一般只提供C/C++或Java环境的缘故，网上找到的90%都是C++代码，剩下的又绝大部分是Java，还有一小部分Python，其他语言还真没看到。我用go来刷题，遇到很多问题还真的只能自己慢慢琢磨，倒也很是能锻炼人。</p><p>在PAT乙级1015（德才论）和1018（锤子剪刀布）两题中，历经万难，总有测试点显示“运行超时”。仔细一想，不应该啊，go的编译执行速度应该算比较快了，比C++应该差不了多少，这也是go的优点，怎么就运行超时呢，前两天写的时候没想出来，就这么放下了，但这两天心里一直惦记着。知道今天，想到一件事，1015（德才论）还好说，涉及排序，可能算法不够好。1018（锤子剪刀布）一题中也没排序，这么就运行超时了，于是去网上找到了<a href=https://blog.csdn.net/M1M1M16/article/details/79535286 target=_blank rel="external nofollow noopener noreferrer">Python解法</a>，竟然过了，彻底陷入了迷惘，go的速度连Python都比不过了吗，肯定有没注意到的地方，于是开始了执行时间优化之旅。</p><p>1018（锤子剪刀布）的原始代码如下</p><div class=highlight id=id-13><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=cm>/*题目说明
</span></span></span><span class=line><span class=cl><span class=cm>大家应该都会玩“锤子剪刀布”的游戏,现给出两人的交锋记录，请统计双方的胜、平、负次数，并且给出双方分别出什么手势的胜算最大。
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>输入格式：
</span></span></span><span class=line><span class=cl><span class=cm>输入第 1 行给出正整数 N（≤10^5），即双方交锋的次数。随后 N 行，每行给出一次交锋的信息，即甲、乙双方同时给出的的手势。C 代表“锤子”、J 代表“剪刀”、B 代表“布”，第 1 个字母代表甲方，第 2 个代表乙方，中间有 1 个空格。
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>输出格式：
</span></span></span><span class=line><span class=cl><span class=cm>输出第 1、2 行分别给出甲、乙的胜、平、负次数，数字间以 1 个空格分隔。第 3 行给出两个字母，分别代表甲、乙获胜次数最多的手势，中间有 1 个空格。如果解不唯一，则输出按字母序最小的解。
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>输入样例：
</span></span></span><span class=line><span class=cl><span class=cm>10
</span></span></span><span class=line><span class=cl><span class=cm>C J
</span></span></span><span class=line><span class=cl><span class=cm>J B
</span></span></span><span class=line><span class=cl><span class=cm>C B
</span></span></span><span class=line><span class=cl><span class=cm>B B
</span></span></span><span class=line><span class=cl><span class=cm>B C
</span></span></span><span class=line><span class=cl><span class=cm>C C
</span></span></span><span class=line><span class=cl><span class=cm>C B
</span></span></span><span class=line><span class=cl><span class=cm>J B
</span></span></span><span class=line><span class=cl><span class=cm>B C
</span></span></span><span class=line><span class=cl><span class=cm>J J
</span></span></span><span class=line><span class=cl><span class=cm>输出样例：
</span></span></span><span class=line><span class=cl><span class=cm>5 3 2
</span></span></span><span class=line><span class=cl><span class=cm>2 3 5
</span></span></span><span class=line><span class=cl><span class=cm>B B
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>时间限制: 200 ms
</span></span></span><span class=line><span class=cl><span class=cm>内存限制: 64 MB
</span></span></span><span class=line><span class=cl><span class=cm>代码长度限制: 16 KB
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>findMax</span><span class=p>(</span><span class=nx>a</span> <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>max</span><span class=p>,</span> <span class=nx>index</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>a</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=nx>v</span> <span class=p>&gt;</span> <span class=nx>max</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>max</span> <span class=p>=</span> <span class=nx>v</span>
</span></span><span class=line><span class=cl>			<span class=nx>index</span> <span class=p>=</span> <span class=nx>k</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>index</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=nx>n</span>             <span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>jiawin</span><span class=p>,</span> <span class=nx>yiwin</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>jia</span><span class=p>,</span> <span class=nx>yi</span>       <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>str</span>           <span class=p>=</span> <span class=s>&#34;BCJ&#34;</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Scanln</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>n</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=kd>var</span> <span class=nx>t</span> <span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=kt>string</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Scanln</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=o>&amp;</span><span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;B&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;C&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>jia</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;B&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;J&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>yi</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;C&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;B&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>yi</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;C&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;J&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>jia</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;J&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;B&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>jia</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;J&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;C&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>yi</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>jiawin</span> <span class=p>=</span> <span class=nx>jia</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=nx>jia</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=nx>jia</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=nx>yiwin</span> <span class=p>=</span> <span class=nx>yi</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=nx>yi</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=nx>yi</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>jiawin</span><span class=p>,</span> <span class=nx>n</span><span class=o>-</span><span class=nx>jiawin</span><span class=o>-</span><span class=nx>yiwin</span><span class=p>,</span> <span class=nx>yiwin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>yiwin</span><span class=p>,</span> <span class=nx>n</span><span class=o>-</span><span class=nx>jiawin</span><span class=o>-</span><span class=nx>yiwin</span><span class=p>,</span> <span class=nx>jiawin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%c %c&#34;</span><span class=p>,</span> <span class=nx>str</span><span class=p>[</span><span class=nf>findMax</span><span class=p>(</span><span class=nx>jia</span><span class=p>)],</span> <span class=nx>str</span><span class=p>[</span><span class=nf>findMax</span><span class=p>(</span><span class=nx>yi</span><span class=p>)])</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>检查了半天实在找不到什么地方可以优化的，时间复杂度的大头是for循环，但能迁移出来的代码都已经迁移出来了，结果始终如下图</p><p><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1018%e5%8e%9f%e5%a7%8b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png srcset="https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1018%e5%8e%9f%e5%a7%8b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1018%e5%8e%9f%e5%a7%8b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png 1.5x, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1018%e5%8e%9f%e5%a7%8b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png 2x" sizes=auto data-title=1018原始代码提交结果 data-alt=1018原始代码提交结果 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h3 id=io性能>I/O性能</h3><p>在google上搜go程序的执行时间怎么优化，最终在<a href=https://groups.google.com/forum/#!topic/golang-nuts/W08rFBcHKbc target=_blank rel="external nofollow noopener noreferrer">golang-nuts讨论组</a>发现一个靠谱的问题以及有用的回答。</p><p><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_%e4%bb%a3%e7%a0%81io%e4%bc%98%e5%8c%96.png srcset="https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_%e4%bb%a3%e7%a0%81io%e4%bc%98%e5%8c%96.png, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_%e4%bb%a3%e7%a0%81io%e4%bc%98%e5%8c%96.png 1.5x, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_%e4%bb%a3%e7%a0%81io%e4%bc%98%e5%8c%96.png 2x" sizes=auto data-title=go代码io优化 data-alt=go代码io优化 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>原来是I/O读写的问题，fmt包的读写这么不省心吗，怪不得，1015和1015如果测试点是边界值的话，循环要执行10000次，I/O读写出了问题，不超时才怪。看作者在之后的讨论中说他的程序“On my system: C runs in ~50ms, python in ~125ms and go in ~450ms.”也难怪Python都能通过，go通过不了了。</p><p>按照其他人的回答，使用bufio包替换了for循环中的fmt进行读取，改进的代码如下：</p><div class=highlight id=id-14><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;bufio&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;strings&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>findMax</span><span class=p>(</span><span class=nx>a</span> <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>max</span><span class=p>,</span> <span class=nx>index</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>a</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=nx>v</span> <span class=p>&gt;</span> <span class=nx>max</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>max</span> <span class=p>=</span> <span class=nx>v</span>
</span></span><span class=line><span class=cl>			<span class=nx>index</span> <span class=p>=</span> <span class=nx>k</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>index</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=nx>n</span>             <span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>jiawin</span><span class=p>,</span> <span class=nx>yiwin</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>jia</span><span class=p>,</span> <span class=nx>yi</span>       <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>str</span>           <span class=p>=</span> <span class=s>&#34;BCJ&#34;</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=c1>// 用fmt读取输入会有测试点超时
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>inputReader</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewReader</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Scanln</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>n</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>s</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>inputReader</span><span class=p>.</span><span class=nf>ReadString</span><span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>t</span> <span class=o>:=</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Fields</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;B&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;C&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>jia</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;B&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;J&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>yi</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;C&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;B&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>yi</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;C&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;J&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>jia</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;J&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;B&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>jia</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;J&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s>&#34;C&#34;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>yi</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>jiawin</span> <span class=p>=</span> <span class=nx>jia</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=nx>jia</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=nx>jia</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=nx>yiwin</span> <span class=p>=</span> <span class=nx>yi</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=nx>yi</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=nx>yi</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>jiawin</span><span class=p>,</span> <span class=nx>n</span><span class=o>-</span><span class=nx>jiawin</span><span class=o>-</span><span class=nx>yiwin</span><span class=p>,</span> <span class=nx>yiwin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>yiwin</span><span class=p>,</span> <span class=nx>n</span><span class=o>-</span><span class=nx>jiawin</span><span class=o>-</span><span class=nx>yiwin</span><span class=p>,</span> <span class=nx>jiawin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%c %c&#34;</span><span class=p>,</span> <span class=nx>str</span><span class=p>[</span><span class=nf>findMax</span><span class=p>(</span><span class=nx>jia</span><span class=p>)],</span> <span class=nx>str</span><span class=p>[</span><span class=nf>findMax</span><span class=p>(</span><span class=nx>yi</span><span class=p>)])</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>果然通过了，如下图，最后一个测试点28ms,一想想题目时间限制是200ms，从超时到28，这提升，看起来1015的德才论一题也有救了。</p><p><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1018%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png srcset="https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1018%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1018%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png 1.5x, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1018%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png 2x" sizes=auto data-title=1018改进代码提交结果 data-alt=1018改进代码提交结果 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h3 id=排序优化>排序优化</h3><p>1018德才论的原始代码如下：</p><div class=highlight id=id-15><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>宋代史学家司马光在《资治通鉴》中有一段著名的“德才论”：“是故才德全尽谓之圣人，才德兼亡谓之愚人，德胜才谓之君子，才胜德谓之小人。凡取人之术，苟不得圣人，君子而与之，与其得小人，不若得愚人。”
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>现给出一批考生的德才分数，请根据司马光的理论给出录取排名。
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>输入格式：
</span></span></span><span class=line><span class=cl><span class=cm>输入第一行给出 3 个正整数，分别为：N（≤10^5），即考生总数；L（≥60），为录取最低分数线，即德分和才分均不低于 L 的考生才有资格被考虑录取；H（&lt;100），为优先录取线——德分和才分均不低于此线的被定义为“才德全尽”，此类考生按德才总分从高到低排序；才分不到但德分到线的一类考生属于“德胜才”，也按总分排序，但排在第一类考生之后；德才分均低于 H，但是德分不低于才分的考生属于“才德兼亡”但尚有“德胜才”者，按总分排序，但排在第二类考生之后；其他达到最低线 L 的考生也按总分排序，但排在第三类考生之后。
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>随后 N 行，每行给出一位考生的信息，包括：准考证号 德分 才分，其中准考证号为 8 位整数，德才分为区间 [0, 100] 内的整数。数字间以空格分隔。
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>输出格式：
</span></span></span><span class=line><span class=cl><span class=cm>输出第一行首先给出达到最低分数线的考生人数 M，随后 M 行，每行按照输入格式输出一位考生的信息，考生按输入中说明的规则从高到低排序。当某类考生中有多人总分相同时，按其德分降序排列；若德分也并列，则按准考证号的升序输出。
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>输入样例：
</span></span></span><span class=line><span class=cl><span class=cm>14 60 80
</span></span></span><span class=line><span class=cl><span class=cm>10000001 64 90
</span></span></span><span class=line><span class=cl><span class=cm>10000002 90 60
</span></span></span><span class=line><span class=cl><span class=cm>10000011 85 80
</span></span></span><span class=line><span class=cl><span class=cm>10000003 85 80
</span></span></span><span class=line><span class=cl><span class=cm>10000004 80 85
</span></span></span><span class=line><span class=cl><span class=cm>10000005 82 77
</span></span></span><span class=line><span class=cl><span class=cm>10000006 83 76
</span></span></span><span class=line><span class=cl><span class=cm>10000007 90 78
</span></span></span><span class=line><span class=cl><span class=cm>10000008 75 79
</span></span></span><span class=line><span class=cl><span class=cm>10000009 59 90
</span></span></span><span class=line><span class=cl><span class=cm>10000010 88 45
</span></span></span><span class=line><span class=cl><span class=cm>10000012 80 100
</span></span></span><span class=line><span class=cl><span class=cm>10000013 90 99
</span></span></span><span class=line><span class=cl><span class=cm>10000014 66 60
</span></span></span><span class=line><span class=cl><span class=cm>输出样例：
</span></span></span><span class=line><span class=cl><span class=cm>12
</span></span></span><span class=line><span class=cl><span class=cm>10000013 90 99
</span></span></span><span class=line><span class=cl><span class=cm>10000012 80 100
</span></span></span><span class=line><span class=cl><span class=cm>10000003 85 80
</span></span></span><span class=line><span class=cl><span class=cm>10000011 85 80
</span></span></span><span class=line><span class=cl><span class=cm>10000004 80 85
</span></span></span><span class=line><span class=cl><span class=cm>10000007 90 78
</span></span></span><span class=line><span class=cl><span class=cm>10000006 83 76
</span></span></span><span class=line><span class=cl><span class=cm>10000005 82 77
</span></span></span><span class=line><span class=cl><span class=cm>10000002 90 60
</span></span></span><span class=line><span class=cl><span class=cm>10000014 66 60
</span></span></span><span class=line><span class=cl><span class=cm>10000008 75 79
</span></span></span><span class=line><span class=cl><span class=cm>10000001 64 90
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>时间限制: 400 ms
</span></span></span><span class=line><span class=cl><span class=cm>内存限制: 64 MB
</span></span></span><span class=line><span class=cl><span class=cm>代码长度限制: 16 KB
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//L is student level weight
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>const</span> <span class=nx>L</span> <span class=p>=</span> <span class=mi>100000000000000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//S is student grade weight
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>const</span> <span class=nx>S</span> <span class=p>=</span> <span class=mi>100000000000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//D is student id weight
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>const</span> <span class=nx>D</span> <span class=p>=</span> <span class=mi>100000000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=nx>n</span><span class=p>,</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>h</span>           <span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>id</span><span class=p>,</span> <span class=nx>de</span><span class=p>,</span> <span class=nx>cai</span>       <span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>sum</span><span class=p>,</span> <span class=nx>level</span><span class=p>,</span> <span class=nx>count</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>student</span>           <span class=p>[]</span><span class=kt>int64</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Scanln</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>n</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>l</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>n</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Scanln</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>id</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>de</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>cai</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>l</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=o>&gt;=</span> <span class=nx>l</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>sum</span> <span class=p>=</span> <span class=nx>de</span> <span class=o>+</span> <span class=nx>cai</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=o>&gt;=</span> <span class=nx>h</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=p>&lt;</span> <span class=nx>h</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>de</span> <span class=p>&lt;</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=p>&lt;</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>cai</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nx>tmp</span> <span class=o>:=</span> <span class=nx>level</span><span class=o>*</span><span class=nx>L</span> <span class=o>+</span> <span class=nx>sum</span><span class=o>*</span><span class=nx>S</span> <span class=o>+</span> <span class=nx>de</span><span class=o>*</span><span class=nx>D</span> <span class=o>+</span> <span class=nx>D</span> <span class=o>-</span> <span class=nx>id</span>
</span></span><span class=line><span class=cl>			<span class=nx>student</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>student</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nx>tmp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>			<span class=nx>count</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>count</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>for</span> <span class=nx>j</span> <span class=o>:=</span> <span class=nx>i</span><span class=p>;</span> <span class=nx>j</span> <span class=p>&lt;</span> <span class=nx>count</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>&lt;</span> <span class=nx>student</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>tmp</span> <span class=o>:=</span> <span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>				<span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>=</span> <span class=nx>student</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>				<span class=nx>student</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span> <span class=p>=</span> <span class=nx>tmp</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>count</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>id</span> <span class=p>=</span> <span class=nb>int</span><span class=p>(</span><span class=nx>D</span> <span class=o>-</span> <span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span><span class=o>%</span><span class=nx>D</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>sum</span> <span class=p>=</span> <span class=nb>int</span><span class=p>(</span><span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>%</span> <span class=nx>L</span> <span class=o>/</span> <span class=nx>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>de</span> <span class=p>=</span> <span class=nb>int</span><span class=p>(</span><span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>%</span> <span class=nx>S</span> <span class=o>/</span> <span class=nx>D</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>cai</span> <span class=p>=</span> <span class=nx>sum</span> <span class=o>-</span> <span class=nx>de</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>id</span><span class=p>,</span> <span class=nx>de</span><span class=p>,</span> <span class=nx>cai</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>其实这已经是优化过了，之前写的时候用的正规的结构体的思路，为了优化，改成这种用权重的剑走偏锋的思路。但提交结果没有丝毫改变，超时就是超时。</p><p><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e5%8e%9f%e5%a7%8b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png srcset="https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e5%8e%9f%e5%a7%8b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e5%8e%9f%e5%a7%8b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png 1.5x, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e5%8e%9f%e5%a7%8b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c.png 2x" sizes=auto data-title=1015原始代码提交结果 data-alt=1015原始代码提交结果 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>改呗，第一个for循环里的输入改成用缓冲区的bufio，按1018的提升幅度，估计可以。改进部分的代码如下。</p><div class=highlight id=id-16><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Scanln</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>n</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>l</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>inputReader</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewReader</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>n</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>s</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>inputReader</span><span class=p>.</span><span class=nf>ReadString</span><span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>t</span> <span class=o>:=</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Fields</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>id</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>		<span class=nx>de</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>		<span class=nx>cai</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>t</span><span class=p>[</span><span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>		<span class=c1>//fmt.Scanln(&amp;id, &amp;de, &amp;cai)
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>if</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>l</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=o>&gt;=</span> <span class=nx>l</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>sum</span> <span class=p>=</span> <span class=nx>de</span> <span class=o>+</span> <span class=nx>cai</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=o>&gt;=</span> <span class=nx>h</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=p>&lt;</span> <span class=nx>h</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>de</span> <span class=p>&lt;</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=p>&lt;</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>cai</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nx>tmp</span> <span class=o>:=</span> <span class=nx>level</span><span class=o>*</span><span class=nx>L</span> <span class=o>+</span> <span class=nx>sum</span><span class=o>*</span><span class=nx>S</span> <span class=o>+</span> <span class=nx>de</span><span class=o>*</span><span class=nx>D</span> <span class=o>+</span> <span class=nx>D</span> <span class=o>-</span> <span class=nx>id</span>
</span></span><span class=line><span class=cl>			<span class=nx>student</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>student</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nx>tmp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>			<span class=nx>count</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>第2个测试点过了，但第3，第4个还是没过。</p><p><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c1.png srcset="https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c1.png, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c1.png 1.5x, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c1.png 2x" sizes=auto data-title=1015改进代码提交结果1 data-alt=1015改进代码提交结果1 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>回去一看代码，得，最后一个for循环有输出，用fmt又费不少时间，继续改缓冲区，正巧这时候查到了<a href=https://zhuanlan.zhihu.com/p/73690883 target=_blank rel="external nofollow noopener noreferrer">GO语言基础进阶教程：bufio包</a>，分析了bufio提升文件读写效率的原因，于是参考说明改了输出，如下：</p><div class=highlight id=id-17><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>buf</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewWriter</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>count</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>id</span> <span class=p>=</span> <span class=nb>int</span><span class=p>(</span><span class=nx>D</span> <span class=o>-</span> <span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span><span class=o>%</span><span class=nx>D</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>sum</span> <span class=p>=</span> <span class=nb>int</span><span class=p>(</span><span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>%</span> <span class=nx>L</span> <span class=o>/</span> <span class=nx>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>de</span> <span class=p>=</span> <span class=nb>int</span><span class=p>(</span><span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>%</span> <span class=nx>S</span> <span class=o>/</span> <span class=nx>D</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>cai</span> <span class=p>=</span> <span class=nx>sum</span> <span class=o>-</span> <span class=nx>de</span>
</span></span><span class=line><span class=cl>		<span class=nx>buf</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%d %d %d\n&#34;</span><span class=p>,</span> <span class=nx>id</span><span class=p>,</span> <span class=nx>de</span><span class=p>,</span> <span class=nx>cai</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>buf</span><span class=p>.</span><span class=nf>Flush</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><p>没怎么起作用，只是第2个测试点从290ms提升到了272ms。那就只能改排序了，程序里自己写了两层循环，本来以为能过，看来还是得用sort包。改进的完整代码如下：</p><div class=highlight id=id-18><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;bufio&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;sort&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;strconv&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;strings&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//L is student level weight
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>const</span> <span class=nx>L</span> <span class=p>=</span> <span class=mi>100000000000000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//S is student grade weight
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>const</span> <span class=nx>S</span> <span class=p>=</span> <span class=mi>100000000000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//D is student id weight
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>const</span> <span class=nx>D</span> <span class=p>=</span> <span class=mi>100000000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=nx>n</span><span class=p>,</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>h</span>           <span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>id</span><span class=p>,</span> <span class=nx>de</span><span class=p>,</span> <span class=nx>cai</span>       <span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>sum</span><span class=p>,</span> <span class=nx>level</span><span class=p>,</span> <span class=nx>count</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl>		<span class=nx>student</span>           <span class=p>[]</span><span class=kt>int64</span>
</span></span><span class=line><span class=cl>	<span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Scanln</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>n</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>l</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>h</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>inputReader</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewReader</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>n</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>s</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>inputReader</span><span class=p>.</span><span class=nf>ReadString</span><span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>t</span> <span class=o>:=</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Fields</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>id</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>		<span class=nx>de</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>t</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>		<span class=nx>cai</span><span class=p>,</span> <span class=nx>_</span> <span class=p>=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nb>string</span><span class=p>(</span><span class=nx>t</span><span class=p>[</span><span class=mi>2</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>		<span class=c1>//fmt.Scanln(&amp;id, &amp;de, &amp;cai)
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>if</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>l</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=o>&gt;=</span> <span class=nx>l</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>sum</span> <span class=p>=</span> <span class=nx>de</span> <span class=o>+</span> <span class=nx>cai</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=o>&gt;=</span> <span class=nx>h</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=p>&lt;</span> <span class=nx>h</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=nx>de</span> <span class=p>&lt;</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>cai</span> <span class=p>&lt;</span> <span class=nx>h</span> <span class=o>&amp;&amp;</span> <span class=nx>de</span> <span class=o>&gt;=</span> <span class=nx>cai</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>level</span> <span class=p>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nx>tmp</span> <span class=o>:=</span> <span class=nx>level</span><span class=o>*</span><span class=nx>L</span> <span class=o>+</span> <span class=nx>sum</span><span class=o>*</span><span class=nx>S</span> <span class=o>+</span> <span class=nx>de</span><span class=o>*</span><span class=nx>D</span> <span class=o>+</span> <span class=nx>D</span> <span class=o>-</span> <span class=nx>id</span>
</span></span><span class=line><span class=cl>			<span class=nx>student</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>student</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nx>tmp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>			<span class=nx>count</span><span class=o>++</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>sort</span><span class=p>.</span><span class=nf>SliceStable</span><span class=p>(</span><span class=nx>student</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>bool</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>&gt;</span> <span class=nx>student</span><span class=p>[</span><span class=nx>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>buf</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewWriter</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>count</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>id</span> <span class=p>=</span> <span class=nb>int</span><span class=p>(</span><span class=nx>D</span> <span class=o>-</span> <span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span><span class=o>%</span><span class=nx>D</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>sum</span> <span class=p>=</span> <span class=nb>int</span><span class=p>(</span><span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>%</span> <span class=nx>L</span> <span class=o>/</span> <span class=nx>S</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>de</span> <span class=p>=</span> <span class=nb>int</span><span class=p>(</span><span class=nx>student</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>%</span> <span class=nx>S</span> <span class=o>/</span> <span class=nx>D</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>cai</span> <span class=p>=</span> <span class=nx>sum</span> <span class=o>-</span> <span class=nx>de</span>
</span></span><span class=line><span class=cl>		<span class=nx>buf</span><span class=p>.</span><span class=nf>WriteString</span><span class=p>(</span><span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%d %d %d\n&#34;</span><span class=p>,</span> <span class=nx>id</span><span class=p>,</span> <span class=nx>de</span><span class=p>,</span> <span class=nx>cai</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>buf</span><span class=p>.</span><span class=nf>Flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>这次终于通过了,第2个测试点竟然提升到了81ms，第3和第4个测试点也在200ms左右，没有卡在400ms的临界线，看起来还可以。</p><p><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c2.png srcset="https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c2.png, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c2.png 1.5x, https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190816_1015%e6%94%b9%e8%bf%9b%e4%bb%a3%e7%a0%81%e6%8f%90%e4%ba%a4%e7%bb%93%e6%9e%9c2.png 2x" sizes=auto data-title=1015改进代码提交结果2 data-alt=1015改进代码提交结果2 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h3 id=总结>总结</h3><ol><li>涉及大量数据的读写时，利用bufio包通过缓冲区进行读写比fmt要快的多。</li><li>排序的代码可以调用sort包，不仅仅是自己写两层循环排序的问题，不是必要的情况下，同样的排序算法，自己写的很难说比得过封装好的。更何况，无论是哪种语言，调用的执行排序算法的包其实不是单纯执行快排或堆排序等比较快的排序算法，而是根据输入在调整的，所以不管为了时间性能还是写的方便，直接调用sort包完事儿。</li></ol><h2 id=bufio读取的字符串无法直接进行类型20190827>bufio读取的字符串无法直接进行类型（20190827）</h2><p>如下列代码，在使用bufio包中的ReadString读取字符串之后，这个字符串无法进行类型转换，每次使用strconv.Atoi()函数返回值均为0。</p><div class=highlight id=id-19><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>inputReader</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewReader</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdin</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Please input a number&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>t</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>inputReader</span><span class=p>.</span><span class=nf>ReadString</span><span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;can&#39;t read number!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;the number is&#34;</span><span class=p>,</span> <span class=nx>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>num</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nx>t</span><span class=p>);</span> <span class=nx>ok</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;convert to int error&#34;</span><span class=p>,</span> <span class=nx>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//input
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>25</span>
</span></span><span class=line><span class=cl><span class=c1>//output
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Please</span> <span class=nx>input</span> <span class=nx>a</span> <span class=nx>number</span>
</span></span><span class=line><span class=cl><span class=nx>the</span> <span class=nx>number</span> <span class=nx>is</span> <span class=mi>25</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>convert</span> <span class=nx>to</span> <span class=kt>int</span> <span class=kt>error</span> <span class=mi>0</span></span></span></code></pre></td></tr></table></div></div><p>因为这种写法其实经常遇到，之前编程的时候遇到这种情况没怎么注意，以为是算法问题，就换思路写了，直到这次只能用这种思路，才发现这里出现了问题。</p><p><a href=https://stackoverflow.com/questions/31464142/what-is-wrong-with-this-go-switch-statement target=_blank rel="external nofollow noopener noreferrer">Stackoverflow</a>上相关的问题回答说这是因为ReadString读取字符串成功后会把<code>'\n'</code>一起加在字符串后面。查找包说明发现函数的原型和解释如下</p><div class=highlight id=id-20><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>b</span> <span class=o>*</span><span class=nx>Reader</span><span class=p>)</span> <span class=nf>ReadString</span><span class=p>(</span><span class=nx>delim</span> <span class=kt>byte</span><span class=p>)</span> <span class=p>(</span><span class=kt>string</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=cm>/* ReadString reads until the first occurrence of delim in the input, returning a string containing the data up to and including the delimiter. If ReadString encounters an error before finding a delimiter, it returns the data read before the error and the error itself (often io.EOF). ReadString returns err != nil if and only if the returned data does not end in delim. For simple uses, a Scanner may be more convenient.
</span></span></span><span class=line><span class=cl><span class=cm>*/</span></span></span></code></pre></td></tr></table></div></div><p>这种情况给出的建议是利用strings.Trim&mldr;系列去除末尾添加的字符，比如，对上面的错误程序</p><div class=highlight id=id-21><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>inputReader</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewReader</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdin</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Please input a number&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>t</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>inputReader</span><span class=p>.</span><span class=nf>ReadString</span><span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;can&#39;t read number!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;the number is&#34;</span><span class=p>,</span> <span class=nx>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>t</span> <span class=p>=</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>TrimRight</span><span class=p>(</span><span class=nx>t</span><span class=p>,</span> <span class=s>&#34;\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>num</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>Atoi</span><span class=p>(</span><span class=nx>t</span><span class=p>);</span> <span class=nx>ok</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;convert succeed&#34;</span><span class=p>,</span> <span class=nx>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>//input 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>25</span>
</span></span><span class=line><span class=cl><span class=c1>//output
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Please</span> <span class=nx>input</span> <span class=nx>a</span> <span class=nx>number</span>
</span></span><span class=line><span class=cl><span class=nx>the</span> <span class=nx>number</span> <span class=nx>is</span> <span class=mi>25</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>convert</span> <span class=nx>succeed</span> <span class=mi>25</span></span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2020-10-01 00:00:00">更新于 2020-10-01&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/2020/golang-supplement/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Pocket" data-sharer=pocket data-url=https://shuzang.github.io/2020/golang-supplement/><i class="fa-brands fa-get-pocket fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://shuzang.github.io/2020/golang-supplement/ data-title=Golang查漏补缺><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/golang/ class=post-tag>Golang</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2020/algorithm-time-and-space-complexity/ class=post-nav-item rel=prev title=算法-时间复杂度和空间复杂度><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>算法-时间复杂度和空间复杂度</a>
<a href=/2020/efficient-use-of-win10-7-windows-terminal-and-winget/ class=post-nav-item rel=next title=win10效率优化7-终端和winget>win10效率优化7-终端和winget<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-reward><div class=comment></div><input type=checkbox class=reward-input name=reward id=fi-reward hidden>
<label class=reward-button for=fi-reward>赞赏</label><div class=reward-ways data-mode=static><div><img loading=lazy src=/images/alipay.png srcset="/images/alipay.png, /images/alipay.png 1.5x, /images/alipay.png 2x" sizes=auto data-title="Shuzang 支付宝" data-alt="Shuzang 支付宝" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>支付宝</span></div><div><img loading=lazy src=/images/wechatpay.png srcset="/images/wechatpay.png, /images/wechatpay.png 1.5x, /images/wechatpay.png 2x" sizes=auto data-title="Shuzang 微信" data-alt="Shuzang 微信" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>微信</span></div></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom">Hava a great day !</div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2018 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=/>Shuzang</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><a href=https://github.com/shuzang/shuzang.github.io title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/twemoji/twemoji.min.js defer></script><script src=/lib/lightgallery/lightgallery.min.js defer></script><script src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script src=/lib/pace/pace.min.js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{enable:!1},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0,selector:"article"},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},twemoji:!0}</script><script src=/js/theme.min.js defer></script></body></html>