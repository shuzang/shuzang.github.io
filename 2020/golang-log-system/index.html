<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Golang日志系统 - Shuzang's Blog</title><meta name=author content="Shuzang"><meta name=author-link content><meta name=description content="日志是一个系统必不可少的部分，本篇介绍Golang中的日志系统。"><meta name=keywords content="Golang"><meta itemprop=name content="Golang日志系统"><meta itemprop=description content="日志是一个系统必不可少的部分，本篇介绍Golang中的日志系统。"><meta itemprop=datePublished content="2020-06-07T09:48:00+08:00"><meta itemprop=dateModified content="2020-06-07T00:00:00+00:00"><meta itemprop=wordCount content="2270"><meta itemprop=image content="https://shuzang.github.io/logo.png"><meta itemprop=keywords content="Golang,"><meta property="og:title" content="Golang日志系统"><meta property="og:description" content="日志是一个系统必不可少的部分，本篇介绍Golang中的日志系统。"><meta property="og:type" content="article"><meta property="og:url" content="https://shuzang.github.io/2020/golang-log-system/"><meta property="og:image" content="https://shuzang.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-06-07T09:48:00+08:00"><meta property="article:modified_time" content="2020-06-07T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shuzang.github.io/logo.png"><meta name=twitter:title content="Golang日志系统"><meta name=twitter:description content="日志是一个系统必不可少的部分，本篇介绍Golang中的日志系统。"><meta name=application-name content="Shuzang's Blog"><meta name=apple-mobile-web-app-title content="Shuzang's Blog"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://shuzang.github.io/2020/golang-log-system/><link rel=prev href=https://shuzang.github.io/2020/golang-set-and-use-cookie/><link rel=next href=https://shuzang.github.io/2020/how-to-avoid-information-overload/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Golang日志系统","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/shuzang.github.io\/2020\/golang-log-system\/"},"genre":"posts","keywords":"Golang","wordcount":2270,"url":"https:\/\/shuzang.github.io\/2020\/golang-log-system\/","datePublished":"2020-06-07T09:48:00+08:00","dateModified":"2020-06-07T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Shuzang"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title="Shuzang's Blog"><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title="Shuzang's Blog" data-alt="Shuzang's Blog" class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Shuzang's Blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Shuzang's Blog"><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title=/images/avatar.png data-alt=/images/avatar.png class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Shuzang's Blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Golang日志系统</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><img loading=lazy src=/images/avatar.png srcset="/images/avatar.png, /images/avatar.png 1.5x, /images/avatar.png 2x" sizes=auto data-title=Shuzang data-alt=Shuzang class=avatar style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;Shuzang</span></span>
<span class=post-category>收录于 <a href=/categories/%E7%88%B1%E7%BC%96%E7%A8%8B%E7%88%B1%E6%8A%80%E6%9C%AF%E7%9A%84%E5%AD%A9%E5%AD%90/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 爱编程爱技术的孩子</a></span></div><div class=post-meta-line><span title="发布于 2020-06-07 09:48:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2020-06-07>2020-06-07</time></span>&nbsp;<span title="更新于 2020-06-07 00:00:00"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2020-06-07>2020-06-07</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 2270 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 5 分钟</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#1-内置log包>1. 内置log包</a><ul><li><a href=#11-内置实现>1.1 内置实现</a></li><li><a href=#12-基于logger自定义>1.2 基于Logger自定义</a></li></ul></li><li><a href=#2-第三方log库>2. 第三方log库</a></li><li><a href=#3参考>3.参考</a></li></ul></nav></div></div><div class=content id=content><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-exclamation-triangle fa-fw" aria-hidden=true></i>警告<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>本文最后更新于 2020-06-07，文中内容可能已过时。</div></div></div><p>日志是一个系统必不可少的部分，本篇介绍Golang中的日志系统。</p><h2 id=1-内置log包>1. 内置log包</h2><p>官方提供的 log 包实现了简单的日志服务。该包定义了一个 Logger 类型，提供了一些格式化输出方法，为了更容易地使用，对该类型提供了一个标准 Logger 实现，该 Logger 会打印每条日志信息的日期、时间、默认输出到标准错误，Fatal系列函数会在写入日志信息后调用 os.Exit(1)。Panic系列函数会在写入日志信息后panic。</p><h3 id=11-内置实现>1.1 内置实现</h3><p>一个内置实现使用的简单例子如下</p><div class=highlight id=id-1><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// This sample program demonstrates how to use the base log package.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>SetPrefix</span><span class=p>(</span><span class=s>&#34;TRACE: &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>SetFlags</span><span class=p>(</span><span class=nx>log</span><span class=p>.</span><span class=nx>Ldate</span> <span class=p>|</span> <span class=nx>log</span><span class=p>.</span><span class=nx>Lmicroseconds</span> <span class=p>|</span> <span class=nx>log</span><span class=p>.</span><span class=nx>Llongfile</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Println writes to the standard logger.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;message&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Fatalln is Println() followed by a call to os.Exit(1).
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalln</span><span class=p>(</span><span class=s>&#34;fatal message&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Panicln is Println() followed by a call to panic().
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Panicln</span><span class=p>(</span><span class=s>&#34;panic message&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>-------------------------------</span>
</span></span><span class=line><span class=cl><span class=nx>TRACE</span><span class=p>:</span> <span class=mi>2019</span><span class=o>/</span><span class=mo>04</span><span class=o>/</span><span class=mi>09</span> <span class=mi>14</span><span class=p>:</span><span class=mi>24</span><span class=p>:</span><span class=mf>32.868375</span> <span class=nx>D</span><span class=p>:</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>TestFile</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>main</span><span class=o>/</span><span class=nx>TestLog</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>15</span><span class=p>:</span> <span class=nx>message</span>
</span></span><span class=line><span class=cl><span class=nx>TRACE</span><span class=p>:</span> <span class=mi>2019</span><span class=o>/</span><span class=mo>04</span><span class=o>/</span><span class=mi>09</span> <span class=mi>14</span><span class=p>:</span><span class=mi>24</span><span class=p>:</span><span class=mf>32.962329</span> <span class=nx>D</span><span class=p>:</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>TestFile</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>main</span><span class=o>/</span><span class=nx>TestLog</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>18</span><span class=p>:</span> <span class=nx>fatal</span> <span class=nx>message</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>Process</span> <span class=nx>finished</span> <span class=nx>with</span> <span class=nx>exit</span> <span class=nx>code</span> <span class=mi>1</span></span></span></code></pre></td></tr></table></div></div><p>原型函数的说明如下</p><div class=highlight id=id-2><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Flags</span><span class=p>()</span> <span class=kt>int</span>            		<span class=c1>// Flags返回标准logger的输出选项
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>SetFlags</span><span class=p>(</span><span class=nx>flag</span> <span class=kt>int</span><span class=p>)</span>   		<span class=c1>// SetFlags设置标准logger的输出选项
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Prefix</span><span class=p>()</span> <span class=kt>string</span>      		<span class=c1>// Prefix返回标准logger的输出前缀
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>SetPrefix</span><span class=p>(</span><span class=nx>prefix</span> <span class=kt>string</span><span class=p>)</span> 		<span class=c1>// SetPrefix设置标准logger的输出前缀
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>SetOutput</span><span class=p>(</span><span class=nx>w</span> <span class=nx>io</span><span class=p>.</span><span class=nx>Writer</span><span class=p>)</span>		<span class=c1>// SetOutput设置标准logger的输出目的地，默认是标准错误输出
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// Printf调用Output将生成的格式化字符串输出到标准logger，参数用和fmt.Printf相同的方法处理。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Printf</span><span class=p>(</span><span class=nx>format</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=c1>// Print调用Output将生成的格式化字符串输出到标准logger，参数用和fmt.Print相同的方法处理。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Print</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=c1>// Println调用Output将生成的格式化字符串输出到标准logger，参数用和fmt.Println相同的方法处理。
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Println</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Fatalf</span><span class=p>(</span><span class=nx>format</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>	<span class=c1>// Fatalf等价于{Printf(v...); os.Exit(1)}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Fatal</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>			<span class=c1>// Fatal等价于{Print(v...); os.Exit(1)}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Fatalln</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>			<span class=c1>// Fatalln等价于{Println(v...); os.Exit(1)}
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Panicf</span><span class=p>(</span><span class=nx>format</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>	<span class=c1>// Panicf等价于{Printf(v...); panic(...)}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Panic</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>			<span class=c1>// Panic等价于{Print(v...); panic(...)}
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Panicln</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>			<span class=c1>// Panicln等价于{Println(v...); panic(...)}
</span></span></span></code></pre></td></tr></table></div></div><p>SetPrefix 设置输出前缀，SetfFlags 设置输出选项，为了理解输出前缀与选项，我们先来看一个标准输出</p><div class=highlight id=id-3><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>TRACE</span><span class=p>:</span> <span class=mi>2019</span><span class=o>/</span><span class=mo>04</span><span class=o>/</span><span class=mi>09</span> <span class=mi>14</span><span class=p>:</span><span class=mi>24</span><span class=p>:</span><span class=mf>32.868375</span> <span class=nx>D</span><span class=p>:</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>TestFile</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>main</span><span class=o>/</span><span class=nx>TestLog</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>15</span><span class=p>:</span> <span class=nx>message</span></span></span></code></pre></td></tr></table></div></div><p>其中，<code>TRACE</code> 就是输出前缀，可以通过 SetPrefix 设置，通过 Prefix 输出，用来在普通的程序输出中分布出日志。后面冒号前的信息就是输出选项，通过 SetFlags 设置，通过 Flags 输出。输出选项的结构定义如下</p><div class=highlight id=id-4><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 字位共同控制输出日志信息的细节。不能控制输出的顺序和格式。
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 在所有项目后会有一个冒号：2009/01/23 01:23:23.123123 /a/b/c/d.go:23: message
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Ldate</span>         <span class=p>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=kc>iota</span>     <span class=c1>// 日期：2009/01/23
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Ltime</span>                         <span class=c1>// 时间：01:23:23
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Lmicroseconds</span>                 <span class=c1>// 微秒分辨率：01:23:23.123123（用于增强Ltime位）
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Llongfile</span>                     <span class=c1>// 文件全路径名+行号： /a/b/c/d.go:23
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Lshortfile</span>                    <span class=c1>// 文件无路径名+行号：d.go:23（会覆盖掉Llongfile）
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>LstdFlags</span>     <span class=p>=</span> <span class=nx>Ldate</span> <span class=p>|</span> <span class=nx>Ltime</span> <span class=c1>// 标准logger的初始值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>log 包有一个很方便的地方就是，这些日志记录器是多 goroutine 安全的。这意味着在多个goroutine 可以同时调用来自同一个日志记录器的这些函数，而不会有彼此间的写冲突。标准日志记录器具有这一性质，用户定制的日志记录器也应该满足这一性质。</p><h3 id=12-基于logger自定义>1.2 基于Logger自定义</h3><p>官方的预置实现是基于Logger类型的，我们也可以基于Logger类型自己进行实现</p><p>Logger类型表示一个活动状态的记录日志的对象，它会生成一行行的输出写入一个io.Writer接口。每一条日志操作会调用一次io.Writer接口的Write方法。Logger类型的对象可以被多个线程安全的同时使用，它会保证对io.Writer接口的顺序访问。</p><div class=highlight id=id-5><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Logger</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// contains filtered or unexported fields
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>Logger类型的方法就是官方实现的那些函数</p><div class=highlight id=id-6><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Fatal</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Fatalf</span><span class=p>(</span><span class=nx>format</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Fatalln</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Flags</span><span class=p>()</span> <span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Output</span><span class=p>(</span><span class=nx>calldepth</span> <span class=kt>int</span><span class=p>,</span> <span class=nx>s</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Panic</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Panicf</span><span class=p>(</span><span class=nx>format</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Panicln</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Prefix</span><span class=p>()</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Print</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Printf</span><span class=p>(</span><span class=nx>format</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>Println</span><span class=p>(</span><span class=nx>v</span> <span class=o>...</span><span class=kd>interface</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>SetFlags</span><span class=p>(</span><span class=nx>flag</span> <span class=kt>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>l</span> <span class=o>*</span><span class=nx>Logger</span><span class=p>)</span> <span class=nf>SetPrefix</span><span class=p>(</span><span class=nx>prefix</span> <span class=kt>string</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>有区别的是，还有一个 New 函数用来创建一个 Logger，其中的参数 out 用于设置日志信息写入的目的地，prefix 设置前缀，flag 设置选项。</p><div class=highlight id=id-7><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>New</span><span class=p>(</span><span class=nx>out</span> <span class=nx>io</span><span class=p>.</span><span class=nx>Writer</span><span class=p>,</span> <span class=nx>prefix</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>flag</span> <span class=kt>int</span><span class=p>)</span> <span class=o>*</span><span class=nx>Logger</span></span></span></code></pre></td></tr></table></div></div><p>一个简单的使用示例如下</p><div class=highlight id=id-8><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>buf</span> <span class=nx>bytes</span><span class=p>.</span><span class=nx>Buffer</span>
</span></span><span class=line><span class=cl><span class=nx>logger</span> <span class=o>:=</span> <span class=nx>log</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>buf</span><span class=p>,</span> <span class=s>&#34;logger: &#34;</span><span class=p>,</span> <span class=nx>log</span><span class=p>.</span><span class=nx>Lshortfile</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>logger</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=s>&#34;Hello, log file!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Print</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>buf</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>// Output
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>logger</span><span class=p>:</span> <span class=nx>example_test</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>16</span><span class=p>:</span> <span class=nx>Hello</span><span class=p>,</span> <span class=nx>log</span> <span class=nx>file</span><span class=p>!</span></span></span></code></pre></td></tr></table></div></div><p>一般情况下，我们需要区分不同的日志级别：Info、Warning 和 Error，这里有一个参考实现</p><div class=highlight id=id-9><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 这个示例程序展示如何创建定制的日志记录器
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;io&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;io/ioutil&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>Trace</span>   <span class=o>*</span><span class=nx>log</span><span class=p>.</span><span class=nx>Logger</span> <span class=c1>// 记录所有日志
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Info</span>    <span class=o>*</span><span class=nx>log</span><span class=p>.</span><span class=nx>Logger</span> <span class=c1>// 重要的信息
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Warning</span> <span class=o>*</span><span class=nx>log</span><span class=p>.</span><span class=nx>Logger</span> <span class=c1>// 需要注意的信息
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>Error</span>   <span class=o>*</span><span class=nx>log</span><span class=p>.</span><span class=nx>Logger</span> <span class=c1>// 非常严重的问题
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>init</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>OpenFile</span><span class=p>(</span><span class=s>&#34;errors.txt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>os</span><span class=p>.</span><span class=nx>O_CREATE</span><span class=p>|</span><span class=nx>os</span><span class=p>.</span><span class=nx>O_WRONLY</span><span class=p>|</span><span class=nx>os</span><span class=p>.</span><span class=nx>O_APPEND</span><span class=p>,</span> <span class=mo>0666</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalln</span><span class=p>(</span><span class=s>&#34;Failed to open error log file:&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>Trace</span> <span class=p>=</span> <span class=nx>log</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>ioutil</span><span class=p>.</span><span class=nx>Discard</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;TRACE: &#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nx>Ldate</span><span class=p>|</span><span class=nx>log</span><span class=p>.</span><span class=nx>Ltime</span><span class=p>|</span><span class=nx>log</span><span class=p>.</span><span class=nx>Lshortfile</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>Info</span> <span class=p>=</span> <span class=nx>log</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;INFO: &#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nx>Ldate</span><span class=p>|</span><span class=nx>log</span><span class=p>.</span><span class=nx>Ltime</span><span class=p>|</span><span class=nx>log</span><span class=p>.</span><span class=nx>Lshortfile</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>Warning</span> <span class=p>=</span> <span class=nx>log</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>os</span><span class=p>.</span><span class=nx>Stdout</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;WARNING: &#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nx>Ldate</span><span class=p>|</span><span class=nx>log</span><span class=p>.</span><span class=nx>Ltime</span><span class=p>|</span><span class=nx>log</span><span class=p>.</span><span class=nx>Lshortfile</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>Error</span> <span class=p>=</span> <span class=nx>log</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>io</span><span class=p>.</span><span class=nf>MultiWriter</span><span class=p>(</span><span class=nx>file</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Stderr</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;ERROR: &#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>log</span><span class=p>.</span><span class=nx>Ldate</span><span class=p>|</span><span class=nx>log</span><span class=p>.</span><span class=nx>Ltime</span><span class=p>|</span><span class=nx>log</span><span class=p>.</span><span class=nx>Lshortfile</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Trace</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;I have something standard to say&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>Info</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Special Information&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>Warning</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;There is something you need to know about&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>Error</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Something has failed&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>------------------------------------</span>
</span></span><span class=line><span class=cl><span class=nx>INFO</span><span class=p>:</span> <span class=mi>2019</span><span class=o>/</span><span class=mo>04</span><span class=o>/</span><span class=mi>09</span> <span class=mi>14</span><span class=p>:</span><span class=mi>37</span><span class=p>:</span><span class=mi>11</span> <span class=nx>TestCustomLog</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>44</span><span class=p>:</span> <span class=nx>Special</span> <span class=nx>Information</span>
</span></span><span class=line><span class=cl><span class=nx>ERROR</span><span class=p>:</span> <span class=mi>2019</span><span class=o>/</span><span class=mo>04</span><span class=o>/</span><span class=mi>09</span> <span class=mi>14</span><span class=p>:</span><span class=mi>37</span><span class=p>:</span><span class=mi>11</span> <span class=nx>TestCustomLog</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>46</span><span class=p>:</span> <span class=nx>Something</span> <span class=nx>has</span> <span class=nx>failed</span>
</span></span><span class=line><span class=cl><span class=nx>WARNING</span><span class=p>:</span> <span class=mi>2019</span><span class=o>/</span><span class=mo>04</span><span class=o>/</span><span class=mi>09</span> <span class=mi>14</span><span class=p>:</span><span class=mi>37</span><span class=p>:</span><span class=mi>11</span> <span class=nx>TestCustomLog</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>45</span><span class=p>:</span> 
</span></span><span class=line><span class=cl><span class=nx>There</span> <span class=nx>is</span> <span class=nx>something</span> <span class=nx>you</span> <span class=nx>need</span> <span class=nx>to</span> <span class=nx>know</span> <span class=nx>about</span></span></span></code></pre></td></tr></table></div></div><p>这里写入的目的地为 ioutil.Discard，这是一个 io.Writer 接口，调用它的 Write 方法将不做任何事情并且始终成功返回。</p><p>OpenFile几个选项说明如下</p><ul><li>O_CREATE // 如果不存在将创建一个新文件</li><li>O_WRONLY // 只写模式打开文件</li><li>O_APPEND // 写操作时将数据附加到文件尾部</li></ul><h2 id=2-第三方log库>2. 第三方log库</h2><p>比较流行且近期还在更新的日志库有 <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fsirupsen%2Flogrus" target=_blank rel="external nofollow noopener noreferrer">logrus</a>、<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fuber-go%2Fzap" target=_blank rel="external nofollow noopener noreferrer">zap</a>、<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Foklog%2Foklog" target=_blank rel="external nofollow noopener noreferrer">oklog</a>、<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Frs%2Fzerolog" target=_blank rel="external nofollow noopener noreferrer">zerolog</a></p><p>可以考虑选择 JSON 格式的日志，参考 <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F27363484" target=_blank rel="external nofollow noopener noreferrer">最佳日志实践（v2.0）</a> 一文</p><p>关于性能可以参考 <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fmzh.io%2Fgolang-build-tags-for-debug" target=_blank rel="external nofollow noopener noreferrer">Go零消耗debug log技巧</a>，使用官方模块在生产环境中存在性能瓶颈</p><h2 id=3参考>3.参考</h2><p>[1] 合肥懒皮，简书，<a href=https://www.jianshu.com/p/73ae6dc4d16a target=_blank rel="external nofollow noopener noreferrer">Golang log日志</a>，2019.04.09</p><p>[2] <a href=https://studygolang.com/pkgdoc target=_blank rel="external nofollow noopener noreferrer">Go语言标准库文档</a></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2020-06-07 00:00:00">更新于 2020-06-07&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/2020/golang-log-system/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Pocket" data-sharer=pocket data-url=https://shuzang.github.io/2020/golang-log-system/><i class="fa-brands fa-get-pocket fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://shuzang.github.io/2020/golang-log-system/ data-title=Golang日志系统><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/golang/ class=post-tag>Golang</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2020/golang-set-and-use-cookie/ class=post-nav-item rel=prev title=Golang设置与使用cookie><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Golang设置与使用cookie</a>
<a href=/2020/how-to-avoid-information-overload/ class=post-nav-item rel=next title=如何避免信息过载>如何避免信息过载<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-reward><div class=comment></div><input type=checkbox class=reward-input name=reward id=fi-reward hidden>
<label class=reward-button for=fi-reward>赞赏</label><div class=reward-ways data-mode=static><div><img loading=lazy src=/images/alipay.png srcset="/images/alipay.png, /images/alipay.png 1.5x, /images/alipay.png 2x" sizes=auto data-title="Shuzang 支付宝" data-alt="Shuzang 支付宝" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>支付宝</span></div><div><img loading=lazy src=/images/wechatpay.png srcset="/images/wechatpay.png, /images/wechatpay.png 1.5x, /images/wechatpay.png 2x" sizes=auto data-title="Shuzang 微信" data-alt="Shuzang 微信" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>微信</span></div></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line powered">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.117.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.2.18"><img class=fixit-icon src=/fixit.min.svg alt="FixIt logo">&nbsp;FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2018 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=/>Shuzang</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><a href=https://github.com/shuzang/shuzang.github.io title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/twemoji/twemoji.min.js defer></script><script src=/lib/lightgallery/lightgallery.min.js defer></script><script src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async defer></script><script src=/lib/pace/pace.min.js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{enable:!1},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0,selector:"article"},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},twemoji:!0}</script><script src=/js/theme.min.js defer></script></body></html>