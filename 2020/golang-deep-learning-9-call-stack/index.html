<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Golang深入学习9-调用栈 - Shuzang's Blog</title><meta name=author content><meta name=author-link content><meta name=description content="本篇介绍如何分析 Go 的调用栈。"><meta name=keywords content="Golang"><meta itemprop=name content="Golang深入学习9-调用栈"><meta itemprop=description content="本篇介绍如何分析 Go 的调用栈。"><meta itemprop=datePublished content="2020-08-15T09:47:00+08:00"><meta itemprop=dateModified content="2020-08-15T00:00:00+00:00"><meta itemprop=wordCount content="848"><meta itemprop=image content="https://shuzang.github.io/logo.png"><meta itemprop=keywords content="Golang,"><meta property="og:title" content="Golang深入学习9-调用栈"><meta property="og:description" content="本篇介绍如何分析 Go 的调用栈。"><meta property="og:type" content="article"><meta property="og:url" content="https://shuzang.github.io/2020/golang-deep-learning-9-call-stack/"><meta property="og:image" content="https://shuzang.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-08-15T09:47:00+08:00"><meta property="article:modified_time" content="2020-08-15T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shuzang.github.io/logo.png"><meta name=twitter:title content="Golang深入学习9-调用栈"><meta name=twitter:description content="本篇介绍如何分析 Go 的调用栈。"><meta name=application-name content="Shuzang's Blog"><meta name=apple-mobile-web-app-title content="Shuzang's Blog"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://shuzang.github.io/2020/golang-deep-learning-9-call-stack/><link rel=prev href=https://shuzang.github.io/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/><link rel=next href=https://shuzang.github.io/2020/operate-system-5-device-management/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://unpkg.com/@fortawesome/fontawesome-free@6.2.0/css/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://unpkg.com/@fortawesome/fontawesome-free@6.2.0/css/all.min.css></noscript><link rel=preload href=https://unpkg.com/animate.css@4.1.1/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://unpkg.com/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Golang深入学习9-调用栈","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/shuzang.github.io\/2020\/golang-deep-learning-9-call-stack\/"},"genre":"posts","keywords":"Golang","wordcount":848,"url":"https:\/\/shuzang.github.io\/2020\/golang-deep-learning-9-call-stack\/","datePublished":"2020-08-15T09:47:00+08:00","dateModified":"2020-08-15T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"作者"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title="Shuzang's Blog"><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/avatar.png data-title="Shuzang's Blog" data-alt="Shuzang's Blog" class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Shuzang's Blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/collection/><i class="fa-solid fa-bookmark fa-fw fa-sm" aria-hidden=true></i> 集子</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Shuzang's Blog"><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/avatar.png data-title=https://picped-1301226557.cos.ap-beijing.myqcloud.com/avatar.png data-alt=https://picped-1301226557.cos.ap-beijing.myqcloud.com/avatar.png class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Shuzang's Blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/collection/><i class="fa-solid fa-bookmark fa-fw fa-sm" aria-hidden=true></i> 集子</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container><aside class=toc id=toc-auto></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Golang深入学习9-调用栈</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i></span></span>
<span class=post-category>收录于 <a href=/categories/%E7%88%B1%E7%BC%96%E7%A8%8B%E7%88%B1%E6%8A%80%E6%9C%AF%E7%9A%84%E5%AD%A9%E5%AD%90/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 爱编程爱技术的孩子</a></span></div><div class=post-meta-line><span title="发布于 2020-08-15 09:47:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2020-08-15>2020-08-15</time></span>&nbsp;<span title="更新于 2020-08-15 00:00:00"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2020-08-15>2020-08-15</time></span>&nbsp;<span title="848 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 900 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 2 分钟</span>&nbsp;</div></div><div class=content id=content><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-exclamation-triangle fa-fw" aria-hidden=true></i>警告<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>本文最后更新于 2020-08-15，文中内容可能已过时。</div></div></div><p>本篇介绍如何分析 Go 的调用栈。</p><p>测试使用的版本是Go 1.14.3，下面介绍如何在Go调试的时候查看堆栈跟踪信息及识别传递的参数。</p><p>示例程序如下</p><div class=highlight id=id-1><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;runtime/debug&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>slice</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>string</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nf>Example</span><span class=p>(</span><span class=nx>slice</span><span class=p>,</span> <span class=s>&#34;hello&#34;</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Example</span><span class=p>(</span><span class=nx>slice</span> <span class=p>[]</span><span class=kt>string</span><span class=p>,</span> <span class=nx>str</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>debug</span><span class=p>.</span><span class=nf>PrintStack</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>在程序中我们使用了 runtime/debug 下的 PrintStack() 函数将调用栈的返回信息打印到标准错误输出，如下所示</p><div class=highlight id=id-2><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>goroutine</span> <span class=mi>1</span> <span class=p>[</span><span class=nx>running</span><span class=p>]:</span>
</span></span><span class=line><span class=cl><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=p>.</span><span class=nf>Stack</span><span class=p>(</span><span class=mh>0x0</span><span class=p>,</span> <span class=mh>0x0</span><span class=p>,</span> <span class=mh>0x0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>c</span><span class=p>:</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=o>/</span><span class=nx>stack</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>24</span> <span class=o>+</span><span class=mh>0xa8</span>
</span></span><span class=line><span class=cl><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=p>.</span><span class=nf>PrintStack</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>c</span><span class=p>:</span><span class=o>/</span><span class=k>go</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=o>/</span><span class=nx>stack</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>16</span> <span class=o>+</span><span class=mh>0x29</span>
</span></span><span class=line><span class=cl><span class=nx>main</span><span class=p>.</span><span class=nf>Example</span><span class=p>(</span><span class=mh>0xc000077f38</span><span class=p>,</span> <span class=mh>0x2</span><span class=p>,</span> <span class=mh>0x4</span><span class=p>,</span> <span class=mh>0x4a8534</span><span class=p>,</span> <span class=mh>0x5</span><span class=p>,</span> <span class=mh>0xa</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>f</span><span class=p>:</span><span class=o>/</span><span class=nx>Gotest</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>13</span> <span class=o>+</span><span class=mh>0x2e</span>
</span></span><span class=line><span class=cl><span class=nx>main</span><span class=p>.</span><span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>f</span><span class=p>:</span><span class=o>/</span><span class=nx>Gotest</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>9</span> <span class=o>+</span><span class=mh>0xb1</span>
</span></span><span class=line><span class=cl><span class=nx>Process</span> <span class=nx>exiting</span> <span class=nx>with</span> <span class=nx>code</span><span class=p>:</span> <span class=mi>0</span></span></span></code></pre></td></tr></table></div></div><p>注意，在其它编程语言如C中，运行一个程序会启动一个线程来执行，在Go中，启动的是一个 Goroutine。上面第一行就说明了启动了一个 Goroutine，Goroutine ID 为1，其后各行是不同层次的调用，最深的调用最先打印，最浅的调用最后打印。各行说明如下</p><p>第8、9行：main package 的 main 函数，代码文件路径为 <code>f:/Gotest/main.go</code>，调用出现在 main.go 文件的第9行</p><p>第6、7行：main 函数调用 Example 函数</p><p>第4、5行：Example 函数调用 debug.PrintStack 函数</p><p>第2，3行：debug.PrintStack 函数调用 debug.Stack 函数</p><p>Example 函数传参信息如下</p><div class=highlight id=id-3><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 调用
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>slice</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>string</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>Example</span><span class=p>(</span><span class=nx>slice</span><span class=p>,</span> <span class=s>&#34;hello&#34;</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>// 栈追踪
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>main</span><span class=p>.</span><span class=nf>Example</span><span class=p>(</span><span class=mh>0xc000077f38</span><span class=p>,</span> <span class=mh>0x2</span><span class=p>,</span> <span class=mh>0x4</span><span class=p>,</span> <span class=mh>0x4a8534</span><span class=p>,</span> <span class=mh>0x5</span><span class=p>,</span> <span class=mh>0xa</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>堆栈跟踪信息中，前三个参数分别代表切片的指针、长度、容量，第4和第5个参数代表字符串的指针和大小，最后一个参数指向整型数值</p><div class=highlight id=id-4><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 切片
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Pointer</span><span class=p>:</span> <span class=mh>0xc000077f38</span>
</span></span><span class=line><span class=cl><span class=nx>Length</span><span class=p>:</span> <span class=mh>0x2</span>
</span></span><span class=line><span class=cl><span class=nx>Capacity</span><span class=p>:</span> <span class=mh>0x4</span>
</span></span><span class=line><span class=cl><span class=c1>// 字符串
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Pointer</span><span class=p>:</span> <span class=mh>0x4a8534</span>
</span></span><span class=line><span class=cl><span class=nx>Length</span><span class=p>:</span> <span class=mh>0x5</span>
</span></span><span class=line><span class=cl><span class=c1>// 整数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>base</span> <span class=mi>16</span><span class=p>:</span> <span class=mh>0xa</span></span></span></code></pre></td></tr></table></div></div><p>如果是调用方法，跟踪信息会显示接收者</p><div class=highlight id=id-5><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 程序
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>   <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>   <span class=s>&#34;runtime/debug&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>trace</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nx>slice</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>string</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=kd>var</span> <span class=nx>t</span> <span class=nx>trace</span>
</span></span><span class=line><span class=cl>   <span class=nx>t</span><span class=p>.</span><span class=nf>Example</span><span class=p>(</span><span class=nx>slice</span><span class=p>,</span> <span class=s>&#34;hello&#34;</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>t</span> <span class=o>*</span><span class=nx>trace</span><span class=p>)</span> <span class=nf>Example</span><span class=p>(</span><span class=nx>slice</span> <span class=p>[]</span><span class=kt>string</span><span class=p>,</span> <span class=nx>str</span> <span class=kt>string</span><span class=p>,</span> <span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Receiver Address: %p\n&#34;</span><span class=p>,</span> <span class=nx>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=nx>debug</span><span class=p>.</span><span class=nf>PrintStack</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// 堆栈信息
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Receiver</span> <span class=nx>Address</span><span class=p>:</span> <span class=mh>0x5781c8</span>
</span></span><span class=line><span class=cl><span class=nx>goroutine</span> <span class=mi>1</span> <span class=p>[</span><span class=nx>running</span><span class=p>]:</span>
</span></span><span class=line><span class=cl><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=p>.</span><span class=nf>Stack</span><span class=p>(</span><span class=mh>0x15</span><span class=p>,</span> <span class=mh>0xc000071ef0</span><span class=p>,</span> <span class=mh>0x1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>C</span><span class=p>:</span><span class=o>/</span><span class=nx>Go</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=o>/</span><span class=nx>stack</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>24</span> <span class=o>+</span><span class=mh>0xae</span>
</span></span><span class=line><span class=cl><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=p>.</span><span class=nf>PrintStack</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>C</span><span class=p>:</span><span class=o>/</span><span class=nx>Go</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=o>/</span><span class=nx>stack</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>16</span> <span class=o>+</span><span class=mh>0x29</span>
</span></span><span class=line><span class=cl><span class=nx>main</span><span class=p>.(</span><span class=o>*</span><span class=nx>trace</span><span class=p>).</span><span class=nf>Example</span><span class=p>(</span><span class=mh>0x5781c8</span><span class=p>,</span> <span class=mh>0xc000071f48</span><span class=p>,</span> <span class=mh>0x2</span><span class=p>,</span> <span class=mh>0x4</span><span class=p>,</span> <span class=mh>0x4c04bb</span><span class=p>,</span> <span class=mh>0x5</span><span class=p>,</span> <span class=mh>0xa</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>D</span><span class=p>:</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>17</span> <span class=o>+</span><span class=mh>0x7c</span>
</span></span><span class=line><span class=cl><span class=nx>main</span><span class=p>.</span><span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>D</span><span class=p>:</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>13</span> <span class=o>+</span><span class=mh>0x9a</span></span></span></code></pre></td></tr></table></div></div><p>传递的参数全部为值类型时，可能会防止一个32位的字中</p><div class=highlight id=id-6><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// 程序
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>   <span class=s>&#34;runtime/debug&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nf>Example</span><span class=p>(</span><span class=kc>true</span><span class=p>,</span> <span class=kc>false</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=mi>25</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Example</span><span class=p>(</span><span class=nx>b1</span><span class=p>,</span> <span class=nx>b2</span><span class=p>,</span> <span class=nx>b3</span> <span class=kt>bool</span><span class=p>,</span> <span class=nx>i</span> <span class=kt>uint8</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nx>debug</span><span class=p>.</span><span class=nf>PrintStack</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// 堆栈信息
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>goroutine</span> <span class=mi>1</span> <span class=p>[</span><span class=nx>running</span><span class=p>]:</span>
</span></span><span class=line><span class=cl><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=p>.</span><span class=nf>Stack</span><span class=p>(</span><span class=mh>0x4</span><span class=p>,</span> <span class=mh>0xc00007a010</span><span class=p>,</span> <span class=mh>0xc000077f88</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>C</span><span class=p>:</span><span class=o>/</span><span class=nx>Go</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=o>/</span><span class=nx>stack</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>24</span> <span class=o>+</span><span class=mh>0xae</span>
</span></span><span class=line><span class=cl><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=p>.</span><span class=nf>PrintStack</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>C</span><span class=p>:</span><span class=o>/</span><span class=nx>Go</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>runtime</span><span class=o>/</span><span class=nx>debug</span><span class=o>/</span><span class=nx>stack</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>16</span> <span class=o>+</span><span class=mh>0x29</span>
</span></span><span class=line><span class=cl><span class=nx>main</span><span class=p>.</span><span class=nf>Example</span><span class=p>(</span><span class=mh>0xc019010001</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>D</span><span class=p>:</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>12</span> <span class=o>+</span><span class=mh>0x27</span>
</span></span><span class=line><span class=cl><span class=nx>main</span><span class=p>.</span><span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>D</span><span class=p>:</span><span class=o>/</span><span class=nx>gopath</span><span class=o>/</span><span class=nx>src</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>example</span><span class=o>/</span><span class=nx>main</span><span class=p>.</span><span class=k>go</span><span class=p>:</span><span class=mi>8</span> <span class=o>+</span><span class=mh>0x30</span></span></span></code></pre></td></tr></table></div></div><p>可以看到 Example 的参数只有一个，实际上底层四个参数放在一个字中</p><div class=highlight id=id-7><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// Parameter values
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kc>true</span><span class=p>,</span> <span class=kc>false</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=mi>25</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Word value
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>Bits</span>    <span class=nx>Binary</span>      <span class=nx>Hex</span>   <span class=nx>Value</span>
</span></span><span class=line><span class=cl><span class=mo>00</span><span class=o>-</span><span class=mo>07</span>   <span class=mo>0000</span> <span class=mo>0001</span>   <span class=mo>01</span>    <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=mi>08</span><span class=o>-</span><span class=mi>15</span>   <span class=mo>0000</span> <span class=mo>0000</span>   <span class=mo>00</span>    <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=mi>16</span><span class=o>-</span><span class=mi>23</span>   <span class=mo>0000</span> <span class=mo>0001</span>   <span class=mo>01</span>    <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=mi>24</span><span class=o>-</span><span class=mi>31</span>   <span class=mo>0001</span> <span class=mi>1001</span>   <span class=mi>19</span>    <span class=mi>25</span></span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2020-08-15 00:00:00">更新于 2020-08-15&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/2020/golang-deep-learning-9-call-stack/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Pocket" data-sharer=pocket data-url=https://shuzang.github.io/2020/golang-deep-learning-9-call-stack/><i class="fa-brands fa-get-pocket fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://shuzang.github.io/2020/golang-deep-learning-9-call-stack/ data-title=Golang深入学习9-调用栈><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/golang/ class=post-tag>Golang</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/ class=post-nav-item rel=prev title=Golang深入学习8-堆栈与逃逸分析><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Golang深入学习8-堆栈与逃逸分析</a>
<a href=/2020/operate-system-5-device-management/ class=post-nav-item rel=next title=操作系统5-设备管理>操作系统5-设备管理<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-reward><div class=comment></div><input type=checkbox class=reward-input name=reward id=fi-reward hidden>
<label class=reward-button for=fi-reward>赞赏</label><div class=reward-ways data-mode=static><div><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/alipay.png data-title=" 支付宝" data-alt=" 支付宝" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>支付宝</span></div><div><img loading=lazy src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/wechatpay.png data-title=" 微信" data-alt=" 微信" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>微信</span></div></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom">Hava a great day !</div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2018 - 2024</span><span class=author itemprop=copyrightHolder>
<a href=/></a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><a href=https://github.com/shuzang/shuzang.github.io title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=https://unpkg.com/lightgallery@2.6.1/css/lightgallery-bundle.min.css><link rel=preload href=https://unpkg.com/katex@0.16.2/dist/katex.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://unpkg.com/katex@0.16.2/dist/katex.min.css></noscript><link rel=stylesheet href=https://unpkg.com/pace-js@1.2.4/themes/blue/pace-theme-minimal.css><script src=https://unpkg.com/autocomplete.js@0.38.1/dist/autocomplete.min.js defer></script><script src=https://unpkg.com/fuse.js@6.6.2/dist/fuse.min.js defer></script><script src=https://unpkg.com/twemoji@14.0.2/dist/twemoji.min.js defer></script><script src=https://unpkg.com/lightgallery@2.6.1/lightgallery.min.js defer></script><script src=https://unpkg.com/lightgallery@2.6.1/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=https://unpkg.com/lightgallery@2.6.1/plugins/zoom/lg-zoom.min.js defer></script><script src=https://unpkg.com/sharer.js@0.5.1/sharer.min.js async defer></script><script src=https://unpkg.com/katex@0.16.2/dist/katex.min.js defer></script><script src=https://unpkg.com/katex@0.16.2/dist/contrib/auto-render.min.js defer></script><script src=https://unpkg.com/katex@0.16.2/dist/contrib/copy-tex.min.js defer></script><script src=https://unpkg.com/katex@0.16.2/dist/contrib/mhchem.min.js defer></script><script src=https://unpkg.com/pangu@4.0.7/dist/browser/pangu.min.js defer></script><script src=https://unpkg.com/pace-js@1.2.4/pace.min.js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{enable:!1},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0,selector:"article"},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},twemoji:!0}</script><script src=/js/theme.min.js defer></script></body></html>